(function(f){f.fn.html5audio=function(g){function ge(){var a=0==d.find("div[class='fontMeasure']").length?f("<div/>").addClass("fontMeasure").appendTo(d):d.find("div[class='fontMeasure']");ha=new apTextScroller;ha.init(a,Wa,he,"left",g.scrollSeparator,g.scrollSpeed)}function ie(a){if(l&&!t&&!W){if(!lb){if(ra){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();lb=!0;Aa.bind(Xa,function(a){a:{var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();cd(c)}}).bind(Ya,function(a){a:if(lb){lb=!1;Aa.unbind(Xa).unbind(Ya);var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c= a;a.preventDefault();cd(c)}})}return!1}}function cd(a){"horizontal"==mb?z=Math.max(0,Math.min(1,(a.pageX-Pb.offset().left)/ca)):(z=Math.max(0,Math.min(1,(a.pageY-Pb.offset().top)/ca)),z=1-z);Za()}function qc(){if(!l||t)return!1;Qb?(z=rc,Qb=!1):(rc=z,z=0,Qb=!0)}function Za(){"horizontal"==mb?sc.css("width",z*ca+"px"):sc.css("height",z*ca+"px");Q&&("youtube_single"==x||"youtube_playlist"==x?S?v&&v.setVolume(z):"undefined"!==typeof h(A)&&h(A).pb_setVolume(z):O?m&&(m.volume=z):"undefined"!==typeof h(r)&& h(r).pb_setVolume(z));0<z?d.find(".player_volume").find("img").attr("src",dd):d.find(".player_volume").find("img").attr("src",ed);H&&nb&&(R&&clearTimeout(R),R=setTimeout(Rb,Sb))}function tc(){nb&&R&&clearTimeout(R);wa.css("display","block");X.bind("mousemove",fd).bind("mouseout",Tb);Aa.bind("mouseout",Tb)}function Tb(){nb&&(R&&clearTimeout(R),R=setTimeout(Rb,Sb));wa.css("display","none");X.unbind("mousemove",fd).unbind("mouseout",Tb);Aa.unbind("mouseout",Tb)}function fd(a){if("horizontal"==mb){a= a.pageX-X.offset().left;if(isNaN(a))return!1;0>a?a=0:a>ca&&(a=ca);var b=parseInt(a-wa.width()/2,10);wa.css("left",b+"px");a=Math.max(0,Math.min(1,a/ca));a=parseInt(100*a,10)}else{a=a.pageY-X.offset().top;if(isNaN(a))return!1;0>a?a=0:a>ca&&(a=ca);b=parseInt(a-wa.height()/2,10);wa.css("top",b+je+"px");a=Math.max(0,Math.min(1,a/ca));a=parseInt(100*(1-a),10)}wa.find("p").html(a+" %")}function gd(a){if(l&&!t&&Q&&!lb&&!Ub){if(!W){if(ra){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault(); W=!0;Aa.bind(Xa,function(a){a:{var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();hd(c,a)}}).bind(Ya,function(a){ke(a)})}return!1}}function ke(a){if(W){W=!1;Aa.unbind(Xa).unbind(Ya);var b;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else return!1;if(1<b.length)return!1;b=b[0]}else b=a;a.preventDefault();hd(b,a)}if(U)var c=setTimeout(function(){c&&clearTimeout(c);uc=!1},500);return!1}function hd(a,b){if(!U){La=a.pageX-vc.offset().left;0>La?La=0:La>I&&(La=I);ia.width(La);var c=Math.max(0,Math.min(1,La/I))}else if(ja){if(wc(b)){if(xc||id>jd-le)return!1;W||(ob(!0),J.clearRect(0,0,aa,da),Ma(ea),pb());return!1}if(!xc)return!1; uc=!0;var c=a.pageX-xa.offset().left-aa/2,e=a.pageY-xa.offset().top-da/2,c=Math.atan2(e,c);c>-1*Math.PI&&c<-0.5*Math.PI&&(c=2*Math.PI+c);ea=c=Math.max(0,Math.min((c+Math.PI/2)/2*Math.PI*10))/100;J.clearRect(0,0,aa,da);Ma(ea);pb()}if(isNaN(c))return!1;qb=ea;kd(c)}function kd(a){"youtube_single"==x||"youtube_playlist"==x?S?(a=(a*v.getDuration()).toFixed(1),isNaN(a)||v.seek(a)):"undefined"!==typeof h(A)&&h(A).pb_seek(a):O?m&&m.seekable&&0<m.seekable.length&&(!me||H?m.currentTime=a*m.duration:a*m.duration>= m.buffered.end(0)-5?m.currentTime=m.buffered.end(0)-5:m.currentTime=a*m.duration):"undefined"!==typeof h(r)&&h(r).pb_seek(a)}function yc(){Q&&(ka.css("display","block"),Ia.bind("mousemove",ld).bind("mouseout",Vb),Aa.bind("mouseout",Vb))}function Vb(){Q&&(ka.css("display","none"),Ia.unbind("mousemove",ld).unbind("mouseout",Vb),Aa.unbind("mouseout",Vb))}function ld(a){if(!U){a=a.pageX-Ia.offset().left;if(isNaN(a))return!1;0>a?a=0:a>I&&(a=I);var b=parseInt(a-ka.width()/2,10);ka.css("left",b+"px");b= Math.max(0,Math.min(1,a/I))}else if(ja){if(wc(a))return ka.css("display","none"),!1;b=a.pageX-xa.offset().left;a=a.pageY-xa.offset().top;a=Math.atan2(a-da/2,b-aa/2);a>-1*Math.PI&&a<-0.5*Math.PI&&(a=2*Math.PI+a);b=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;ka.css("display","block")}if(isNaN(b))return!1;md(b)}function md(a){if(isNaN(a))return!1;var b,c;"youtube_single"==x||"youtube_playlist"==x?S?(c=v.getDuration(),b=a*c):"undefined"!==typeof h(A)&&(c=h(A).pb_getFlashDuration(),b=a*c):O?m&& (c=m.duration,b=a*c):"undefined"!==typeof h(r)&&(c=h(r).pb_getFlashDuration(),b=a*c);if(isNaN(b)||isNaN(c))return!1;ka.find("p").html(rb(b)+nd+sb(c))}function Ma(a){J.beginPath();J.arc(aa/2,da/2,zc-tb/2,-Wb,od*a-Wb,!1);J.strokeStyle=Ac;J.lineCap="butt";J.lineWidth=tb;J.stroke()}function Bc(a){Ja.beginPath();Ja.arc(aa/2,da/2,zc-tb/2,-Wb,od*a-Wb,!1);Ja.strokeStyle=ne;Ja.lineCap="butt";Ja.lineWidth=tb;Ja.stroke()}function pb(){if(B)a=62,b=57,J.fillStyle=Ac,J.fillRect(a,b,14,45),J.fillRect(a+23,b,14, 45);else{var a=65,b=57,c=65-a,e=102-b,n=Math.atan2(e,c)-Math.PI/3,e=Math.sqrt(c*c+e*e),c=Math.cos(n)*e+a,n=Math.sin(n)*e+b;J.beginPath();J.fillStyle=Ac;J.moveTo(a,b);J.lineTo(65,102);J.lineTo(c,n);J.fill()}}function wc(a){var b;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)a=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)a=a.originalEvent.changedTouches;else return!1;if(1<a.length)return!1;b=a[0]}else b=a;a=b.pageX-xa.offset().left; b=b.pageY-xa.offset().top;var c=aa/2,e=da/2;id=Math.sqrt((a-c)*(a-c)+(b-e)*(b-e));return Math.sqrt((a-c)*(a-c)+(b-e)*(b-e))<jd}function Cc(a){ba?(ba.reinitialise(),a&&("vertical"==ub?(ba.scrollToY(0),f(".jspPane").css("top","0px")):(ba.scrollToX(0),f(".jspPane").css("left","0px")))):(ba=Dc.jScrollPane().data().jsp,Dc.bind("jsp-initialised",function(a,c){}).jScrollPane({mouseWheelSpeed:20}),"horizontal"==ub&&(H||Dc.bind("mousewheel",oe)))}function oe(a,b,c,e){if(!l||t)return!1;ba&&ba.scrollByX(100* (0<b?-1:1));return!1}function ob(a){if(B){if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?v.togglePlayback():("undefined"!==typeof h(A)&&h(A).pb_togglePlayback(),Q=!0)}else O?m&&m.pause():"undefined"!==typeof h(r)&&h(r).pb_pause();B=!1;sa("off")}else{if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?H?!vb&&Y?(l=!1,Xb("on")):v.togglePlayback():v.togglePlayback():("undefined"!==typeof h(A)&&h(A).pb_togglePlayback(),Q=!0)}else O?m&&m.play():"undefined"!==typeof h(r)&& h(r).pb_play();B=!0;Na("off")}if(!a)return!1}function pd(a){if(!l||t)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=f(a.currentTarget);var b=a.attr("data-id");if(a.closest(".playlistItem").hasClass(wb))return!1;Y=!0;ya();k.processPlaylistRequest(b);return!1}function pe(a){if(!l||t)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=f(a.currentTarget).attr("class").split(" ");if(-1!=f.inArray("controls_prev", a))Y=!0,ya(),k.advanceHandler(-1,!0);else if(-1!=f.inArray("controls_toggle",a)){if(!Q)return;ob()}else if(-1!=f.inArray("controls_next",a))Y=!0,ya(),k.advanceHandler(1,!0);else if(-1!=f.inArray("player_volume",a))H?nb?(R&&clearTimeout(R),xb?(X.css("display","none"),xb=!1):(X.css("display","block"),xb=!0,R=setTimeout(Rb,Sb))):(qc(),Za()):(qc(),Za());else if(-1!=f.inArray("player_download",a)){if(!Ca)if(a=x){var b=k.getCounter(),c=y[b].download,b=Ec(b,!1);a=qd(a,b,c);rd(a.name,a.path)}else q&&alert("Invalid data-type for file download function! Quitting."), Ca=!1}else-1!=f.inArray("player_loop",a)?(la?(d.find(".player_loop").find("img").attr("src",Yb),la=!1):(d.find(".player_loop").find("img").attr("src",yb),la=!0),k.setLooping(la)):-1!=f.inArray("player_shuffle",a)&&(ma?(d.find(".player_shuffle").find("img").attr("src",Zb),ma=!1):(d.find(".player_shuffle").find("img").attr("src",zb),ma=!0),k.setRandom(ma));return!1}function qe(a){if(l)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=f(a.currentTarget).attr("class").split(" "), -1!=f.inArray("controls_prev",a)?d.find(".controls_prev").find("img").attr("src",re):-1!=f.inArray("controls_toggle",a)?B?Na("on"):sa("on"):-1!=f.inArray("controls_next",a)?d.find(".controls_next").find("img").attr("src",se):-1!=f.inArray("player_volume",a)?0<z?d.find(".player_volume").find("img").attr("src",te):d.find(".player_volume").find("img").attr("src",ue):-1!=f.inArray("player_download",a)?d.find(".player_download").find("img").attr("src",ve):-1!=f.inArray("player_loop",a)?la?d.find(".player_loop").find("img").attr("src", Yb):d.find(".player_loop").find("img").attr("src",yb):-1!=f.inArray("player_shuffle",a)&&(ma?d.find(".player_shuffle").find("img").attr("src",Zb):d.find(".player_shuffle").find("img").attr("src",zb)),!1}function we(a){if(l)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=f(a.currentTarget).attr("class").split(" "),-1!=f.inArray("controls_prev",a)?d.find(".controls_prev").find("img").attr("src",xe):-1!=f.inArray("controls_toggle",a)?B?Na("off"):sa("off"): -1!=f.inArray("controls_next",a)?d.find(".controls_next").find("img").attr("src",ye):-1!=f.inArray("player_volume",a)?0<z?d.find(".player_volume").find("img").attr("src",dd):d.find(".player_volume").find("img").attr("src",ed):-1!=f.inArray("player_download",a)?d.find(".player_download").find("img").attr("src",ze):-1!=f.inArray("player_loop",a)?la?d.find(".player_loop").find("img").attr("src",yb):d.find(".player_loop").find("img").attr("src",Yb):-1!=f.inArray("player_shuffle",a)&&(ma?d.find(".player_shuffle").find("img").attr("src", zb):d.find(".player_shuffle").find("img").attr("src",Zb)),!1}function ya(){if(!fa&&-1!=k.getCounter()){var a=f(Da[k.getCounter()]);if(a&&a.hasClass("playlistSelected")){var b=a.attr("data-id");a.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!==typeof playlistItemEnabled&&playlistItemEnabled(K,L,a,b)}}}function sd(){if(!fa){var a=f(Da[k.getCounter()]);if(a&&a.hasClass("playlistNonSelected")){var b=a.attr("data-id");a.removeClass("playlistNonSelected").addClass("playlistSelected"); "undefined"!==typeof playlistItemDisabled&&playlistItemDisabled(K,L,a,b)}}}function Fc(){var a=g.activeItem;isNaN(a)||-1==a?Y=!0:(0>a?a=0:a>C-1&&(a=C-1),k.setCounter(a,!1))}function td(){s&&-1!=k.getCounter()&&(Ab(),ud(),ya())}function Bb(){Ab();ud();var a=0,b;for(a;a<C;a++)b=f(Da[a]).unbind("click",pd),vd&&!H&&b.unbind("mouseenter").unbind("mouseleave");s&&(s.children().each(function(){var a=f(this);a.data("hap_wrap_player")&&a.data("hap_wrap_player").destroyPlaylist()}),s.empty(),s=null);Ea.empty(); fa=Cb=!1;$b=G=p=null;$a=ab=Db=!1;bb=null;k.reSetCounter();y=[];Da=[];P=[];ba&&ba.reinitialise()}function Ab(){ac&&(S?v&&v.stop():"undefined"!==typeof h(A)&&h(A).pb_dispose(),ac=!1);O?(Z&&clearInterval(Z),m&&(m.pause(),m.src=""),Eb&&Eb.unbind("ended pause play canplay canplaythrough loadedmetadata")):"undefined"!==typeof h(r)&&h(r).pb_dispose();Gc();$b?bc.css("display","block"):bc.css("display","none");qb=null;Hc=Q=B=Ub=!1}function wd(a){if("undefined"===typeof a)return q&&alert("setPlaylist method requires data parameter. loadPlaylist failed."), !1;if("undefined"===typeof a.hidden)return q&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var b=Ae(a.hidden);if("undefined"===typeof a.id)return q&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."),!1;a=a.id;t=!0;xd();Ea.css("opacity",0);s&&Bb();Cb=!1;fa=b;yd&&zd?(b=f(Ka.find(a).css("display","block").clone().wrap("<p>").parent().html()),f(Ka.find(a).css("display","none"))):(b=Ka.find(a).css("display","block").clone(),Ka.find(a).css("display", "none"));b.css("fontSize",0);if(0==b.length)return q&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'),Ic(),!1;if(fa)cb.empty(),b.appendTo(cb),na=0,$a=ab=Oa=!0,s=Ad;else{if(!ba&&0==Ea.length)return q&&alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),!1;b.appendTo(Ea);s=b}y=[];Da=[];P=[];w=[];b.find("li[class*='playlistItem']").each(function(){w.push(f(this))}); F()}function F(){w.length?Be():Ce()}function Be(){cc=N=M=G=V=null;Jc=!1;var a=w[0],b=a.attr("data-type").toLowerCase(),c=a.attr("data-path"),e=a.hasClass(Bd);u=[];a.hasClass(Cd)&&(Jc=!0);void 0==a.attr("data-plink")||E(a.attr("data-plink"))||(V=a.attr("data-plink"));void 0!=a.attr("data-dlink")&&("youtube_single"==b||"youtube_playlist"==b?E(a.attr("data-dlink"))||(G=a.attr("data-dlink")):G=E(a.attr("data-dlink"))?!0:a.attr("data-dlink"));void 0!=a.attr("data-download")&&("youtube_single"==b||"youtube_playlist"== b?E(a.attr("data-download"))||(M=a.attr("data-download")):M=E(a.attr("data-download"))?!0:a.attr("data-download"));void 0==a.attr("data-thumb")||E(a.attr("data-thumb"))||(N=a.attr("data-thumb"));E(f.trim(a.html()))||(cc=a.html());if(e)p=a,w.shift(),F();else if("local"==b)p=a,w.shift(),F();else if("soundcloud"==b)p=a.data("toremove","true"),Fb=0,dc(c);else if("podcast"==b)p=a.data("toremove","true"),e="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+De+"&callback=?&q="+encodeURIComponent(c), f.ajax({type:"GET",url:e,dataType:"jsonp",cache:!1}).done(function(a){if(null==a.responseData)q&&alert("Playlist process failed, podcast: "+c),p&&"true"==p.data("toremove")&&p.remove(),w.shift(),F();else{if(Dd){a=Ee(a.responseData.xmlString);var b;f(a).find("item").each(function(){b=f(this);g={type:"podcast"};g.mp3=b.find("enclosure").attr("url");g.ogg="";g.title=b.find("title").text();0<b.find("media\\:thumbnail").length?b.find("media\\:thumbnail").attr("url")?g.thumb=b.find("media\\:thumbnail").attr("url"): N&&(g.thumb=N):N&&(g.thumb=N);V&&(g.plink=V);G&&(g.dlink=G);M&&(g.download=M);u.push(g)})}else{Ed.html(a.responseData.xmlString);a=Ed.get(0).getElementsByTagName("item");var e=0,n=a.length,d,h,g;for(e;e<n;e++)d=a[e],g={type:"podcast"},g.mp3=d.getElementsByTagName("enclosure")[0].getAttribute("url"),g.ogg="",void 0!=d.getElementsByTagName("itunes:duration")[0]&&(h=Fe(d.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue),g.length=parseInt(1E3*h,10)),void 0!=d.getElementsByTagName("media:thumbnail")[0]? void 0!=d.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?g.thumb=d.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):N&&(g.thumb=N):N&&(g.thumb=N),g.title=d.getElementsByTagName("title")[0].childNodes[0].nodeValue,V&&(g.plink=V),G&&(g.dlink=G),M&&(g.download=M),u.push(g)}za()}}).fail(function(a,b,e){q&&alert("Parse feed error: "+a.responseText);q&&alert("Playlist process failed, podcast: "+c);p&&"true"==p.data("toremove")&&p.remove();w.shift();F()});else if("folder"== b){p=a.data("toremove","true");var e=D+"folder_parser.php",n=!0;void 0!=a.attr("data-subdirs")&&"false"==a.attr("data-subdirs")&&(n=!1);n={dir:c,sub_dirs:n};f.ajax({type:"GET",url:e,data:n,dataType:"json"}).done(function(a){var b=0,c=a.length,e,n;for(b;b<c;b++)e=a[b],path=e.path,path.indexOf("\\")&&(path=path.replace(/\\/g,"/")),e={type:"folder"},path.indexOf(".mp3")&&(e.mp3=path),e.ogg=path.substr(0,path.lastIndexOf("."))+".ogg",e.thumb=path.substr(0,path.lastIndexOf("."))+".jpg",no_ext=path.substr(0, path.lastIndexOf(".")),n=/\//i.test(no_ext)?no_ext.substr(no_ext.lastIndexOf("/")+1):no_ext,n=n.split("_").join(" "),e.title=n,V&&(e.plink=V),G&&(e.dlink=G),M&&(e.download=M),N&&(e.thumb=N),u.push(e);za()}).fail(function(a,b,e){q&&alert("Read folder error! Make sure you run this online or on local server!");q&&alert("Playlist process failed, folder: "+c);p&&"true"==p.data("toremove")&&p.remove();w.shift();F()})}else if("xml"==b){p=a;var e=D+c,d,h=[];f.ajax({type:"GET",url:e,dataType:"html",cache:!1}).done(function(b){w.shift(); f(b).find("li[class='playlistItem']").each(function(){d=Kc(f(this));p?p.after(f(d)):0<s.children().size()?f(d).prependTo(s):f(d).appendTo(s);p=f(d);h.push(f(d))});b=0;var c=h.length;h.reverse();for(b;b<c;b++)w.unshift(h[b]);h=null;a.remove();F()}).fail(function(a,b,e){q&&alert("Playlist process failed, xml: "+c);p&&p.remove();w.shift();F()})}else if("database_data"==b||"database_html"==b)if(void 0==a.attr("data-table")||E(a.attr("data-table")))q&&(alert("Database table missing!"),alert("Playlist process failed, database query: "+ c)),w.shift(),F();else{var g=n=null,l=null;void 0==a.attr("data-limit")||E(a.attr("data-limit"))||(n=parseInt(a.attr("data-limit"),10));void 0==a.attr("data-range")||E(a.attr("data-range"))||(e=a.attr("data-range").split(","),2==e.length&&(g=e[0],l=e[1]));p=a;e=D+"includes/database.php";h=[];n={db_name:c,db_table:a.attr("data-table"),db_type:b,limit:n,range_from:g,range_to:l};f.ajax({type:"POST",url:e,data:n}).done(function(e){if(-1<e.indexOf("Database information missing!")||-1<e.indexOf("Db connection failed")|| -1<e.indexOf("Db selection failed")||-1<e.indexOf("Db query failed"))q&&(alert(e),alert("Playlist process failed, database query: "+c)),p&&p.remove(),w.shift();else{w.shift();e=f.parseJSON(e);var n=0,g=e.length,l;for(n;n<g;n++){l=e[n];if("database_data"==b)if(l.type&&l.mp3||l.path)d=Fd(l);else continue;else if(l.path)d=Kc(l.path);else continue;p?p.after(f(d)):0<s.children().size()?f(d).prependTo(s):f(d).appendTo(s);p=f(d);h.push(f(d))}n=0;g=h.length;h.reverse();for(n;n<g;n++)w.unshift(h[n]);h=null; a.remove()}F()}).fail(function(a,b,e){q&&alert("Playlist process failed, database query: "+c);p&&p.remove();w.shift();F()})}else"youtube_single"==b?(Gd=c,youtube_path="http://gdata.youtube.com/feeds/api/videos/"+c+"?v=2&format=5&alt=jsonc",p=a.data("toremove","true"),Lc(b,youtube_path)):"youtube_playlist"==b?(c.substr(0,2).toUpperCase(),ec=c,db=1,youtube_path="http://gdata.youtube.com/feeds/api/playlists/"+ec+"?start-index="+db+"&max-results=50&v=2&format=5&alt=jsonc",p=a.data("toremove","true"), Lc(b,youtube_path)):"ofm_single"==b?(p=a.data("toremove","true"),Fa=[],Fa.push({id:c,type:b}),Gb()):"ofm_playlist"==b||"ofm_project"==b?(p=a.data("toremove","true"),Mc=b,fc=c,Fa=[],eb=1,Hd()):(q&&alert("Invalid playlist data-type attribute!"),w.shift(),F())}function za(){if(u.length){var a,b,c=0,e=u.length,n,d;for(c;c<e;c++)n=u[c],a=f('<li class="playlistItem" data-type="'+n.type+'"data-mp3="'+n.mp3+'" data-ogg="'+n.ogg+'" data-thumb="'+n.thumb+'"></li>'),d=n.mp3,/\.(mp3)$/i.test(n.mp3)||(d+=".mp3"), Jc&&a.addClass(Cd),n.plink&&a.attr("data-plink",n.plink),n.dlink&&(!0!=n.dlink&&"true"!=n.dlink?a.attr("data-dlink",n.dlink):a.attr("data-dlink",d)),n.download&&(!0!=n.download&&"true"!=n.download?a.attr("data-download",n.download):a.attr("data-download",d)),n.title&&a.attr("data-title",n.title),n.thumb&&("//"==n.thumb.substr(0,2)&&(n.thumb="http:"+n.thumb),a.attr("data-thumb",n.thumb)),n.length&&a.attr("data-length",n.length),"title"==Ga?b=f('<a class="playlistNonSelected" href="#">"'+n.title+'"</a>').appendTo(a): "thumb"==Ga?b=f('<a class="playlistNonSelected" href="#"><img src="'+n.thumb+'" alt="thumb"/></a>').appendTo(a):"all"==Ga&&(b=f('<a class="playlistNonSelected" href="#"></a>').appendTo(a),f('<span class="hap_thumb"><img src="'+n.thumb+'" alt="thumb"/></span>').appendTo(b),f('<span class="hap_title"><p>'+n.title+"</p></span>").appendTo(b)),cc&&b.after(cc),p?(p.after(a),"true"==p.data("toremove")&&p.remove()):a.appendTo(s),p=a}w.shift();F()}function Ce(){if(Db||ab){var a=0;p=null;var b;cb.find("li[class*='playlistItem']").each(function(){b= f(this);p?p.after(b):Oa?b.appendTo(s):s.children().eq(na).before(b);p=b;a++});cb.empty()}gc();Ea.css("opacity",1);l||Id();p=null;t=!1;Ic();if(0<C){if(Db||ab){var c=k.getCounter();k.setPlaylistItems(C,!1);na<=c&&(Oa||k.reSetCounter(c+a));$a&&($a=!1,Fc())}else k.setPlaylistItems(C),Fc();Pa&&Ha()}ab=Db=!1;0==C&&"undefined"!==typeof playlistEmpty&&playlistEmpty(K,L);"undefined"!==typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(K,L);Cb=!0}function gc(){y=[];P=[];Da=[];if(0==s.length)return q&& alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),!1;var a=0,b,c,e=s.find("li"),n=e.length,d,g,h,p,m,r,u,v,w,x;Hb=0;for(a;a<n;a++)c=f(e[a]).addClass(Bd),P.push(c),Nc&&c.addClass(wb),Hb="horizontal"==ub?Hb+c.outerWidth(!0):Hb+c.outerHeight(!0),b=c.find("a[class=playlistNonSelected]"),0==b.length&&(b=c.find("a[class=playlistSelected]")),b.unbind().bind("click",pd).attr("data-id", a),Da.push(b),vd&&!H&&b.bind("mouseenter",function(a){if(!l||t)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=f(a.currentTarget).attr("data-id");var b=f(Da[a]),c=!1;k.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollover&&playlistItemRollover(K,L,b,a,c);return!1}).bind("mouseleave",function(a){if(!l||t)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=f(a.currentTarget).attr("data-id"); var b=f(Da[a]),c=!1;k.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollout&&playlistItemRollout(K,L,b,a,c);return!1}),d="",void 0!=c.attr("data-title")?d=c.attr("data-title"):"title"==Ga?d=b.html():"thumb"!=Ga&&"all"==Ga&&(d=b.find("span[class=hap_title]").find("p").html()),Oc&&(g=Pc(a)+Qc+d,b.html(g)),c=f(P[a]).attr({"data-id":a,"data-title":d}),h=g=r=m="",p=void 0,x=w=v=u=null,void 0!=c.attr("data-mp3")&&(m=c.attr("data-mp3")),void 0!=c.attr("data-ogg")&&(r=c.attr("data-ogg")),void 0!= c.attr("data-type")&&(g=c.attr("data-type")),void 0!=c.attr("data-origtype")&&(h=c.attr("data-origtype")),void 0==c.attr("data-length")||E(c.attr("data-length"))||(p=c.attr("data-length")),"youtube_single"==g||"youtube_playlist"==g?(void 0==c.attr("data-download")||E(c.attr("data-download"))||(u=c.attr("data-download")),void 0==c.attr("data-dlink")||E(c.attr("data-dlink"))||(v=c.attr("data-dlink"))):(void 0!=c.attr("data-download")&&(u=E(c.attr("data-download"))||"true"==c.attr("data-download")?m: c.attr("data-download")),void 0!=c.attr("data-dlink")&&(v=E(c.attr("data-dlink"))||"true"==c.attr("data-dlink")?m:c.attr("data-dlink"))),void 0==c.attr("data-plink")||E(c.attr("data-plink"))||(w=c.attr("data-plink")),void 0==c.attr("data-thumb")||E(c.attr("data-thumb"))||(x=c.attr("data-thumb")),fa||(w&&0==c.find("a[class=plink]").length&&(w=f('<a class="plink" href="'+w+'" target="_blank"><img src="'+Jd+'" alt="purchase"/></a>'),b.after(w)),v&&0==c.find("a[class=dlink]").length&&(v=f('<a class="dlink" href="#" data-dlink="'+ v+'"><img src="'+Kd+'" alt="download"/></a>'),b.after(v),E(c.attr("data-dlink"))),Ld&&0==c.find("a[class=premove]").length&&(c=f('<a class="premove" href="#"><img src="'+Ge+'" alt="remove"/></a>'),b.after(c))),y.push({id:a,type:g,origtype:h,title:d,mp3:m,ogg:r,length:p,download:u,thumb:x});e=null;C=y.length;fa||(He(),Ie&&(s.hasClass("ui-sortable")||s.sortable({cursor:"move",update:function(a,b){gc();0<C&&k.setPlaylistItems(C);var c=Ea.find("a[class=playlistSelected]").attr("data-id");c&&(k.reSetCounter(c), Pa&&Ha());1==C&&Fc()},receive:function(a,b){"undefined"!==typeof dropReceive&&dropReceive(K,L)}})),Md&&("horizontal"==ub&&Ea.width(Hb),Cc(!0)));return!0}function Id(){l=!0;t=!1;Ic();Nd();"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(K,L);Je()}function He(){var a=ra?Qa:"click";d.find("a[class=dlink]").unbind().bind(a,function(a){a.preventDefault();if(Ca)return!1;var c=f(this);a=c.closest(".playlistItem");var e=a.attr("data-id");if(a.hasClass(wb))return!1;if(void 0==a.attr("data-type")|| E(a.attr("data-type")))return q&&alert("Invalid data-type for file download function! Quitting."),Ca=!1;a=a.attr("data-type");void 0==c.attr("data-dlink")||E(c.attr("data-dlink"))||(c=c.attr("data-dlink"),e=Ec(e,!1),a=qd(a,e,c),console.log(a.name,a.path),rd(a.name,a.path))});d.find("a[class=plink]").unbind().bind("click",function(a){if(f(this).closest(".playlistItem").hasClass(wb))return!1});Ld&&d.find("a[class=premove]").unbind().bind("click",function(a){a.preventDefault();a=f(this).closest(".playlistItem"); var c=parseInt(a.attr("data-id"),10);if(a.hasClass(wb))return!1;K.removeTrack(c)})}function qd(a,b,c){"local"==a||"folder"==a?(c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),c.match(/^http([s]?):\/\/.*/)||(a=window.location.href,a=a.substr(0,a.lastIndexOf("/")+1),/^\.\.\//i.test(c)&&(c=c.substr(3),"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.lastIndexOf("/"))),a=a.substr(0,a.lastIndexOf("/")+1)),c=a+c),hc||(b=0<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):c)):"soundcloud"==a&&(c=c.replace(/\/stream\\?/, "/download").replace(/\.mp3/,""));b=b.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(b)||(b+=".mp3");return{name:b,path:c}}function rd(a,b){if(hc)if(Ca=!0,Ke)Od||(Rc=Pd())&&(Od=!0),Rc?Qd(Rc,a,b):Ca=!1;else{var c=Pd();c?Qd(c,a,b):Ca=!1}else Le.attr("src","dl.php?path="+b+"&name="+a)}function Qd(a,b,c){f.ajax({type:"POST",url:"mail.php",data:"mail="+a+"&name="+b+"&path="+c}).done(function(a){Ca=!1}).fail(function(a,b,c){q&&alert("Send email error: "+a.responseText);Rd();Ca=!1});ic.css({marginTop:-ic.height()/ 2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Ib&&clearTimeout(Ib);Ib=setTimeout(Rd,Me)}function Rd(){Ib&&clearTimeout(Ib);ic.stop().animate({opacity:0},{duration:500,complete:function(){ic.css("display","none")}})}function Pd(){for(var a=prompt("Please enter your email address where download link will be sent:"),b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!b.test(a)||E(a))&&null!=a;)a=prompt("Please enter a valid email address:");return a}function Je(){f(".hap_text_link").each(function(){var a= f(this),b=a.attr("href");"undefined"!==typeof b&&!1!==b&&-1<b.toLowerCase().indexOf(".mp3")&&a.prepend('<img class="play_link" src="'+jc+'"/>')});f(".hap_text_link, .hap_image_link").click(function(a){if(!l)return!1;a=f(this);var b=a.attr("href");if("undefined"===typeof b||!1===b)return!1;if(kc&&kc==b)return ob();ya();k.reSetCounter();kc=b;Sd=a;oa&&oa.attr("src",jc);a.hasClass("hap_text_link")&&(oa=a.find("img").attr("src",Td));$=kc;Ra=$.substr(0,$.lastIndexOf("."))+".ogg";Y=!0;O||"undefined"!==typeof h(r)&& h(r).pb_setAutoplay(!0);Ab();Sc();return!1})}function Gb(){Fa.length?Ne(Fa.shift()):(0==u.length&&p&&"true"==p.data("toremove")&&p.remove(),u.length>Jb&&(u=u.slice(0,Jb)),za())}function Ne(a){var b=a.id,c=a.type;f.ajax({url:"http://api.official.fm/tracks/"+b+"?fields=streaming,cover&api_version=2",dataType:"json",cache:!1}).done(function(a){var b={},d,f;a.track&&a.track.streaming&&a.track.streaming.http&&(a=a.track,b.type=c,b.length=a.duration?a.duration:null,b.mp3=a.streaming.http,b.ogg=a.streaming.http, d=a.artist?a.artist:"Official Fm artist",f=a.title?a.title:"Official Fm track",b.title=d+" - "+f,V&&(b.plink=V),G&&(b.dlink=G),M&&(b.download=M),a.cover.urls.small?b.thumb=a.cover.urls.small:N&&(b.thumb=N),u.push(b));Gb()}).fail(function(a,c,d){q&&alert("Playlist process failed, ofm: "+b);Gb()})}function Ud(){1<Tc?(eb+=1,eb<=Tc&&Fa.length<Jb?Hd():Fa.length?Gb():(w.shift(),F())):Fa.length?Gb():(0==u.length&&p&&"true"==p.data("toremove")&&p.remove(),w.shift(),F())}function Hd(){f.ajax({url:"ofm_playlist"== Mc?"http://api.official.fm/playlists/"+fc+"/tracks?api_version=2&page="+eb+"":"http://api.official.fm/projects/"+fc+"/tracks?fields=cover&api_version=2&page="+eb+"",dataType:"json",cache:!1}).done(function(a){Tc=a.total_pages;if(a.tracks&&a.tracks.length){var b=0,c=a.tracks.length,e;c>Jb&&(c=Jb);for(b;b<c;b++)e=a.tracks[b].track,e.url&&(e=e.url.substr(e.url.lastIndexOf("/")+1),e=e.substr(0,e.indexOf("?")),Fa.push({id:e,type:Mc}))}Ud()}).fail(function(a,b,c){q&&alert("Playlist process failed, ofm: "+ fc);Ud()})}function Lc(a,b){f.ajax({url:b,dataType:"jsonp",success:function(b){if("youtube_single"==a){var e={};(b=b.data)?b.accessControl?(e.type="youtube_single",e.mp3=b.id,e.ogg="",e.title=b.title?b.title:"",e.description=b.description?b.description:"",b.thumbnail?e.thumb=b.thumbnail.hqDefault?b.thumbnail.hqDefault:b.thumbnail.sqDefault:N&&(e.thumb=N),V&&(e.plink=V),G&&(e.dlink=G),M&&(e.download=M),u.push(e),za()):(w.shift(),F()):(q&&alert("Playlist process failed, youtube single: "+Gd),p&&"true"== p.data("toremove")&&p.remove(),w.shift(),F())}else if(b.error)q&&alert("Playlist process failed, youtube playlist: "+ec),p&&"true"==p.data("toremove")&&p.remove(),w.shift(),F();else if(b.data.items){var e=b.data.items.length,n=0,d;for(n;n<e;n++)e>Sa&&(e=Sa),(d=b.data.items[n].video)&&d.accessControl&&(obj={type:"youtube_playlist"},obj.mp3=d.id,obj.ogg="",obj.title=d.title?d.title:"",obj.description=d.description?d.description:"",d.thumbnail?obj.thumb=d.thumbnail.hqDefault?d.thumbnail.hqDefault:d.thumbnail.sqDefault: N&&(obj.thumb=N),V&&(obj.plink=V),G&&(obj.dlink=G),M&&(obj.download=M),u.push(obj));db<=Sa?(db+=Oe,b="http://gdata.youtube.com/feeds/api/playlists/"+ec+"?start-index="+db+"&max-results=50&v=2&format=5&alt=jsonc",Lc("youtube_playlist",b)):(u.length>Sa&&(u=u.slice(0,Sa)),za())}else u.length>Sa&&(u=u.slice(0,Sa)),za()},error:function(a){q&&alert("Playlist process failed, youtube: "+b);p&&"true"==p.data("toremove")&&p.remove();w.shift();F()}})}function Pe(){Vd?H?vb?v.initVideo($):(l=!1,Uc=!0,Xb("on")): v.initVideo($):(Kb=0==d.find("div[class='youtubeIframeMain']").length?f("<div/>").css({display:"block",left:"-10000px"}).addClass("youtubeIframeMain").appendTo(d):d.find("div[class='youtubeIframeMain']"),v=f.youtubePlayer({parent:K,autoPlay:Wd,defaultVolume:z,mediaPath:$,youtubeHolder:Kb,youtubeChromeless:Qe,isMobile:H,initialAutoplay:Re,quality:Se}),f(v).bind("ap_YoutubePlayer.YT_READY",function(){Vc||Kb.css("left","-10000px");Ba=!0}),f(v).bind("ap_YoutubePlayer.START_PLAY",function(){Z&&clearInterval(Z); Z=setInterval(Te,Wc);Uc&&(v.stop(),v.initVideo($),Uc=!1);!vb&&H&&(Xb("off"),l=vb=!0)}),f(v).bind("ap_YoutubePlayer.END_PLAY",function(){lc()}),f(v).bind("ap_YoutubePlayer.STATE_PLAYING",function(){mc()}),f(v).bind("ap_YoutubePlayer.STATE_PAUSED",function(){H?"iPhone"==fb||"iPod"==fb?B&&(B=!1,sa("off")):nc():nc()}),Vd=!0);Q=ac=!0}function Xb(a){"on"==a?(Vc=!0,Kb.css({top:"0px",left:"0px"})):(Kb.css("left","-10000px"),Vc=null)}function Ue(){var a=A.substr(1);embedFlashMain(a);a=r.substr(1);embedFlashAudio(a); "undefined"!==typeof h(A)?pa=setInterval(Ve,oc):(q&&alert("Problems with flash initialization (startFlashInit)! Flash for youtube not initialized! Sound_id: "+L),Xd())}function Ve(){void 0!=h(A).setData&&(pa&&clearInterval(pa),h(A).setData(g),d.find(".flashMain").css("left","-10000px"),Xd())}function Xd(){"undefined"!==typeof h(r)?pa=setInterval(We,oc):(q&&alert("Problems with flash initialization (checkFlashSound)! Flash audio backup not initialized! Sound_id: "+L),Yd())}function Xe(){var a=r.substr(1); embedFlashAudio(a);var b=setTimeout(function(){b&&clearTimeout(b);"undefined"!==typeof h(r)?pa=setInterval(Ye,oc):(q&&alert("Problems with flash initialization (checkFlashSound_b)! Flash audio backup not initialized! Sound_id: "+L),gb())},500)}function We(){void 0!=h(r).setData&&(pa&&clearInterval(pa),h(r).setData(g),d.find(".flashAudio").css("left","-10000px"),Yd())}function Ye(){console.log("checkFlashReady_b");void 0!=h(r).setData&&(pa&&clearInterval(pa),h(r).setData(g),d.find(".flashAudio").css("left", "-10000px"),gb())}function Yd(){if(U){var a=T.substr(1);embedFlashCircle(a);"undefined"!==typeof h(T)?pa=setInterval(Ze,oc):(q&&alert("Problems with flash initialization (checkFlashCircle)! Flash circle backup (canvas support is false) not initialized! Sound_id: "+L),gb())}else f(".circleMain").remove(),gb()}function Ze(){void 0!=h(T).setData&&(pa&&clearInterval(pa),h(T).setData(hb),gb())}function h(a){"#"==a.charAt(0)&&(a=a.substr(1));return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]} function dc(a){if(E(Xc))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),w.shift(),F(),!1;/\/likes$/.test(a)&&(a=a.replace(/\/likes$/,"/favorites"));var b=$e(a,Xc);f.ajax({url:b,dataType:"jsonp",cache:!1}).done(function(b){var e,d;if(b.tracks){e=b.tracks.length;e>ga&&(e=ga);for(d=0;d<e;d++)b.tracks[d].streamable&&b.tracks[d].stream_url?u.push(Yc(b.tracks[d])):(e+=1,e>b.tracks.length&&(e=b.tracks.length));u.length>ga&&(u=u.slice(0,ga));za()}else if(b.duration)b.permalink_url= a,b.streamable&&b.stream_url&&u.push(Yc(b)),u.length>ga&&(u=u.slice(0,ga)),za();else if(b.username)Lb=/likes/.test(a)?b.uri+"/likes":/favorites/.test(a)?b.uri+"/favorites":b.uri+"/tracks",dc(Lb);else if(f.isArray(b)){e=b.length;e>ga&&(e=ga);for(d=0;d<e;d++)b[d].streamable&&b[d].stream_url?u.push(Yc(b[d])):(e+=1,e>b.length&&(e=b.length));e==Zd?(Fb+=Zd,Fb<ga?dc(Lb):(u.length>ga&&(u=u.slice(0,ga)),za())):(u.length>ga&&(u=u.slice(0,ga)),za())}else b.kind&&"group"==b.kind?(Lb=b.uri+"/tracks",dc(Lb)):(w.shift(), F())}).fail(function(b,e,d){q&&alert("Playlist process failed, soundcloud: "+a);w.shift();F()})}function Yc(a){var b={type:"soundcloud"};a.duration&&(b.length=a.duration);b.mp3=a.stream_url+(/\?/.test(a.stream_url)?"&":"?")+"consumer_key="+Xc;b.ogg="";b.title=a.title;V&&(b.plink=V);a.downloadable&&a.download_url?(G&&(b.dlink=G),M&&(b.download=M)):(G&&!0!=G&&"true"!=G&&(b.dlink=G),M&&!0!=M&&"true"!=M&&(b.download=M));a.artwork_url?b.thumb=a.artwork_url:N&&(b.thumb=N);return b}function $e(a,b){return(/api\./.test(a)? a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&offset="+Fb+"&consumer_key="+b+"&callback=?"}function Te(){if(S){var a=v.getCurrentTime(),b=v.getDuration();qa=v.getVideoBytesLoaded()/v.getVideoBytesTotal();isNaN(a)||isNaN(b)?Ub=!0:(Ub=!1,ta.html(rb(a)+Ta),ua.html(sb(b)),U)?ja&&(isNaN(qa)||Bc(qa),ea=a/b,!W&&B&&(uc||Ma(a/b))):(isNaN(qa)||va.width(qa*I),W||ia.width(a/b*I))}}function $d(){var a=m.currentTime,b=m.duration;void 0==m.buffered||0==m.buffered.length||isNaN(b)||(qa=m.buffered.end(0)/ b);isNaN(a)||isNaN(b)||(ta&&ta.html(rb(a)+Ta),ua&&ua.html(sb(b)));if(U)ja&&(isNaN(qa)||Bc(qa),isNaN(a)||isNaN(b)||(ea=a/b,!W&&B&&Ma(a/b)));else{if(!isNaN(qa)){var c=qa*I;c>I&&(c=I);va&&va.width(c)}isNaN(a)||isNaN(b)||!W&&ia&&ia.width(a/b*I)}}function lc(){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(K,L,k.getCounter());ya();k.advanceHandler(1,!0)}function mc(){Hc||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(K,L,k.getCounter()),Hc=!0);"undefined"!==typeof audioPlayerSoundPlay&& audioPlayerSoundPlay(K,L,k.getCounter());U&&ja&&pb()}function nc(){"undefined"!==typeof audioPlayerSoundPause&&audioPlayerSoundPause(K,L,k.getCounter())}function Sc(){if("youtube_single"==x||"youtube_playlist"==x)S?(Pe(),H&&!vb&&Y&&(l=!1,Xb("on"))):("undefined"!==typeof h(A)&&(h(A).pb_play($,0,100,100,"youtube",Y),Q=!0),ac=Ba=!0);else if(O){if(ae)Ua?m.src=$:Mb&&(m.src=Ra),m.load(),m.play();else{var a="",a=af?a+'<audio class="hap_audio_cont" preload="auto">':a+'<audio class="hap_audio_cont" preload="none">', a=a+('<source src="'+$+'" type="audio/mpeg" />'),a=a+('<source src="'+Ra+'" type="audio/ogg" />');be.html(a+"</audio>");Eb=be.find(".hap_audio_cont");m=Eb[0];m.volume=z;Y&&(m.load(),m.play());ae=!0}Eb.bind("ended",function(a){lc()}).bind("pause",function(a){nc()}).bind("play",function(a){Z&&clearInterval(Z);Z=setInterval($d,Wc);mc()}).bind("canplay",function(a){qb&&(m.seekable&&0<m.seekable.length&&(m.currentTime=qb*m.duration),qb=null)}).bind("canplaythrough",function(a){}).bind("loadedmetadata", function(a){}).bind("error",function(a){}).bind("abort",function(a){}).bind("stalled",function(a){}).bind("suspend",function(a){});Z&&clearInterval(Z);Z=setInterval($d,Wc)}else"undefined"!==typeof h(r)&&h(r).pb_initAudio($);Y?(B=!0,Na("off")):(B=!1,sa("off"));Za();"youtube_single"!=x&&"youtube_playlist"!=x&&(Q=!0);Y=!0;!H&&v&&v.setAutoPlay(!0)}function gb(){var a=[d.find(".controls_next"),d.find(".controls_prev"),d.find(".controls_toggle"),d.find(".player_volume"),d.find(".player_download"),d.find(".player_loop"), d.find(".player_shuffle")],b,c=a.length,e=0;for(e;e<c;e++)b=f(a[e]).css("cursor","pointer").bind(Qa,pe),bf&&!H&&b.bind("mouseover",qe).bind("mouseout",we);bb?wd(bb):l||Id()}function Nd(){if(!U&&(I=vc.width(),!isNaN(qa)&&va&&va.width(qa*I),!W&&ia)){var a,b;if("youtube_single"!=x&&"youtube_playlist"!=x){if(O)m&&(a=m.currentTime,b=m.duration);else if("undefined"!==typeof h(r))try{a=h(r).pb_getFlashPosition,b=h(r).pb_getFlashDuration()}catch(c){}try{a&&!isNaN(a)&&b&&!isNaN(b)&&ia.width(a/b*I)}catch(e){}}}Md&& !fa&&Cc();ib&&ha&&ha.checkSize()}function Ic(){ce.css("display","none")}function xd(){ce.css("display","block")}function ud(){Z&&clearInterval(Z);ib&&ha&&ha.deactivate();Wa.html(Nb);ta.html(Zc+Ta);ua.html($c);U?ja&&(ea=0,J.clearRect(0,0,aa,da),Ja.clearRect(0,0,aa,da)):(ia.width(0),va.width(0));sa("off");bc.css("display","none")}function Gc(){Z&&clearInterval(Z);Pa||(ib&&ha&&ha.deactivate(),Wa.html(Nb));ta.html(Zc+Ta);ua.html($c);U?ja&&(ea=0,J.clearRect(0,0,aa,da),Ja.clearRect(0,0,aa,da)):(ia.width(0), va.width(0));sa("off");bc.css("display","none")}function sa(a){"on"==a?d.find(".controls_toggle").find("img").attr("src",cf):d.find(".controls_toggle").find("img").attr("src",df);oa&&oa.hasClass("play_link")&&oa.attr("src",jc);U&&(ja?(J.clearRect(0,0,aa,da),Ma(ea),pb()):"undefined"!==typeof h(T)&&h(T).pb_toggle_icon("play"))}function Na(a){"on"==a?d.find(".controls_toggle").find("img").attr("src",ef):d.find(".controls_toggle").find("img").attr("src",ff);oa&&oa.hasClass("play_link")&&Sd.hasClass("hap_text_link")&& oa.attr("src",Td);U&&(ja?(J.clearRect(0,0,aa,da),Ma(ea),pb()):"undefined"!==typeof h(T)&&h(T).pb_toggle_icon("pause"))}function rb(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function sb(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function Ha(a){if("string"===typeof a){if(Oc&&k&&-1!=k.getCounter()){var b=k.getCounter(); a=Pc(y[b].id)+Qc+a}}else{if("number"===typeof a){if(!k||0>a||a>C-1)return!1}else if(!k)return!1;b=k.getCounter();a=Ec(b)}ib&&ha?(ha.input(a),ha.activate()):Wa&&Wa.html(a)}function Ec(a,b){if("undefined"===typeof b||null===b)b=!0;return y[a]&&y[a].title&&!E(y[a].title)?b?Oc?Pc(y[a].id)+Qc+y[a].title:y[a].title:y[a].title:Nb}function Pc(a){return 9>a?"0"+(a+1):a+1}function gf(a){var b=[],c=[],e=0;for(e;e<a;e++)b[e]=e;var e=0,d;for(e;e<a;e++)d=Math.round(Math.random()*(b.length-1)),c[e]=b[d],b.splice(d, 1);return c}function hf(a){var b=[],c=0;for(c;c<a;c++)b[c]=c;return b}function E(a){return 0==a.replace(/^\s+|\s+$/g,"").length}function Fe(a){a=a.split(":");for(var b=0,c=1;0<a.length;)b+=c*parseInt(a.pop()),c*=60;return b}function Ee(a){if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b}if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");throw Error("No XML parser available");}function jf(a,b){return b-a}function Ae(a){if("string"=== typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;default:return Boolean(a)}else if("boolean"===typeof a)return Boolean(a)}function kf(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function Fd(a){var b,c="",e,d="",g="",h="",l,m,p,k;b=a.type.toLowerCase();a.origtype&&(c=a.origtype.toLowerCase());a.mp3?e=a.mp3:a.path&&(e=a.path);a.ogg&&(d=a.ogg);a.title&&(g=a.title);a.thumb&&(h=a.thumb); a.download&&("youtube_single"==b||"youtube_playlist"==b?!0==a.download||"true"==a.download||E(a.download)||(l=a.download):l=!0==a.download?!0:a.download);a.plink&&(p=a.plink);a.dlink&&("youtube_single"==b||"youtube_playlist"==b?!0==a.dlink||"true"==a.dlink||E(a.dlink)||(m=a.dlink):m=!0==a.dlink?!0:a.dlink);"local"==b?"title"==Ga?k="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+e+"' data-ogg='"+d+"' data-thumb='"+h+"' data-title='"+g+"'><a class='playlistNonSelected' href='#'>"+ g+"</a></li>":"thumb"==Ga?k="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+e+"' data-ogg='"+d+"' data-thumb='"+h+"' data-title='"+g+"'><a class='playlistNonSelected' href='#'><img src='"+h+"' alt='thumb'/></a></li>":"all"==Ga&&(k="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+e+"' data-ogg='"+d+"' data-thumb='"+h+"' data-title='"+g+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+h+"' alt='thumb'/></span><span class='hap_title'><p>'"+ g+"'</p></span></a></li>"):(k="<li class= 'playlistItem' data-type='"+b+"' data-path='"+e+"' data-thumb='"+h+"'></li>","database_data"==b&&(e=a.table?a.table:null,c=a.limit?a.limit:null,a=a.range?a.range:null,e&&(e=' data-table="'+e+'" ',d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index)),c&&(e=' data-limit="'+c+'" ',d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index)),a&&(e=' data-range="'+a+'" ',d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index))));l&&(e=' data-download="'+l+'" ', d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index));"local"==b?(m&&(e="<a class='dlink' href='#' data-dlink='"+m+"'><img src='"+Kd+"' alt='download'/></a>",d=k.match(/\<\/a\>\<\/li\>/),k=k.slice(0,d.index)+e+k.slice(d.index)),p&&(e="<a class='plink' href='"+p+"' target='_blank'><img src='"+Jd+"' alt='purchase'/></a>",d=k.match(/\<\/a\>\<\/li\>/),k=k.slice(0,d.index)+e+k.slice(d.index))):(m&&(e=' data-dlink="'+m+'" ',d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index)),p&&(e=' data-plink="'+ p+'" ',d=k.match(/\>/),k=k.slice(0,d.index)+e+k.slice(d.index)));b=document.createElement("ul");b.innerHTML=k;return f(b.firstChild)}function Kc(a){a=f(a);var b;a=f("<div>").append(a.clone()).html();b=document.createElement("ul");b.innerHTML=a;return f(b.firstChild)}function jb(a){C=y.length;if(0<C){gc();var b=k.getCounter();a==b?(td(),k.setPlaylistItems(C)):(k.setPlaylistItems(C,!1),a<b&&k.reSetCounter(k.getCounter()-1));Pa&&Ha()}else Bb(),bb=null,"undefined"!==typeof playlistEmpty&&playlistEmpty(K, L)}var l=!1,K=this,D="";f("body");var lf=f(window),Aa=f(document),ad,H=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),hc=!1,kb=navigator.userAgent,fb;if(-1<kb.indexOf("iPhone")||-1<kb.indexOf("iPod")||-1<kb.indexOf("iPad"))hc=!0,-1<kb.indexOf("iPhone")?fb="iPhone":-1<kb.indexOf("iPod")?fb="iPod":-1<kb.indexOf("iPad")&&(fb="iPad");var me=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),zd=!1,Dd=!1,de=function(){var a=-1;"Microsoft Internet Explorer"==navigator.appName&& null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1));return a}();-1!=de&&(zd=!0,9>de&&(Dd=!0));var Ob=document.createElement("audio"),Ua,Mb,S=!1;Ob.canPlayType?(S=!0,Ua=!!Ob.canPlayType&&""!=Ob.canPlayType("audio/mpeg"),Mb=!!Ob.canPlayType&&""!=Ob.canPlayType('audio/ogg; codecs="vorbis"')):(Ua=!0,Mb=!1);var xe=D+g.buttonsUrl.prev,re=D+g.buttonsUrl.prevOn,ye=D+g.buttonsUrl.next,se=D+g.buttonsUrl.nextOn,df=D+g.buttonsUrl.play,cf=D+g.buttonsUrl.playOn,ff=D+g.buttonsUrl.pause, ef=D+g.buttonsUrl.pauseOn,Yb=D+g.buttonsUrl.loop,yb=D+g.buttonsUrl.loopOn,dd=D+g.buttonsUrl.volume,te=D+g.buttonsUrl.volumeOn,ed=D+g.buttonsUrl.mute,ue=D+g.buttonsUrl.muteOn,Zb=D+g.buttonsUrl.shuffle,zb=D+g.buttonsUrl.shuffleOn,ze=D+g.buttonsUrl.download,ve=D+g.buttonsUrl.downloadOn,Jd=D+g.buttonsUrl.purchaseTrackIcon,Kd=D+g.buttonsUrl.downloadTrackIcon,Ge=D+g.buttonsUrl.removeTrackIcon,Td=D+g.buttonsUrl.link_pause,jc=D+g.buttonsUrl.link_play,d=f(this),U=d.hasClass("hap_circle"),ja=!1;S&&kf()&&(ja= !0);var yd="html5audio-popup"==d.attr("id"),pc=d.find(".playlistHolder"),Ea=d.find(".playlist_inner").css("opacity",0);d.find(".playerHolder");d.find(".player_mediaTime");var ta=d.find(".player_mediaTime_current"),ua=d.find(".player_mediaTime_total"),he=d.find(".player_mediaName_Mask"),Wa=d.find(".player_mediaName");d.find(".player_controls");var mf=d.find(".player_volume"),ce=d.find(".preloader"),bc=d.find(".player_download"),Dc=d.find(".componentPlaylist"),Ka=f(g.playlistList);yd&&window.opener&& (Ka=window.opener.jQuery(g.playlistList));var L=g.sound_id,Y=g.autoPlay,Re=g.autoPlay,Wd=g.autoPlay,af=g.autoLoad;H&&(Y=!1,Wd=g.autoPlay=!1);var nf=g.useOnlyMp3Format,Xc=g.soundcloudApiKey,ga=g.soundcloud_result_limit,De=g.podcast_result_limit,Sa=g.yt_playlist_result_limit,Jb=g.ofm_result_limit,ib=g.useSongNameScroll,Pa=g.autoSetSongTitle,la=g.loopingOn,ma=g.randomPlay,Ta=g.mediaTimeSeparator,nd=g.seekTooltipSeparator,Nb=g.defaultArtistData,Oc=g.useNumbersInPlaylist,Qc=g.titleSeparator,bb=g.activePlaylist, q=g.useAlertMessaging,Md=g.activatePlaylistScroll,ub=g.playlistScrollOrientation.toLowerCase(),Ie=g.sortablePlaylistItems,Ke=g.autoReuseMailForDownload,Ld=g.useRemoveBtnInTracks,of=g.useVolumeTooltip,pf=g.useSeekbarTooltip,Ga=g.playlistItemContent.toLowerCase(),qf=g.useKeyboardNavigation,bf=g.useBtnRollovers,vd=g.usePlaylistRollovers,Zc=ta.html(),$c=ua.html();Wa.html(Nb);ta.html(Zc+Ta);ua.html($c);var O=!0;if(!S||!Ua&&nf)O=!1;var Oa,na,Db,ab,$a,fa=!1,Bd="hap_processed",Cd="hap_draggable",Jc,V,Od, Rc,Ca,G,M,$b,N,cc,Sd,oa,kc,Nc=!1;void 0!=pc.attr("data-playlistLocked")&&(Nc=!0);var wb="playlist_locked",Cb=!1,Hb,p,s=null,t=!0,Ub=!1,Hc=!1,Lb,Fb,Zd=50,x,Q=!1,$="",Ra="",B=!1,Wc=250,Z,qa;la&&d.find(".player_loop").find("img").attr("src",yb);ma&&d.find(".player_shuffle").find("img").attr("src",zb);var y=[],Da=[],P=[],C=0,ba,Ed=0==d.find("div[id='feedParser']").length?f('<div id="feedParser"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(d):d.find("div[id='feedParser']"),Le= 0==d.find("iframe[id='dl_iframe']").length?f('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(d):d.find("iframe[id='dl_iframe']"),cb=f("<div/>"),Ad=f("<div/>");if(hc)var Ib,Me=3E3,ic=0==pc.find("div[id='download_confirm']").length?f('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').addClass("download_confirm").css({opacity:0,zIndex:1E3}).appendTo(pc):pc.find("div[id='download_confirm']");var u=[],w=[],r=g.flashAudio,T=g.circleMain;if(O)var ae= !1,Eb,m,be=0==d.find("div[id='hap_audioHolder']").length?f('<div id="hap_audioHolder"/>').css({position:"absolute",left:"-10000px"}).appendTo(d):d.find("div[id='hap_audioHolder']");var v,db,Oe=50,ec,Vd=!1,Qe=!1,Gd,Kb,A=g.flashYoutube,Se=!1,oc=100,pa,ac=!1,Ba=!1,vb=!1,Vc,Uc=!1,Fa=[],Mc,fc,eb,Tc,ha;ib&&ge();var k=f.playlistManager({randomPlay:ma,loopingOn:la});f(k).bind("ap_PlaylistManager.COUNTER_READY",function(){var a=k.getCounter(),b=y[a];b&&!Nc&&(sd(),Pa&&Ha(),x=b.origtype?b.origtype:b.type,$= b.mp3,Ra=b.ogg,b.download?$b=!0:$b=null,Ab(),Sc(),"undefined"!==typeof itemTriggered&&itemTriggered(K,L,a))});f(k).bind("ap_PlaylistManager.PLAYLIST_END",function(){sd();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(K,L);B=!1;sa("off")});f(k).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(K,L)});var Qa="",Xa="",Ya="",ra;"ontouchstart"in window?(ra=!0,Qa="touchstart.ap",Xa="touchmove.ap",Ya="touchend.ap"): (ra=!1,Qa="mousedown.ap",Xa="mousemove.ap",Ya="mouseup.ap");var nb=!1,rc,Qb=!1,z=g.defaultVolume;0>z&&(z=0);0==z?rc=0.5:1<z&&(z=1);var X=d.find(".volume_seekbar").css("cursor","pointer").bind(Qa,function(a){ie(a);return Qb=!1}),mb="horizontal";void 0!=X.attr("data-orientation")&&(mb=X.attr("data-orientation").toLowerCase());if(void 0!=X.attr("data-autoHide")){var nb=!0,xb=!1,R,Sb=parseInt(X.attr("data-autoHide"),10),Rb=function(){R&&clearTimeout(R);X.css("display","none");xb=!1};H||mf.bind("mouseover", function(){if(!l)return!1;R&&clearTimeout(R);X.css("display","block");xb=!0;return!1}).bind("mouseout",function(){if(!l)return!1;R&&clearTimeout(R);R=setTimeout(Rb,Sb);return!1})}var lb=!1,Pb=d.find(".volume_bg");if("horizontal"==mb)var ca=Pb.width(),sc=d.find(".volume_level").css("width",z*ca+"px");else ca=Pb.height(),sc=d.find(".volume_level").css("height",z*ca+"px");if(of&&!H){X.bind("mouseover",tc);var wa=d.find(".player_volume_tooltip"),je=parseInt(wa.css("top"),10);wa.bind("mouseenter",function(){X.unbind("mouseover", tc);wa.css("display","none")}).bind("mouseleave",function(){X.bind("mouseover",tc)})}else d.find(".player_volume_tooltip").remove();var La,qb,W=!1,vc=d.find(".progress_bg"),va=d.find(".load_progress"),ia=d.find(".play_progress"),Ia=d.find(".player_progress"),I=vc.width(),uc=!1;if(U){var Va=d.find(".load_canvas").css("cursor","pointer"),bd=d.find(".play_canvas"),xa=d.find(".circlePlayer"),ee=parseFloat(xa.attr("data-offOpacity"),10),fe=parseFloat(xa.attr("data-onOpacity"),10);H&&(ee=fe=1);var hb={flash_id:g.flash_id, strokeSize:parseInt(xa.attr("data-strokeSize"),10),play_color:bd.attr("data-bgcolor"),load_color:Va.attr("data-bgcolor"),tolerance:parseInt(xa.attr("data-tolerance"),10),offOpacity:ee,onOpacity:fe,circleWidth:Va.width(),circleHeight:Va.height()};if(ja){var tb=hb.strokeSize,Ac=hb.play_color,ne=hb.load_color,J=Va[0].getContext("2d"),Ja=bd[0].getContext("2d"),od=2*Math.PI,Wb=Math.PI/2,aa=hb.circleWidth,da=hb.circleHeight,zc=aa/2,jd=zc-tb,le=g.tolerance,id,xc=!1,ea=0;Va.bind(Qa,function(a){xc=wc(a)?!1: !0;gd(a);return!1});Ia=Va}else Va.remove(),bd.remove()}else Ia=d.find(".player_progress").css("cursor","pointer").bind(Qa,function(a){gd(a);return!1});if(pf&&!H){Ia.bind("mouseover",yc);var ka=d.find(".player_progress_tooltip").css("zIndex",50);ka.find("p").html("0:00"+nd+"0:00");ka.bind("mouseenter",function(){Ia.unbind("mouseover",yc);ka.css("display","none")}).bind("mouseleave",function(){Ia.bind("mouseover",yc)})}else d.find(".player_progress_tooltip").remove();this.flashVideoPause=function(){sa("off"); B=!1;nc()};this.flashVideoResume=function(){Na("off");B=!0;mc()};this.flashVideoEnd=function(){lc()};this.flashVideoStart=function(){Na("off");Q=B=!0;mc()};this.flashYoutubeData=function(a,b,c,e){U?(isNaN(a)||isNaN(b)||"undefined"!==typeof h(T)&&h(T).pb_drawLoadbar(a/b),isNaN(c)||isNaN(e)||(ea=c/e,W||"undefined"!==typeof h(T)&&h(T).pb_drawSeekbar(c/e))):(isNaN(a)||isNaN(b)||va&&va.width(a/b*I),isNaN(c)||isNaN(e)||ia&&ia.width(c/e*I));isNaN(c)||isNaN(e)||(ta&&ta.html(rb(c)+Ta),ua&&ua.html(sb(e)))}; this.flashAudioData=function(a,b,c,e){a/=b;U?ja?(isNaN(a)||Bc(a),isNaN(c)||isNaN(e)||(ea=c/e,!W&&B&&Ma(c/e))):(null!==a&&"undefined"!==typeof h(T)&&h(T).pb_drawLoadbar(a),isNaN(c)||isNaN(e)||(ea=c/e,W||"undefined"!==typeof h(T)&&h(T).pb_drawSeekbar(c/e))):(!W&&ia&&ia.width(c/e*I),null!==a&&(a*=I,a>I&&(a=I),va&&va.width(a)),isNaN(c)||isNaN(e)||(ta&&ta.html(rb(c)+Ta),ua&&ua.html(sb(e))))};this.flashAudioEnd=function(){lc()};this.flashCircleToggle=function(a){ob()};this.flashCircleOverLoader=function(a){ka.css("display", "block");md(a)};this.flashCircleOutLoader=function(){ka.css("display","none")};this.flashCircleSeek=function(a){kd(a)};this.embedFlash=function(){if(S)g.useOnlyMp3Format&&!Ua&&(a=r.substr(1),embedFlashAudio(a));else{var a=A.substr(1);embedFlashMain(a);a=r.substr(1);embedFlashAudio(a);U&&(a=T.substr(1),embedFlashCircle(a))}};qf&&Aa.keyup(function(a){if(!l||t)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=a.keyCode;37==a?K.previousAudio():39== a?K.nextAudio():32==a?K.toggleAudio():77==a&&(qc(),Za());return!1});lf.resize(function(){if(!l||t)return!1;ad&&clearTimeout(ad);ad=setTimeout(Nd,150)});this.setPlayIcon=function(){oa&&oa.hasClass("play_link")&&oa.attr("src",jc);B=!1};this.playAudio=function(){if(!l||t||!s||B||!Q)return!1;if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?v.togglePlayback():"undefined"!==typeof h(A)&&h(A).pb_togglePlayback()}else O?m&&m.play():"undefined"!==typeof h(r)&&h(r).pb_play();Na("off");Q=B=!0}; this.pauseAudio=function(){if(!l||t||!s||!B||!Q)return!1;if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?v.togglePlayback():"undefined"!==typeof h(A)&&h(A).pb_togglePlayback()}else O?m&&m.pause():"undefined"!==typeof h(r)&&h(r).pb_pause();sa("off");B=!1};this.toggleAudio=function(){if(!l||t||!s||!Q)return!1;ob()};this.stopAudio=function(){if(!l||t||!s||!Q)return!1;if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?v.stop():"undefined"!==typeof h(A)&&h(A).pb_dispose()}else O? m&&(m.src="",Ua?m.src=$:Mb&&(m.src=Ra)):"undefined"!==typeof h(r)&&h(r).pb_dispose();Gc();B=!1};this.checkAudio=function(a){if(!l||t||!s)return!1;a=a.toLowerCase();if(B){if("pause"==a)if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;S?v.togglePlayback():"undefined"!==typeof h(A)&&h(A).pb_togglePlayback()}else O?m&&m.pause():"undefined"!==typeof h(r)&&h(r).pb_pause();else if("stop"==a){if("youtube_single"==x||"youtube_playlist"==x){if(!Ba)return!1;v.stop()}else O?m&&(m.src="",Ua?m.src= $:Mb&&(m.src=Ra)):"undefined"!==typeof h(r)&&h(r).pb_dispose();Gc()}B=!1;sa("off")}};this.nextAudio=function(){if(!l||t||!s)return!1;ya();k.advanceHandler(1,!0)};this.previousAudio=function(){if(!l||t||!s)return!1;ya();k.advanceHandler(-1,!0)};this.loadAudio=function(a){if(!l||t||!s)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<C;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return q&&alert('Track with name "'+a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a> C-1)return q&&alert('Invalid track number. Track number "'+a+'" doesnt exist. Load audio failed.'),!1}else return q&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;ya();k.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!l||t)return!1;if("undefined"===typeof a)return q&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1;bb=a;wd(bb)};this.addTrack=function(a,b,c,e){if(!l||t)return!1;if("undefined"===typeof a)return q&& alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"===typeof b)return q&&alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof c)return q&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var d=1,g=!1;if("string"!==typeof c&&"[object Object]"!==Object.prototype.toString.call(c))if("[object Array]"===Object.prototype.toString.call(c))d=c.length,g=!0;else return q&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."), !1;na=e;a=a.toLowerCase();"visible"==a?(s&&fa&&Bb(),Db=!0,fa=!1):(s&&!fa&&Bb(),fa=ab=!0);Oa=!1;if(s)if("undefined"!==typeof na){if(0>na||na>C)return q&&alert('Invalid position to insert track to. Position number "'+e+'" doesnt exist. AddTrack failed.'),!1;na==C&&(Oa=!0)}else Oa=!0,na=C-1;else{if("undefined"!==typeof na){if(0!=na)return q&&alert('Invalid position to insert track to. Position number "'+e+'" doesnt exist. AddTrack failed.'),!1}else na=0;Oa=!0}xd();t=!0;Cb=!1;e=0;var h;h="playlist"+Math.floor(9999* Math.random());var k=f("<ul id = "+h+"></ul>");b=b.toLowerCase();for(e;e<d;e++)h=g?c[e]:c,"html"==b?Kc(h).appendTo(k):(h.type&&h.mp3||h.path)&&Fd(h).appendTo(k);w=[];cb.empty();k.appendTo(cb).find("li[class='playlistItem']").each(function(){w.push(f(this))});$a=!1;s||($a=!0,s="visible"==a?Ea:Ad);F()};this.inputAudio=function(a){if(!l||t)return!1;if("undefined"===typeof a)return q&&alert("inputAudio method requires data parameter. inputAudio failed."),!1;if("undefined"===a.mp3)return q&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."), !1;ya();k.reSetCounter();$=a.mp3;"undefined"!==a.ogg&&(Ra=a.ogg);"undefined"!==a.title?Ha(a.title):Ha(Nb);H&&(Y=!0,O||"undefined"!==typeof h(r)&&h(r).pb_setAutoplay(!0));Ab();Sc()};this.removeTrack=function(a){if(!l||t||!s)return!1;if("undefined"===typeof a)return q&&alert("removeTrack method requires track parameter. removeTrack failed."),!1;if("string"===typeof a){var b=0,c=!1;for(b;b<C;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return q&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'), !1;P[a]&&y[a]?(P[a].remove(),y.splice(a,1),jb(a)):q&&alert('RemoveTrack with name "'+a+'" failed.')}else if("number"===typeof a){if(0>a||a>C-1)return q&&alert('Invalid track number. Track number "'+a+'" doesnt exist. RemoveTrack failed.'),!1;P[a]&&y[a]?(P[a].remove(),y.splice(a,1),jb(a)):q&&alert('RemoveTrack with name "'+a+'" failed.')}else if("[object Array]"===Object.prototype.toString.call(a))if("string"===typeof a[0]?b=!0:"number"===typeof a[0]&&(b=!1),b){var b=0,c=a.length,e,d,f;b;a:for(;b< c;b++)if(d=a[b],"string"===typeof d){f=0;e=y.length;if(0==e){jb();break a}for(f;f<e;f++)if(d==y[f].title&&P[f]&&y[f]){P[f].remove();y.splice(f,1);jb(f);break}}}else a:for(a.sort(jf),b=0,c=a.length,b;b<c;b++){if(d=a[b],"number"===typeof d){e=y.length;if(0==e){jb();break a}-1<d&&d<e&&P[d]&&y[d]&&(P[d].remove(),y.splice(d,1),jb(d))}}else return q&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."),!1};this.destroyAudio=function(){if(!l||t||!s)return!1; td()};this.destroyPlaylist=function(){if(!l||t||!s)return!1;Bb()};this.setTitle=function(a){if(!l||t||!s)return!1;Ha(a)};this.toggleShuffle=function(){if(!l||t)return!1;ma?(d.find(".player_shuffle").find("img").attr("src",Zb),ma=!1):(d.find(".player_shuffle").find("img").attr("src",zb),ma=!0);k.setRandom(ma)};this.toggleLoop=function(){if(!l||t)return!1;la?(d.find(".player_loop").find("img").attr("src",Yb),la=!1):(d.find(".player_loop").find("img").attr("src",yb),la=!0);k.setLooping(la)};this.setVolume= function(a){if(!l||t)return!1;0>a?a=0:1<a&&(a=1);z=a;Za()};this.getVolume=function(){return l?z:!1};this.setAutoPlay=function(a){if(!l)return!1;Y=a;O||"undefined"!==typeof h(r)&&h(r).pb_setAutoplay(a)};this.getAutoPlay=function(){return l?Y:!1};this.getIsMobile=function(){return H};this.getMobileType=function(){return fb};this.getSetupDone=function(){return l};this.getPlaylistLoaded=function(){return Cb};this.getPlaylistTransition=function(){return t};this.getMediaPlaying=function(){return!l||t?!1: B};this.getAudioInited=function(){return!l||t?!1:Q};this.getMediaType=function(){return!l||t?!1:x};this.getActiveItem=function(){return!l||t?!1:k.getCounter()};this.getPlaylistItems=function(a){if(!l||t||!P||0==P.length)return!1;if("string"===typeof a)return P;if("number"===typeof a)return 0>num||num>C-1||!P[num]?!1:P[num]};this.getMediaCount=function(){return!l||t?!1:isNaN(C)?0:C};this.getPlaylistHidden=function(){return!l||t?!1:fa};this.getPlaylistList=function(){return l&&Ka&&0!=Ka.length?Ka:!1}; this.orderPlaylist=function(a,b){if(!l||!s)return!1;if("undefined"===typeof a)return q&&alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var c=s.children("li"),d=c.length;if(0==d)return!1;var g=a.toLowerCase();if("reverse"==g)s.append(c.get().reverse());else if("random"==g||"remap"==g||"swap"==g){if("random"==g)b=gf(d);else if("remap"==g){if("undefined"===typeof b||b.length!=d)return!1}else if("swap"==g){if("undefined"===typeof b||2!=b.length)return!1;c=hf(d);c.splice(b[1], 1,b[0]);c.splice(b[0],1,b[1]);b=f.extend(!0,[],c)}else return!1;orderedItems=jQuery.map(b,function(a){return jQuery(P).get(a)});s.empty().html(orderedItems)}else return q&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;gc();if(c=Ea.find("a[class=playlistSelected]").attr("data-id"))k.reSetCounter(c),Pa&&Ha()};this.checkScroll=function(){if(!l||t||!s)return!1;Cc()};this.reinitScroll=function(){if(!l||t||!s)return!1;ba&&(ba.reinitialise(),"vertical"==ub?(ba.scrollToY(0), f(".jspPane").css("top","0px")):(ba.scrollToX(0),f(".jspPane").css("left","0px")));ib&&ha&&k&&-1!=k.getCounter()&&Pa&&Ha()};this.getPlaylistData=function(){return l&&!t&&s?y:!1};this.getSoundId=function(){return l?L:!1};this.getTouch=function(){return l?ra:!1};S?(f(".flashMain").remove(),f(".circleMain").remove(),O?(f(".flashAudio").remove(),gb()):Xe()):Ue();return this}})(jQuery);