(function(g){g.fn.html5audio=function(h){function de(){var a=0==e.find("div[class='fontMeasure']").length?g("<div/>").addClass("fontMeasure").appendTo(e):e.find("div[class='fontMeasure']");fa=new apTextScroller;fa.init(a,Va,ee,"left",h.scrollSeparator,h.scrollSpeed)}function fe(a){if(m&&!u&&!V){if(!kb){if(ra){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();kb=!0;za.bind(Wa,function(a){a:{var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();ad(c)}}).bind(Xa,function(a){a:if(kb){kb=!1;za.unbind(Wa).unbind(Xa);var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c= a;a.preventDefault();ad(c)}})}return!1}}function ad(a){"horizontal"==lb?z=Math.max(0,Math.min(1,(a.pageX-Pb.offset().left)/aa)):(z=Math.max(0,Math.min(1,(a.pageY-Pb.offset().top)/aa)),z=1-z);Ya()}function pc(){if(!m||u)return!1;Qb?(z=qc,Qb=!1):(qc=z,z=0,Qb=!0)}function Ya(){"horizontal"==lb?rc.css("width",z*aa+"px"):rc.css("height",z*aa+"px");O&&("youtube_single"==x||"youtube_playlist"==x?Q?v&&v.setVolume(z):"undefined"!==typeof k(A)&&k(A).pb_setVolume(z):M?n&&(n.volume=z):"undefined"!==typeof k(s)&& k(s).pb_setVolume(z));0<z?e.find(".player_volume").find("img").attr("src",bd):e.find(".player_volume").find("img").attr("src",cd);isMobile&&mb&&(P&&clearTimeout(P),P=setTimeout(Rb,Sb))}function sc(){mb&&P&&clearTimeout(P);va.css("display","block");W.bind("mousemove",dd).bind("mouseout",Tb);za.bind("mouseout",Tb)}function Tb(){mb&&(P&&clearTimeout(P),P=setTimeout(Rb,Sb));va.css("display","none");W.unbind("mousemove",dd).unbind("mouseout",Tb);za.unbind("mouseout",Tb)}function dd(a){if("horizontal"== lb){a=a.pageX-W.offset().left;if(isNaN(a))return!1;0>a?a=0:a>aa&&(a=aa);var b=parseInt(a-va.width()/2,10);va.css("left",b+"px");a=Math.max(0,Math.min(1,a/aa));a=parseInt(100*a,10)}else{a=a.pageY-W.offset().top;if(isNaN(a))return!1;0>a?a=0:a>aa&&(a=aa);b=parseInt(a-va.height()/2,10);va.css("top",b+ge+"px");a=Math.max(0,Math.min(1,a/aa));a=parseInt(100*(1-a),10)}va.find("p").html(a+" %")}function ed(a){if(m&&!u&&O&&!kb&&!Ub){if(!V){if(ra){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault(); V=!0;za.bind(Wa,function(a){a:{var c;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();fd(c,a)}}).bind(Xa,function(a){he(a)})}return!1}}function he(a){if(V){V=!1;za.unbind(Wa).unbind(Xa);var b;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches; else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else return!1;if(1<b.length)return!1;b=b[0]}else b=a;a.preventDefault();fd(b,a)}if(T)var c=setTimeout(function(){c&&clearTimeout(c);tc=!1},500);return!1}function fd(a,b){if(!T){Ka=a.pageX-uc.offset().left;0>Ka?Ka=0:Ka>G&&(Ka=G);ga.width(Ka);var c=Math.max(0,Math.min(1,Ka/G))}else if(ha){if(vc(b)){if(wc||gd>hd-ie)return!1;V||(nb(!0),H.clearRect(0,0,$,ba),La(ca),ob());return!1}if(!wc)return!1; tc=!0;var c=a.pageX-wa.offset().left-$/2,d=a.pageY-wa.offset().top-ba/2,c=Math.atan2(d,c);c>-1*Math.PI&&c<-0.5*Math.PI&&(c=2*Math.PI+c);ca=c=Math.max(0,Math.min((c+Math.PI/2)/2*Math.PI*10))/100;H.clearRect(0,0,$,ba);La(ca);ob()}if(isNaN(c))return!1;pb=ca;id(c)}function id(a){"youtube_single"==x||"youtube_playlist"==x?Q?(a=(a*v.getDuration()).toFixed(1),isNaN(a)||v.seek(a)):"undefined"!==typeof k(A)&&k(A).pb_seek(a):M?n&&n.seekable&&0<n.seekable.length&&(!je||isMobile?n.currentTime=a*n.duration:a* n.duration>=n.buffered.end(0)-5?n.currentTime=n.buffered.end(0)-5:n.currentTime=a*n.duration):"undefined"!==typeof k(s)&&k(s).pb_seek(a)}function xc(){O&&(ia.css("display","block"),Ga.bind("mousemove",jd).bind("mouseout",Vb),za.bind("mouseout",Vb))}function Vb(){O&&(ia.css("display","none"),Ga.unbind("mousemove",jd).unbind("mouseout",Vb),za.unbind("mouseout",Vb))}function jd(a){if(!T){a=a.pageX-Ga.offset().left;if(isNaN(a))return!1;0>a?a=0:a>G&&(a=G);var b=parseInt(a-ia.width()/2,10);ia.css("left", b+"px");b=Math.max(0,Math.min(1,a/G))}else if(ha){if(vc(a))return ia.css("display","none"),!1;b=a.pageX-wa.offset().left;a=a.pageY-wa.offset().top;a=Math.atan2(a-ba/2,b-$/2);a>-1*Math.PI&&a<-0.5*Math.PI&&(a=2*Math.PI+a);b=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;ia.css("display","block")}if(isNaN(b))return!1;kd(b)}function kd(a){if(isNaN(a))return!1;var b,c;"youtube_single"==x||"youtube_playlist"==x?Q?(c=v.getDuration(),b=a*c):"undefined"!==typeof k(A)&&(c=k(A).pb_getFlashDuration(),b= a*c):M?n&&(c=n.duration,b=a*c):"undefined"!==typeof k(s)&&(c=k(s).pb_getFlashDuration(),b=a*c);if(isNaN(b)||isNaN(c))return!1;ia.find("p").html(qb(b)+ld+rb(c))}function La(a){H.beginPath();H.arc($/2,ba/2,yc-sb/2,-Wb,md*a-Wb,!1);H.strokeStyle=zc;H.lineCap="butt";H.lineWidth=sb;H.stroke()}function Ac(a){Ha.beginPath();Ha.arc($/2,ba/2,yc-sb/2,-Wb,md*a-Wb,!1);Ha.strokeStyle=ke;Ha.lineCap="butt";Ha.lineWidth=sb;Ha.stroke()}function ob(){if(B)a=62,b=57,H.fillStyle=zc,H.fillRect(a,b,14,45),H.fillRect(a+ 23,b,14,45);else{var a=65,b=57,c=65-a,d=102-b,f=Math.atan2(d,c)-Math.PI/3,d=Math.sqrt(c*c+d*d),c=Math.cos(f)*d+a,f=Math.sin(f)*d+b;H.beginPath();H.fillStyle=zc;H.moveTo(a,b);H.lineTo(65,102);H.lineTo(c,f);H.fill()}}function vc(a){var b;if(ra){if(a.originalEvent.touches&&a.originalEvent.touches.length)a=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)a=a.originalEvent.changedTouches;else return!1;if(1<a.length)return!1;b=a[0]}else b=a;a=b.pageX- wa.offset().left;b=b.pageY-wa.offset().top;var c=$/2,d=ba/2;gd=Math.sqrt((a-c)*(a-c)+(b-d)*(b-d));return Math.sqrt((a-c)*(a-c)+(b-d)*(b-d))<hd}function Bc(a){R?"vertical"==tb?xa.outerHeight(!0)>=ub.height()?(R.reinitialise(),a&&(R.scrollToY(0),g(".jspPane").css("top","0px"))):(R.destroy(),R=null):(R.reinitialise(),a&&(R.scrollToX(0),g(".jspPane").css("left","0px"))):(a=e.find(".componentPlaylist"),R=a.jScrollPane().data().jsp,a.bind("jsp-initialised",function(a,c){}).jScrollPane({mouseWheelSpeed:20}), "horizontal"==tb&&(isMobile||a.bind("mousewheel",le)))}function le(a,b,c,d){if(!m||u)return!1;R&&R.scrollByX(100*(0<b?-1:1));return!1}function nb(a){if(B){if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;Q?v.togglePlayback():("undefined"!==typeof k(A)&&k(A).pb_togglePlayback(),O=!0)}else M?n&&n.pause():"undefined"!==typeof k(s)&&k(s).pb_pause();B=!1;sa("off")}else{if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;Q?isMobile?!vb&&X?(m=!1,Xb("on")):v.togglePlayback():v.togglePlayback(): ("undefined"!==typeof k(A)&&k(A).pb_togglePlayback(),O=!0)}else M?n&&n.play():"undefined"!==typeof k(s)&&k(s).pb_play();B=!0;Ma("off")}if(!a)return!1}function nd(a){if(!m||u)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget);var b=a.attr("data-id");if(a.closest(".playlistItem").hasClass(wb))return!1;X=!0;ya();p.processPlaylistRequest(b);return!1}function me(a){if(!m||u)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble= !0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("class").split(" ");if(-1!=g.inArray("controls_prev",a))X=!0,ya(),p.advanceHandler(-1,!0);else if(-1!=g.inArray("controls_toggle",a)){if(!O)return;nb()}else if(-1!=g.inArray("controls_next",a))X=!0,ya(),p.advanceHandler(1,!0);else if(-1!=g.inArray("player_volume",a))isMobile?mb?(P&&clearTimeout(P),xb?(W.css("display","none"),xb=!1):(W.css("display","block"),xb=!0,P=setTimeout(Rb,Sb))):(pc(),Ya()):(pc(),Ya());else if(-1!=g.inArray("player_download", a)){if(!Ba)if(a=x){var b=p.getCounter(),c=y[b].download,b=Cc(b,!1);a=od(a,b,c);pd(a.name,a.path)}else q&&alert("Invalid data-type for file download function! Quitting."),Ba=!1}else-1!=g.inArray("player_loop",a)?(ja?(e.find(".player_loop").find("img").attr("src",Yb),ja=!1):(e.find(".player_loop").find("img").attr("src",yb),ja=!0),p.setLooping(ja)):-1!=g.inArray("player_shuffle",a)&&(ka?(e.find(".player_shuffle").find("img").attr("src",Zb),ka=!1):(e.find(".player_shuffle").find("img").attr("src",zb), ka=!0),p.setRandom(ka));return!1}function ne(a){if(m)return a||(a=window.event),a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("class").split(" "),-1!=g.inArray("controls_prev",a)?e.find(".controls_prev").find("img").attr("src",oe):-1!=g.inArray("controls_toggle",a)?B?Ma("on"):sa("on"):-1!=g.inArray("controls_next",a)?e.find(".controls_next").find("img").attr("src",pe):-1!=g.inArray("player_volume",a)?0<z?e.find(".player_volume").find("img").attr("src", qe):e.find(".player_volume").find("img").attr("src",re):-1!=g.inArray("player_download",a)?e.find(".player_download").find("img").attr("src",se):-1!=g.inArray("player_loop",a)?ja?e.find(".player_loop").find("img").attr("src",Yb):e.find(".player_loop").find("img").attr("src",yb):-1!=g.inArray("player_shuffle",a)&&(ka?e.find(".player_shuffle").find("img").attr("src",Zb):e.find(".player_shuffle").find("img").attr("src",zb)),!1}function te(a){if(m)return a||(a=window.event),a.cancelBubble?a.cancelBubble= !0:a.stopPropagation&&a.stopPropagation(),a=g(a.currentTarget).attr("class").split(" "),-1!=g.inArray("controls_prev",a)?e.find(".controls_prev").find("img").attr("src",ue):-1!=g.inArray("controls_toggle",a)?B?Ma("off"):sa("off"):-1!=g.inArray("controls_next",a)?e.find(".controls_next").find("img").attr("src",ve):-1!=g.inArray("player_volume",a)?0<z?e.find(".player_volume").find("img").attr("src",bd):e.find(".player_volume").find("img").attr("src",cd):-1!=g.inArray("player_download",a)?e.find(".player_download").find("img").attr("src", we):-1!=g.inArray("player_loop",a)?ja?e.find(".player_loop").find("img").attr("src",yb):e.find(".player_loop").find("img").attr("src",Yb):-1!=g.inArray("player_shuffle",a)&&(ka?e.find(".player_shuffle").find("img").attr("src",zb):e.find(".player_shuffle").find("img").attr("src",Zb)),!1}function ya(){if(!da&&-1!=p.getCounter()){var a=g(Ca[p.getCounter()]);if(a&&a.hasClass("playlistSelected")){var b=a.attr("data-id");a.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!==typeof playlistItemEnabled&& playlistItemEnabled(I,J,a,b)}}}function qd(){if(!da){var a=g(Ca[p.getCounter()]);if(a&&a.hasClass("playlistNonSelected")){var b=a.attr("data-id");a.removeClass("playlistNonSelected").addClass("playlistSelected");"undefined"!==typeof playlistItemDisabled&&playlistItemDisabled(I,J,a,b)}}}function Dc(){var a=h.activeItem;isNaN(a)||-1==a?X=!0:(0>a?a=0:a>C-1&&(a=C-1),p.setCounter(a,!1))}function rd(){t&&-1!=p.getCounter()&&(Ab(),sd(),ya())}function Bb(){Ab();sd();var a=0,b;for(a;a<C;a++)b=g(Ca[a]).unbind("click", nd),td&&!isMobile&&b.unbind("mouseenter").unbind("mouseleave");t&&(t.children().each(function(){var a=g(this);a.data("hap_wrap_player")&&a.data("hap_wrap_player").destroyPlaylist()}),t.empty(),t=null);xa.empty();da=Cb=!1;$b=F=l=null;Za=$a=Db=!1;ab=null;p.reSetCounter();y=[];Ca=[];N=[];R&&R.reinitialise()}function Ab(){ac&&(Q?v&&v.stop():"undefined"!==typeof k(A)&&k(A).pb_dispose(),ac=!1);M?(Y&&clearInterval(Y),n&&(n.pause(),n.src=""),Eb&&Eb.unbind("ended pause play canplay canplaythrough loadedmetadata")): "undefined"!==typeof k(s)&&k(s).pb_dispose();Ec();$b?bc.css("display","block"):bc.css("display","none");pb=null;Fc=O=B=Ub=!1}function ud(a){if("undefined"===typeof a)return q&&alert("setPlaylist method requires data parameter. loadPlaylist failed."),!1;if("undefined"===typeof a.hidden)return q&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var b=xe(a.hidden);if("undefined"===typeof a.id)return q&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."), !1;a=a.id;u=!0;vd();xa.css("opacity",0);t&&Bb();Cb=!1;da=b;wd&&isIE?(b=g(Ia.find(a).css("display","block").clone().wrap("<p>").parent().html()),g(Ia.find(a).css("display","none"))):(b=Ia.find(a).css("display","block").clone(),Ia.find(a).css("display","none"));b.css("fontSize",0);if(0==b.length)return q&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'),Gc(),!1;if(da)bb.empty(),b.appendTo(bb),la=0,Za=$a=Na=!0,t=xd;else{if(!R&&0==xa.length)return q&& alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),!1;b.appendTo(xa);t=b}y=[];Ca=[];N=[];w=[];b.find("li[class*='playlistItem']").each(function(){w.push(g(this))});E()}function E(){w.length?ye():ze()}function ye(){cc=L=K=F=U=null;Hc=!1;var a=w[0],b=a.attr("data-type").toLowerCase(),c=a.attr("data-path"),d=a.hasClass(yd);r=[];a.hasClass(zd)&&(Hc=!0);void 0==a.attr("data-plink")|| D(a.attr("data-plink"))||(U=a.attr("data-plink"));void 0!=a.attr("data-dlink")&&("youtube_single"==b||"youtube_playlist"==b?D(a.attr("data-dlink"))||(F=a.attr("data-dlink")):F=D(a.attr("data-dlink"))?!0:a.attr("data-dlink"));void 0!=a.attr("data-download")&&("youtube_single"==b||"youtube_playlist"==b?D(a.attr("data-download"))||(K=a.attr("data-download")):K=D(a.attr("data-download"))?!0:a.attr("data-download"));void 0==a.attr("data-thumb")||D(a.attr("data-thumb"))||(L=a.attr("data-thumb"));D(g.trim(a.html()))|| (cc=a.html());if(d)l=a,w.shift(),E();else if("local"==b)l=a,w.shift(),E();else if("soundcloud"==b)l=a.data("toremove","true"),Fb=0,dc(c);else if("podcast"==b)l=a.data("toremove","true"),d="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+Ae+"&callback=?&q="+encodeURIComponent(c),g.ajax({type:"GET",url:d,dataType:"jsonp",cache:!1}).done(function(a){if(null==a.responseData)q&&alert("Playlist process failed, podcast: "+c),l&&"true"==l.data("toremove")&&l.remove(),w.shift(),E(); else{if(ieBelow9){a=Be(a.responseData.xmlString);var b;g(a).find("item").each(function(){b=g(this);h={type:"podcast"};h.mp3=b.find("enclosure").attr("url");h.ogg="";h.title=b.find("title").text();0<b.find("media\\:thumbnail").length?b.find("media\\:thumbnail").attr("url")?h.thumb=b.find("media\\:thumbnail").attr("url"):L&&(h.thumb=L):L&&(h.thumb=L);U&&(h.url=U);F&&(h.dlink=F);K&&(h.download=K);r.push(h)})}else{Ad.html(a.responseData.xmlString);a=Ad.get(0).getElementsByTagName("item");var d=0,f=a.length, e,k,h;for(d;d<f;d++)e=a[d],h={type:"podcast"},h.mp3=e.getElementsByTagName("enclosure")[0].getAttribute("url"),h.ogg="",void 0!=e.getElementsByTagName("itunes:duration")[0]&&(k=Ce(e.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue),h.length=parseInt(1E3*k,10)),void 0!=e.getElementsByTagName("media:thumbnail")[0]?void 0!=e.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?h.thumb=e.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):L&&(h.thumb=L):L&&(h.thumb= L),h.title=e.getElementsByTagName("title")[0].childNodes[0].nodeValue,U&&(h.url=U),F&&(h.dlink=F),K&&(h.download=K),r.push(h)}ta()}}).fail(function(a,b,d){q&&alert("Parse feed error: "+a.responseText);q&&alert("Playlist process failed, podcast: "+c);l&&"true"==l.data("toremove")&&l.remove();w.shift();E()});else if("folder"==b){l=a.data("toremove","true");var d=hap_source_path+"folder_parser.php",f=!0;void 0!=a.attr("data-subdirs")&&"false"==a.attr("data-subdirs")&&(f=!1);f={dir:c,subdirs:f};g.ajax({type:"GET", url:d,data:f,dataType:"json"}).done(function(a){De(a,"title");var b=0,c=a.length,d,f;Bd&&(Ja=r.length?r.length-1:0);for(b;b<c;b++)if(d=a[b],f=d.path,f=f.replace(/\\'/g,"'"),f=f.replace(/\\"/g,'"'),f=f.replace(/\\0/g,"\x00"),path=f=f.replace(/\\\\/g,"\\"),f={type:"folder"},/.mp3/.test(path)){f.mp3=path;f.ogg=path.substr(0,path.lastIndexOf("."))+".ogg";var g=path.substr(0,path.lastIndexOf("."));title=/\//i.test(g)?g.substr(g.lastIndexOf("/")+1):g;title=title.split("_").join(" ");f.title=title;f.thumb= path.substr(0,path.lastIndexOf("."))+".jpg";f.size=parseInt(d.size,10);f.lastmod=parseInt(d.lastmod,10);U&&(f.url=U);F&&(f.dlink=F);K&&(f.download=K);L&&(f.thumb=L);r.push(f)}r.length&&Bd?Cd():ta()}).fail(function(a,b,d){q&&alert("Read folder error! Make sure you run this online or on local server!");q&&alert("Playlist process failed, folder: "+c);l&&"true"==l.data("toremove")&&l.remove();w.shift();E()})}else if("xml"==b){l=a;var d=hap_source_path+c,e,k=[];g.ajax({type:"GET",url:d,dataType:"html", cache:!1}).done(function(b){w.shift();g(b).find("li[class='playlistItem']").each(function(){e=Ic(g(this));l?l.after(g(e)):0<t.children().size()?g(e).prependTo(t):g(e).appendTo(t);l=g(e);k.push(g(e))});b=0;var c=k.length;k.reverse();for(b;b<c;b++)w.unshift(k[b]);k=null;a.remove();E()}).fail(function(a,b,d){q&&alert("Playlist process failed, xml: "+c);l&&l.remove();w.shift();E()})}else if("database_data"==b||"database_html"==b)if(void 0==a.attr("data-table")||D(a.attr("data-table")))q&&(alert("Database table missing!"), alert("Playlist process failed, database query: "+c)),w.shift(),E();else{var h=f=null,m=null;void 0==a.attr("data-limit")||D(a.attr("data-limit"))||(f=parseInt(a.attr("data-limit"),10));void 0==a.attr("data-range")||D(a.attr("data-range"))||(d=a.attr("data-range").split(","),2==d.length&&(h=d[0],m=d[1]));l=a;d=hap_source_path+"includes/database.php";k=[];f={db_name:c,db_table:a.attr("data-table"),db_type:b,limit:f,range_from:h,range_to:m};g.ajax({type:"POST",url:d,data:f}).done(function(d){if(-1< d.indexOf("Database information missing!")||-1<d.indexOf("Db connection failed")||-1<d.indexOf("Db selection failed")||-1<d.indexOf("Db query failed"))q&&(alert(d),alert("Playlist process failed, database query: "+c)),l&&l.remove(),w.shift();else{w.shift();d=g.parseJSON(d);var f=0,h=d.length,m;for(f;f<h;f++){m=d[f];if("database_data"==b)if(m.type&&m.mp3||m.path)e=Dd(m);else continue;else if(m.path)e=Ic(m.path);else continue;l?l.after(g(e)):0<t.children().size()?g(e).prependTo(t):g(e).appendTo(t); l=g(e);k.push(g(e))}f=0;h=k.length;k.reverse();for(f;f<h;f++)w.unshift(k[f]);k=null;a.remove()}E()}).fail(function(a,b,d){q&&alert("Playlist process failed, database query: "+c);l&&l.remove();w.shift();E()})}else"youtube_single"==b?(Ed=c,youtube_path="http://gdata.youtube.com/feeds/api/videos/"+c+"?v=2&format=5&alt=jsonc",l=a.data("toremove","true"),Jc(b,youtube_path)):"youtube_playlist"==b?(c.substr(0,2).toUpperCase(),ec=c,cb=1,youtube_path="http://gdata.youtube.com/feeds/api/playlists/"+ec+"?start-index="+ cb+"&max-results=50&v=2&format=5&alt=jsonc",l=a.data("toremove","true"),Jc(b,youtube_path)):"ofm_single"==b?(l=a.data("toremove","true"),Da=[],Da.push({id:c,type:b}),Gb()):"ofm_playlist"==b||"ofm_project"==b?(l=a.data("toremove","true"),Kc=b,fc=c,Da=[],db=1,Fd()):(q&&alert("Invalid playlist data-type attribute!"),w.shift(),E())}function ta(){if(r.length){var a,b,c=0,d=r.length,f,e;for(c;c<d;c++)f=r[c],a=g('<li class="playlistItem" data-type="'+f.type+'"data-mp3="'+f.mp3+'" data-ogg="'+f.ogg+'" data-thumb="'+ f.thumb+'"></li>'),e=f.mp3,/\.(mp3)$/i.test(f.mp3)||(e+=".mp3"),Hc&&a.addClass(zd),f.url&&a.attr("data-plink",f.url),f.dlink&&(!0!=f.dlink&&"true"!=f.dlink?a.attr("data-dlink",f.dlink):a.attr("data-dlink",e)),f.download&&(!0!=f.download&&"true"!=f.download?a.attr("data-download",f.download):a.attr("data-download",e)),f.title&&a.attr("data-title",f.title),f.thumb&&("//"==f.thumb.substr(0,2)&&(f.thumb="http:"+f.thumb),a.attr("data-thumb",f.thumb)),f.length&&a.attr("data-length",f.length),"title"==Ea? b=g('<a class="playlistNonSelected" href="#">"'+f.title+'"</a>').appendTo(a):"thumb"==Ea?b=g('<a class="playlistNonSelected" href="#"><img src="'+f.thumb+'" alt="thumb"/></a>').appendTo(a):"all"==Ea&&(b=g('<a class="playlistNonSelected" href="#"></a>').appendTo(a),g('<span class="hap_thumb"><img src="'+f.thumb+'" alt="thumb"/></span>').appendTo(b),g('<span class="hap_title"><p>'+f.title+"</p></span>").appendTo(b)),cc&&b.after(cc),l?(l.after(a),"true"==l.data("toremove")&&l.remove()):a.appendTo(t), l=a}w.shift();E()}function ze(){if(Db||$a){var a=0;l=null;var b;bb.find("li[class*='playlistItem']").each(function(){b=g(this);l?l.after(b):Na?b.appendTo(t):t.children().eq(la).before(b);l=b;a++});bb.empty()}gc();xa.css("opacity",1);m||Gd();l=null;u=!1;Gc();if(0<C){if(Db||$a){var c=p.getCounter();p.setPlaylistItems(C,!1);la<=c&&(Na||p.reSetCounter(c+a));Za&&(Za=!1,Dc())}else p.setPlaylistItems(C),Dc();Oa&&Fa()}$a=Db=!1;0==C&&"undefined"!==typeof playlistEmpty&&playlistEmpty(I,J);"undefined"!==typeof audioPlayerPlaylistLoaded&& audioPlayerPlaylistLoaded(I,J);Cb=!0}function gc(){y=[];N=[];Ca=[];if(0==t.length)return q&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),!1;var a=0,b,c,d=t.find("li"),f=d.length,e,h,k,l,n,r,s,v,w,x;Hb=0;for(a;a<f;a++)c=g(d[a]).addClass(yd),N.push(c),Lc&&c.addClass(wb),Hb="horizontal"==tb?Hb+c.outerWidth(!0):Hb+c.outerHeight(!0),b=c.find("a[class=playlistNonSelected]"),0== b.length&&(b=c.find("a[class=playlistSelected]")),b.unbind().bind("click",nd).attr("data-id",a),Ca.push(b),td&&!isMobile&&b.bind("mouseenter",function(a){if(!m||u)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("data-id");var b=g(Ca[a]),c=!1;p.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollover&&playlistItemRollover(I,J,b,a,c);return!1}).bind("mouseleave",function(a){if(!m||u)return!1;a||(a=window.event); a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=g(a.currentTarget).attr("data-id");var b=g(Ca[a]),c=!1;p.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollout&&playlistItemRollout(I,J,b,a,c);return!1}),e="",void 0!=c.attr("data-title")?e=c.attr("data-title"):"title"==Ea?e=b.html():"thumb"!=Ea&&"all"==Ea&&(e=b.find("span[class=hap_title]").find("p").html()),Mc&&(h=Nc(a)+Oc+e,b.html(h)),c=g(N[a]).attr({"data-id":a,"data-title":e}),k=h=r=n="",l=void 0,x=w=v=s=null, void 0!=c.attr("data-mp3")&&(n=c.attr("data-mp3")),void 0!=c.attr("data-ogg")&&(r=c.attr("data-ogg")),void 0!=c.attr("data-type")&&(h=c.attr("data-type")),void 0!=c.attr("data-origtype")&&(k=c.attr("data-origtype")),void 0==c.attr("data-length")||D(c.attr("data-length"))||(l=c.attr("data-length")),"youtube_single"==h||"youtube_playlist"==h?(void 0==c.attr("data-download")||D(c.attr("data-download"))||(s=c.attr("data-download")),void 0==c.attr("data-dlink")||D(c.attr("data-dlink"))||(v=c.attr("data-dlink"))): (void 0!=c.attr("data-download")&&(s=D(c.attr("data-download"))||"true"==c.attr("data-download")?n:c.attr("data-download")),void 0!=c.attr("data-dlink")&&(v=D(c.attr("data-dlink"))||"true"==c.attr("data-dlink")?n:c.attr("data-dlink"))),void 0==c.attr("data-plink")||D(c.attr("data-plink"))||(w=c.attr("data-plink")),void 0==c.attr("data-thumb")||D(c.attr("data-thumb"))||(x=c.attr("data-thumb")),da||(w&&0==c.find("a[class=plink]").length&&(w=g('<a class="plink" href="'+w+'" target="_blank"><img src="'+ Hd+'" alt="purchase"/></a>'),b.after(w)),v&&0==c.find("a[class=dlink]").length&&(v=g('<a class="dlink" href="#" data-dlink="'+v+'"><img src="'+Id+'" alt="download"/></a>'),b.after(v),D(c.attr("data-dlink"))),Jd&&0==c.find("a[class=premove]").length&&(c=g('<a class="premove" href="#"><img src="'+Ee+'" alt="remove"/></a>'),b.after(c))),y.push({id:a,type:h,origtype:k,title:e,mp3:n,ogg:r,length:l,download:s,thumb:x});d=null;C=y.length;da||(Fe(),Ge&&(t.hasClass("ui-sortable")||t.sortable({cursor:"move", update:function(a,b){gc();0<C&&p.setPlaylistItems(C);var c=xa.find("a[class=playlistSelected]").attr("data-id");c&&(p.reSetCounter(c),Oa&&Fa());1==C&&Dc()},receive:function(a,b){"undefined"!==typeof dropReceive&&dropReceive(I,J)}})),Kd&&("horizontal"==tb&&xa.width(Hb),Bc(!0)));return!0}function Gd(){m=!0;u=!1;Gc();Ld();"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(I,J);He()}function Fe(){var a=ra?Pa:"click";e.find("a[class=dlink]").unbind().bind(a,function(a){a.preventDefault(); if(Ba)return!1;var c=g(this);a=c.closest(".playlistItem");var d=a.attr("data-id");if(a.hasClass(wb))return!1;if(void 0==a.attr("data-type")||D(a.attr("data-type")))return q&&alert("Invalid data-type for file download function! Quitting."),Ba=!1;a=a.attr("data-type");void 0==c.attr("data-dlink")||D(c.attr("data-dlink"))||(c=c.attr("data-dlink"),d=Cc(d,!1),a=od(a,d,c),pd(a.name,a.path))});e.find("a[class=plink]").unbind().bind("click",function(a){if(g(this).closest(".playlistItem").hasClass(wb))return!1}); Jd&&e.find("a[class=premove]").unbind().bind("click",function(a){a.preventDefault();a=g(this).closest(".playlistItem");var c=parseInt(a.attr("data-id"),10);if(a.hasClass(wb))return!1;I.removeTrack(c)})}function od(a,b,c){"local"==a||"folder"==a?(c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),c.match(/^http([s]?):\/\/.*/)||(a=window.location.href,a=a.substr(0,a.lastIndexOf("/")+1),/^\.\.\//i.test(c)&&(c=c.substr(3),"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.lastIndexOf("/"))),a=a.substr(0,a.lastIndexOf("/")+ 1)),c=a+c),hc||(b=0<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):c)):"soundcloud"==a&&(c=c.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));b=b.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(b)||(b+=".mp3");return{name:b,path:c}}function pd(a,b){if(hc)if(Ba=!0,Ie)Md||(Pc=Nd())&&(Md=!0),Pc?Od(Pc,a,b):Ba=!1;else{var c=Nd();c?Od(c,a,b):Ba=!1}else Je.attr("src","dl.php?path="+b+"&name="+a)}function Od(a,b,c){g.ajax({type:"POST",url:"mail.php",data:"mail="+a+"&name="+b+"&path="+c}).done(function(a){Ba= !1}).fail(function(a,b,c){q&&alert("Send email error: "+a.responseText);Pd();Ba=!1});ic.css({marginTop:-ic.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Ib&&clearTimeout(Ib);Ib=setTimeout(Pd,Ke)}function Pd(){Ib&&clearTimeout(Ib);ic.stop().animate({opacity:0},{duration:500,complete:function(){ic.css("display","none")}})}function Nd(){for(var a=prompt("Please enter your email address where download link will be sent:"),b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!b.test(a)|| D(a))&&null!=a;)a=prompt("Please enter a valid email address:");return a}function He(){g(".hap_text_link").each(function(){var a=g(this),b=a.attr("href");"undefined"!==typeof b&&!1!==b&&-1<b.toLowerCase().indexOf(".mp3")&&a.prepend('<img class="play_link" src="'+jc+'"/>')});g(".hap_text_link, .hap_image_link").click(function(a){if(!m)return!1;a=g(this);var b=a.attr("href");if("undefined"===typeof b||!1===b)return!1;if(kc&&kc==b)return nb();ya();p.reSetCounter();kc=b;Qd=a;ma&&ma.attr("src",jc);a.hasClass("hap_text_link")&& (ma=a.find("img").attr("src",Rd));Z=kc;Qa=Z.substr(0,Z.lastIndexOf("."))+".ogg";X=!0;M||"undefined"!==typeof k(s)&&k(s).pb_setAutoplay(!0);Ab();Qc();return!1})}function Gb(){Da.length?Le(Da.shift()):(0==r.length&&l&&"true"==l.data("toremove")&&l.remove(),r.length>Jb&&(r=r.slice(0,Jb)),ta())}function Le(a){var b=a.id,c=a.type;g.ajax({url:"http://api.official.fm/tracks/"+b+"?fields=streaming,cover&api_version=2",dataType:"json",cache:!1}).done(function(a){var b={},e,g;a.track&&a.track.streaming&&a.track.streaming.http&& (a=a.track,b.type=c,b.length=a.duration?a.duration:null,b.mp3=a.streaming.http,b.ogg=a.streaming.http,e=a.artist?a.artist:"Official Fm artist",g=a.title?a.title:"Official Fm track",b.title=e+" - "+g,U&&(b.url=U),F&&(b.dlink=F),K&&(b.download=K),a.cover.urls.small?b.thumb=a.cover.urls.small:L&&(b.thumb=L),r.push(b));Gb()}).fail(function(a,c,e){q&&alert("Playlist process failed, ofm: "+b);Gb()})}function Sd(){1<Rc?(db+=1,db<=Rc&&Da.length<Jb?Fd():Da.length?Gb():(w.shift(),E())):Da.length?Gb():(0==r.length&& l&&"true"==l.data("toremove")&&l.remove(),w.shift(),E())}function Fd(){g.ajax({url:"ofm_playlist"==Kc?"http://api.official.fm/playlists/"+fc+"/tracks?api_version=2&page="+db+"":"http://api.official.fm/projects/"+fc+"/tracks?fields=cover&api_version=2&page="+db+"",dataType:"json",cache:!1}).done(function(a){Rc=a.total_pages;if(a.tracks&&a.tracks.length){var b=0,c=a.tracks.length,d;c>Jb&&(c=Jb);for(b;b<c;b++)d=a.tracks[b].track,d.url&&(d=d.url.substr(d.url.lastIndexOf("/")+1),d=d.substr(0,d.indexOf("?")), Da.push({id:d,type:Kc}))}Sd()}).fail(function(a,b,c){q&&alert("Playlist process failed, ofm: "+fc);Sd()})}function Jc(a,b){g.ajax({url:b,dataType:"jsonp",success:function(b){if("youtube_single"==a){var d={};(b=b.data)?b.accessControl?(d.type="youtube_single",d.mp3=b.id,d.ogg="",d.title=b.title?b.title:"",d.description=b.description?b.description:"",b.thumbnail?d.thumb=b.thumbnail.hqDefault?b.thumbnail.hqDefault:b.thumbnail.sqDefault:L&&(d.thumb=L),U&&(d.url=U),F&&(d.dlink=F),K&&(d.download=K),r.push(d), ta()):(w.shift(),E()):(q&&alert("Playlist process failed, youtube single: "+Ed),l&&"true"==l.data("toremove")&&l.remove(),w.shift(),E())}else if(b.error)q&&alert("Playlist process failed, youtube playlist: "+ec),l&&"true"==l.data("toremove")&&l.remove(),w.shift(),E();else if(b.data.items){var d=b.data.items.length,f=0,e;for(f;f<d;f++)d>Ra&&(d=Ra),(e=b.data.items[f].video)&&e.accessControl&&(obj={type:"youtube_playlist"},obj.mp3=e.id,obj.ogg="",obj.title=e.title?e.title:"",obj.description=e.description? e.description:"",e.thumbnail?obj.thumb=e.thumbnail.hqDefault?e.thumbnail.hqDefault:e.thumbnail.sqDefault:L&&(obj.thumb=L),U&&(obj.url=U),F&&(obj.dlink=F),K&&(obj.download=K),r.push(obj));cb<=Ra?(cb+=Me,b="http://gdata.youtube.com/feeds/api/playlists/"+ec+"?start-index="+cb+"&max-results=50&v=2&format=5&alt=jsonc",Jc("youtube_playlist",b)):(r.length>Ra&&(r=r.slice(0,Ra)),ta())}else r.length>Ra&&(r=r.slice(0,Ra)),ta()},error:function(a){q&&alert("Playlist process failed, youtube: "+b);l&&"true"==l.data("toremove")&& l.remove();w.shift();E()}})}function Ne(){Td?isMobile?vb?v.initVideo(Z):(m=!1,Sc=!0,Xb("on")):v.initVideo(Z):(Kb=0==e.find("div[class='youtubeIframeMain']").length?g("<div/>").css({display:"block",left:"-10000px"}).addClass("youtubeIframeMain").appendTo(e):e.find("div[class='youtubeIframeMain']"),v=g.youtubePlayer({parent:I,autoPlay:Ud,defaultVolume:z,mediaPath:Z,youtubeHolder:Kb,youtubeChromeless:Oe,isMobile:isMobile,initialAutoplay:Pe,quality:Qe}),g(v).bind("ap_YoutubePlayer.YT_READY",function(){Tc|| Kb.css("left","-10000px");Aa=!0}),g(v).bind("ap_YoutubePlayer.START_PLAY",function(){Y&&clearInterval(Y);Y=setInterval(Re,Uc);Sc&&(v.stop(),v.initVideo(Z),Sc=!1);!vb&&isMobile&&(Xb("off"),m=vb=!0)}),g(v).bind("ap_YoutubePlayer.END_PLAY",function(){lc()}),g(v).bind("ap_YoutubePlayer.STATE_PLAYING",function(){mc()}),g(v).bind("ap_YoutubePlayer.STATE_PAUSED",function(){isMobile?"iPhone"==eb||"iPod"==eb?B&&(B=!1,sa("off")):nc():nc()}),Td=!0);O=ac=!0}function Xb(a){"on"==a?(Tc=!0,Kb.css({top:"0px",left:"0px"})): (Kb.css("left","-10000px"),Tc=null)}function Se(){var a=A.substr(1);embedFlashMain(a);a=s.substr(1);embedFlashAudio(a);"undefined"!==typeof k(A)?na=setInterval(Te,oc):(q&&alert("Problems with flash initialization (startFlashInit)! Flash for youtube not initialized! Sound_id: "+J),Vd())}function Te(){void 0!=k(A).setData&&(na&&clearInterval(na),k(A).setData(h),e.find(".flashMain").css("left","-10000px"),Vd())}function Vd(){"undefined"!==typeof k(s)?na=setInterval(Ue,oc):(q&&alert("Problems with flash initialization (checkFlashSound)! Flash audio backup not initialized! Sound_id: "+ J),Wd())}function Ve(){var a=s.substr(1);embedFlashAudio(a);var b=setTimeout(function(){b&&clearTimeout(b);"undefined"!==typeof k(s)?na=setInterval(We,oc):(q&&alert("Problems with flash initialization (checkFlashSound_b)! Flash audio backup not initialized! Sound_id: "+J),fb())},500)}function Ue(){void 0!=k(s).setData&&(na&&clearInterval(na),k(s).setData(h),e.find(".flashAudio").css("left","-10000px"),Wd())}function We(){void 0!=k(s).setData&&(na&&clearInterval(na),k(s).setData(h),e.find(".flashAudio").css("left", "-10000px"),fb())}function Wd(){if(T){var a=S.substr(1);embedFlashCircle(a);"undefined"!==typeof k(S)?na=setInterval(Xe,oc):(q&&alert("Problems with flash initialization (checkFlashCircle)! Flash circle backup (canvas support is false) not initialized! Sound_id: "+J),fb())}else g(".circleMain").remove(),fb()}function Xe(){void 0!=k(S).setData&&(na&&clearInterval(na),k(S).setData(gb),fb())}function k(a){"#"==a.charAt(0)&&(a=a.substr(1));return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]} function dc(a){if(D(Vc))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),w.shift(),E(),!1;/\/likes$/.test(a)&&(a=a.replace(/\/likes$/,"/favorites"));var b=Ye(a,Vc);g.ajax({url:b,dataType:"jsonp",cache:!1}).done(function(b){var d,f;if(b.tracks){d=b.tracks.length;d>ea&&(d=ea);for(f=0;f<d;f++)b.tracks[f].streamable&&b.tracks[f].stream_url?r.push(Wc(b.tracks[f])):(d+=1,d>b.tracks.length&&(d=b.tracks.length));r.length>ea&&(r=r.slice(0,ea));ta()}else if(b.duration)b.permalink_url= a,b.streamable&&b.stream_url&&r.push(Wc(b)),r.length>ea&&(r=r.slice(0,ea)),ta();else if(b.username)Lb=/likes/.test(a)?b.uri+"/likes":/favorites/.test(a)?b.uri+"/favorites":b.uri+"/tracks",dc(Lb);else if(g.isArray(b)){d=b.length;d>ea&&(d=ea);for(f=0;f<d;f++)b[f].streamable&&b[f].stream_url?r.push(Wc(b[f])):(d+=1,d>b.length&&(d=b.length));d==Xd?(Fb+=Xd,Fb<ea?dc(Lb):(r.length>ea&&(r=r.slice(0,ea)),ta())):(r.length>ea&&(r=r.slice(0,ea)),ta())}else b.kind&&"group"==b.kind?(Lb=b.uri+"/tracks",dc(Lb)):(w.shift(), E())}).fail(function(b,d,f){q&&alert("Playlist process failed, soundcloud: "+a);w.shift();E()})}function Wc(a){var b={type:"soundcloud"};a.duration&&(b.length=a.duration);b.mp3=a.stream_url+(/\?/.test(a.stream_url)?"&":"?")+"consumer_key="+Vc;b.ogg="";b.title=a.title;U&&(b.url=U);a.downloadable&&a.download_url?(F&&(b.dlink=F),K&&(b.download=K)):(F&&!0!=F&&"true"!=F&&(b.dlink=F),K&&!0!=K&&"true"!=K&&(b.download=K));a.artwork_url?b.thumb=a.artwork_url:L&&(b.thumb=L);return b}function Ye(a,b){return(/api\./.test(a)? a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&offset="+Fb+"&consumer_key="+b+"&callback=?"}function Cd(){var a=r[Ja].mp3;ID3.loadTags(a,function(){var b=ID3.getAllTags(a);b.title&&(r[Ja].title=b.title);b.artist&&(r[Ja].artist=b.artist);b.album&&(r[Ja].album=b.album);if(b=b.picture){var c="",d=0,f=b.data.length;for(d;d<f;d++)c+=String.fromCharCode(b.data[d]);r[Ja].thumb="data:"+b.format+";base64,"+_win.btoa(c)}Ja++;Ja<r.length?Cd():ta()},{tags:["title","artist","album","picture"]})} function Re(){if(Q){var a=v.getCurrentTime(),b=v.getDuration();oa=v.getVideoBytesLoaded()/v.getVideoBytesTotal();isNaN(a)||isNaN(b)?Ub=!0:(Ub=!1,pa.html(qb(a)+Sa),qa.html(rb(b)),T)?ha&&(isNaN(oa)||Ac(oa),ca=a/b,!V&&B&&(tc||La(a/b))):(isNaN(oa)||ua.width(oa*G),V||ga.width(a/b*G))}}function Yd(){var a=n.currentTime,b=n.duration;void 0==n.buffered||0==n.buffered.length||isNaN(b)||(oa=n.buffered.end(0)/b);isNaN(a)||isNaN(b)||(pa&&pa.html(qb(a)+Sa),qa&&qa.html(rb(b)));if(T)ha&&(isNaN(oa)||Ac(oa),isNaN(a)|| isNaN(b)||(ca=a/b,!V&&B&&La(a/b)));else{if(!isNaN(oa)){var c=oa*G;c>G&&(c=G);ua&&ua.width(c)}isNaN(a)||isNaN(b)||!V&&ga&&ga.width(a/b*G)}}function lc(){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(I,J,p.getCounter());ya();p.advanceHandler(1,!0)}function mc(){Fc||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(I,J,p.getCounter()),Fc=!0);"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(I,J,p.getCounter());T&&ha&&ob()}function nc(){"undefined"!==typeof audioPlayerSoundPause&& audioPlayerSoundPause(I,J,p.getCounter())}function Qc(){if("youtube_single"==x||"youtube_playlist"==x)Q?(Ne(),isMobile&&!vb&&X&&(m=!1,Xb("on"))):("undefined"!==typeof k(A)&&(k(A).pb_play(Z,0,100,100,"youtube",X),O=!0),ac=Aa=!0);else if(M){if(Zd)Ta?n.src=Z:Mb&&(n.src=Qa),n.load(),n.play();else{var a="",a=Ze?a+'<audio class="hap_audio_cont" preload="auto">':a+'<audio class="hap_audio_cont" preload="none">',a=a+('<source src="'+Z+'" type="audio/mpeg" />'),a=a+('<source src="'+Qa+'" type="audio/ogg" />'); $d.html(a+"</audio>");Eb=$d.find(".hap_audio_cont");n=Eb[0];n.volume=z;X&&(n.load(),n.play());Zd=!0}Eb.bind("ended",function(a){lc()}).bind("pause",function(a){nc()}).bind("play",function(a){Y&&clearInterval(Y);Y=setInterval(Yd,Uc);mc()}).bind("canplay",function(a){pb&&(n.seekable&&0<n.seekable.length&&(n.currentTime=pb*n.duration),pb=null)}).bind("canplaythrough",function(a){}).bind("loadedmetadata",function(a){}).bind("error",function(a){}).bind("abort",function(a){}).bind("stalled",function(a){}).bind("suspend", function(a){});Y&&clearInterval(Y);Y=setInterval(Yd,Uc)}else"undefined"!==typeof k(s)&&k(s).pb_initAudio(Z);X?(B=!0,Ma("off")):(B=!1,sa("off"));Ya();"youtube_single"!=x&&"youtube_playlist"!=x&&(O=!0);X=!0;!isMobile&&v&&v.setAutoPlay(!0)}function fb(){var a=[e.find(".controls_next"),e.find(".controls_prev"),e.find(".controls_toggle"),e.find(".player_volume"),e.find(".player_download"),e.find(".player_loop"),e.find(".player_shuffle")],b,c=a.length,d=0;for(d;d<c;d++)b=g(a[d]).css("cursor","pointer").bind(Pa, me),$e&&!isMobile&&b.bind("mouseover",ne).bind("mouseout",te);ab?ud(ab):m||Gd()}function Ld(){if(!T&&(G=uc.width(),!isNaN(oa)&&ua&&ua.width(oa*G),!V&&ga)){var a,b;if("youtube_single"!=x&&"youtube_playlist"!=x){if(M)n&&(a=n.currentTime,b=n.duration);else if("undefined"!==typeof k(s))try{a=k(s).pb_getFlashPosition,b=k(s).pb_getFlashDuration()}catch(c){}try{a&&!isNaN(a)&&b&&!isNaN(b)&&ga.width(a/b*G)}catch(d){}}}Kd&&!da&&Bc();hb&&fa&&fa.checkSize()}function Gc(){ae.css("display","none")}function vd(){ae.css("display", "block")}function sd(){Y&&clearInterval(Y);hb&&fa&&fa.deactivate();Va.html(Nb);pa.html(Xc+Sa);qa.html(Yc);T?ha&&(ca=0,H.clearRect(0,0,$,ba),Ha.clearRect(0,0,$,ba)):(ga.width(0),ua.width(0));sa("off");bc.css("display","none")}function Ec(){Y&&clearInterval(Y);Oa||(hb&&fa&&fa.deactivate(),Va.html(Nb));pa.html(Xc+Sa);qa.html(Yc);T?ha&&(ca=0,H.clearRect(0,0,$,ba),Ha.clearRect(0,0,$,ba)):(ga.width(0),ua.width(0));sa("off");bc.css("display","none")}function sa(a){"on"==a?e.find(".controls_toggle").find("img").attr("src", af):e.find(".controls_toggle").find("img").attr("src",bf);ma&&ma.hasClass("play_link")&&ma.attr("src",jc);T&&(ha?(H.clearRect(0,0,$,ba),La(ca),ob()):"undefined"!==typeof k(S)&&k(S).pb_toggle_icon("play"))}function Ma(a){"on"==a?e.find(".controls_toggle").find("img").attr("src",cf):e.find(".controls_toggle").find("img").attr("src",df);ma&&ma.hasClass("play_link")&&Qd.hasClass("hap_text_link")&&ma.attr("src",Rd);T&&(ha?(H.clearRect(0,0,$,ba),La(ca),ob()):"undefined"!==typeof k(S)&&k(S).pb_toggle_icon("pause"))} function qb(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function rb(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function Fa(a){if("string"===typeof a){if(Mc&&p&&-1!=p.getCounter()){var b=p.getCounter();a=Nc(y[b].id)+Oc+a}}else{if("number"===typeof a){if(!p||0>a||a>C-1)return!1}else if(!p)return!1;b=p.getCounter(); a=Cc(b)}hb&&fa?(fa.input(a),fa.activate()):Va&&Va.html(a)}function Cc(a,b){if("undefined"===typeof b||null===b)b=!0;return y[a]&&y[a].title&&!D(y[a].title)?b?Mc?Nc(y[a].id)+Oc+y[a].title:y[a].title:y[a].title:Nb}function Nc(a){return 9>a?"0"+(a+1):a+1}function ef(a){var b=[],c=[],d=0;for(d;d<a;d++)b[d]=d;var d=0,f;for(d;d<a;d++)f=Math.round(Math.random()*(b.length-1)),c[d]=b[f],b.splice(f,1);return c}function ff(a){var b=[],c=0;for(c;c<a;c++)b[c]=c;return b}function De(a,b,c){"title"==b?a.sort(function(a, b){return a.title==b.title?0:a.title<b.title?-1:1}):"type"==b&&a.sort(function(a,b){return a.type==b.type?0:a.type<b.type?-1:1});c&&a.reverse()}function D(a){return a?0==a.replace(/^\s+|\s+$/g,"").length:!0}function Ce(a){a=a.split(":");for(var b=0,c=1;0<a.length;)b+=c*parseInt(a.pop()),c*=60;return b}function Be(a){if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b}if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");throw Error("No XML parser available"); }function gf(a,b){return b-a}function xe(a){if("string"===typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;default:return Boolean(a)}else if("boolean"===typeof a)return Boolean(a)}function hf(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function Dd(a){var b,c="",d,f="",e="",h="",k,m,n,l;b=a.type.toLowerCase();a.origtype&&(c=a.origtype.toLowerCase());a.mp3?d=a.mp3:a.path&&(d=a.path); a.ogg&&(f=a.ogg);a.title&&(e=a.title);a.thumb&&(h=a.thumb);a.download&&("youtube_single"==b||"youtube_playlist"==b?!0==a.download||"true"==a.download||D(a.download)||(k=a.download):k=!0==a.download?d:a.download);a.url&&(n=a.url);a.dlink&&("youtube_single"==b||"youtube_playlist"==b?!0==a.dlink||"true"==a.dlink||D(a.dlink)||(m=a.dlink):m=!0==a.dlink?d:a.dlink);"local"==b?"title"==Ea?l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+ h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'>"+e+"</a></li>":"thumb"==Ea?l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'><img src='"+h+"' alt='thumb'/></a></li>":"all"==Ea&&(l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+d+"' data-ogg='"+f+"' data-thumb='"+h+"' data-title='"+e+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+ h+"' alt='thumb'/></span><span class='hap_title'><p>'"+e+"'</p></span></a></li>"):(l="<li class= 'playlistItem' data-type='"+b+"' data-path='"+d+"' data-thumb='"+h+"'></li>","database_data"==b&&(d=a.table?a.table:null,c=a.limit?a.limit:null,a=a.range?a.range:null,d&&(d=' data-table="'+d+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),c&&(d=' data-limit="'+c+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),a&&(d=' data-range="'+a+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+ d+l.slice(f.index))));k&&(d=' data-download="'+k+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index));"local"==b?(m&&(d="<a class='dlink' href='#' data-dlink='"+m+"'><img src='"+Id+"' alt='download'/></a>",f=l.match(/\<\/a\>\<\/li\>/),l=l.slice(0,f.index)+d+l.slice(f.index)),n&&(d="<a class='plink' href='"+n+"' target='_blank'><img src='"+Hd+"' alt='purchase'/></a>",f=l.match(/\<\/a\>\<\/li\>/),l=l.slice(0,f.index)+d+l.slice(f.index))):(m&&(d=' data-dlink="'+m+'" ',f=l.match(/\>/),l=l.slice(0, f.index)+d+l.slice(f.index)),n&&(d=' data-plink="'+n+'" ',f=l.match(/\>/),l=l.slice(0,f.index)+d+l.slice(f.index)));b=document.createElement("ul");b.innerHTML=l;return g(b.firstChild)}function Ic(a){a=g(a);var b;a=g("<div>").append(a.clone()).html();b=document.createElement("ul");b.innerHTML=a;return g(b.firstChild)}function ib(a){C=y.length;if(0<C){gc();var b=p.getCounter();a==b?(rd(),p.setPlaylistItems(C)):(p.setPlaylistItems(C,!1),a<b&&p.reSetCounter(p.getCounter()-1));Oa&&Fa()}else Bb(),ab=null, "undefined"!==typeof playlistEmpty&&playlistEmpty(I,J)}var m=!1,I=this;g("body");var jf=g(window),za=g(document),Zc,hc=!1,jb=navigator.userAgent,eb;if(-1<jb.indexOf("iPhone")||-1<jb.indexOf("iPod")||-1<jb.indexOf("iPad"))hc=!0,-1<jb.indexOf("iPhone")?eb="iPhone":-1<jb.indexOf("iPod")?eb="iPod":-1<jb.indexOf("iPad")&&(eb="iPad");var je=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),Ob=document.createElement("audio"),Ta,Mb,Q=!1;Ob.canPlayType?(Q=!0,Ta=!!Ob.canPlayType&&""!=Ob.canPlayType("audio/mpeg"), Mb=!!Ob.canPlayType&&""!=Ob.canPlayType('audio/ogg; codecs="vorbis"')):(Ta=!0,Mb=!1);var ue=hap_source_path+h.buttonsUrl.prev,oe=hap_source_path+h.buttonsUrl.prevOn,ve=hap_source_path+h.buttonsUrl.next,pe=hap_source_path+h.buttonsUrl.nextOn,bf=hap_source_path+h.buttonsUrl.play,af=hap_source_path+h.buttonsUrl.playOn,df=hap_source_path+h.buttonsUrl.pause,cf=hap_source_path+h.buttonsUrl.pauseOn,Yb=hap_source_path+h.buttonsUrl.loop,yb=hap_source_path+h.buttonsUrl.loopOn,bd=hap_source_path+h.buttonsUrl.volume, qe=hap_source_path+h.buttonsUrl.volumeOn,cd=hap_source_path+h.buttonsUrl.mute,re=hap_source_path+h.buttonsUrl.muteOn,Zb=hap_source_path+h.buttonsUrl.shuffle,zb=hap_source_path+h.buttonsUrl.shuffleOn,we=hap_source_path+h.buttonsUrl.download,se=hap_source_path+h.buttonsUrl.downloadOn,Hd=hap_source_path+h.buttonsUrl.trackUrlIcon,Id=hap_source_path+h.buttonsUrl.trackDownloadIcon,Ee=hap_source_path+h.buttonsUrl.trackRemoveIcon,Rd=hap_source_path+h.buttonsUrl.link_pause,jc=hap_source_path+h.buttonsUrl.link_play, e=g(this),T=e.hasClass("hap_circle"),ha=!1;Q&&hf()&&(ha=!0);var wd="html5audio-popup"==e.attr("id"),ub=e.find(".playlistHolder"),xa=e.find(".playlist_inner").css("opacity",0);e.find(".playerHolder");e.find(".player_mediaTime");var pa=e.find(".player_mediaTime_current"),qa=e.find(".player_mediaTime_total"),ee=e.find(".player_mediaName_Mask"),Va=e.find(".player_mediaName");e.find(".player_controls");var kf=e.find(".player_volume"),ae=e.find(".preloader"),bc=e.find(".player_download");e.find(".componentPlaylist"); var Ia=g(h.playlistList);wd&&window.opener&&(Ia=window.opener.jQuery(h.playlistList));var J=h.sound_id,X=h.autoPlay,Pe=h.autoPlay,Ud=h.autoPlay,Ze=h.autoLoad;isMobile&&(X=!1,Ud=h.autoPlay=!1);var lf=h.useOnlyMp3Format,Vc=h.soundcloudApiKey,ea=h.soundcloud_result_limit,Ae=h.podcast_result_limit,Ra=h.yt_playlist_result_limit,Jb=h.ofm_result_limit,hb=h.useSongNameScroll,Oa=h.autoSetSongTitle,ja=h.loopingOn,ka=h.randomPlay,Sa=h.mediaTimeSeparator,ld=h.seekTooltipSeparator,Nb=h.defaultArtistData,Mc=h.useNumbersInPlaylist, Oc=h.titleSeparator,ab=h.activePlaylist,q=h.useAlertMessaging,Kd=h.activatePlaylistScroll,tb=h.playlistScrollOrientation.toLowerCase(),Ge=h.sortablePlaylistItems,Ie=h.autoReuseMailForDownload,Jd=h.useRemoveBtnInTracks,mf=h.useVolumeTooltip,nf=h.useSeekbarTooltip,Ea=h.playlistItemContent.toLowerCase(),of=h.useKeyboardNavigation,$e=h.useBtnRollovers,td=h.usePlaylistRollovers,Bd=h.getTrackInfoFromID3;pa.html("0:00");qa.html("0:00");var Xc=pa.html(),Yc=qa.html();Va.html(Nb);pa.html(Xc+Sa);qa.html(Yc); var M=!0;if(!Q||!Ta&&lf)M=!1;var Ja,Na,la,Db,$a,Za,da=!1,yd="hap_processed",zd="hap_draggable",Hc,U,Md,Pc,Ba,F,K,$b,L,cc,Qd,ma,kc,Lc=!1;void 0!=ub.attr("data-playlistLocked")&&(Lc=!0);var wb="playlist_locked",Cb=!1,Hb,l,t=null,u=!0,Ub=!1,Fc=!1,Lb,Fb,Xd=50,x,O=!1,Z="",Qa="",B=!1,Uc=250,Y,oa;ja&&e.find(".player_loop").find("img").attr("src",yb);ka&&e.find(".player_shuffle").find("img").attr("src",zb);var y=[],Ca=[],N=[],C=0,R,Ad=0==e.find("div[id='feedParser']").length?g('<div id="feedParser"/>').css({position:"absolute", left:"-10000px",display:"none"}).appendTo(e):e.find("div[id='feedParser']"),Je=0==e.find("iframe[id='dl_iframe']").length?g('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(e):e.find("iframe[id='dl_iframe']"),bb=g("<div/>"),xd=g("<div/>");if(hc)var Ib,Ke=3E3,ic=0==ub.find("div[id='download_confirm']").length?g('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').addClass("download_confirm").css({opacity:0,zIndex:1E3}).appendTo(ub):ub.find("div[id='download_confirm']"); var r=[],w=[],s=h.flashAudio,S=h.circleMain;if(M)var Zd=!1,Eb,n,$d=0==e.find("div[id='hap_audioHolder']").length?g('<div id="hap_audioHolder"/>').css({position:"absolute",left:"-10000px"}).appendTo(e):e.find("div[id='hap_audioHolder']");var v,cb,Me=50,ec,Td=!1,Oe=!1,Ed,Kb,A=h.flashYoutube,Qe=!1,oc=100,na,ac=!1,Aa=!1,vb=!1,Tc,Sc=!1,Da=[],Kc,fc,db,Rc,fa;hb&&de();var p=g.playlistManager({randomPlay:ka,loopingOn:ja});g(p).bind("ap_PlaylistManager.COUNTER_READY",function(){var a=p.getCounter(),b=y[a]; b&&!Lc&&(qd(),Oa&&Fa(),x=b.origtype?b.origtype:b.type,Z=b.mp3,Qa=b.ogg,b.download?$b=!0:$b=null,Ab(),Qc(),"undefined"!==typeof itemTriggered&&itemTriggered(I,J,a))});g(p).bind("ap_PlaylistManager.PLAYLIST_END",function(){qd();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(I,J);B=!1;sa("off")});g(p).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(I,J)});var Pa="",Wa="",Xa="",ra;"ontouchstart"in window? (ra=!0,Pa="touchstart.ap",Wa="touchmove.ap",Xa="touchend.ap"):(ra=!1,Pa="mousedown.ap",Wa="mousemove.ap",Xa="mouseup.ap");var mb=!1,qc,Qb=!1,z=h.defaultVolume;0>z&&(z=0);0==z?qc=0.5:1<z&&(z=1);var W=e.find(".volume_seekbar").css("cursor","pointer").bind(Pa,function(a){fe(a);return Qb=!1}),lb="horizontal";void 0!=W.attr("data-orientation")&&(lb=W.attr("data-orientation").toLowerCase());if(void 0!=W.attr("data-autoHide")){var mb=!0,xb=!1,P,Sb=parseInt(W.attr("data-autoHide"),10),Rb=function(){P&&clearTimeout(P); W.css("display","none");xb=!1};isMobile||kf.bind("mouseover",function(){if(!m)return!1;P&&clearTimeout(P);W.css("display","block");xb=!0;return!1}).bind("mouseout",function(){if(!m)return!1;P&&clearTimeout(P);P=setTimeout(Rb,Sb);return!1})}var kb=!1,Pb=e.find(".volume_bg");if("horizontal"==lb)var aa=Pb.width(),rc=e.find(".volume_level").css("width",z*aa+"px");else aa=Pb.height(),rc=e.find(".volume_level").css("height",z*aa+"px");if(mf&&!isMobile){W.bind("mouseover",sc);var va=e.find(".player_volume_tooltip"), ge=parseInt(va.css("top"),10);va.bind("mouseenter",function(){W.unbind("mouseover",sc);va.css("display","none")}).bind("mouseleave",function(){W.bind("mouseover",sc)})}else e.find(".player_volume_tooltip").remove();var Ka,pb,V=!1,uc=e.find(".progress_bg"),ua=e.find(".load_progress"),ga=e.find(".play_progress"),Ga=e.find(".player_progress"),G=uc.width(),tc=!1;if(T){var Ua=e.find(".load_canvas").css("cursor","pointer"),$c=e.find(".play_canvas"),wa=e.find(".circlePlayer"),be=parseFloat(wa.attr("data-offOpacity"), 10),ce=parseFloat(wa.attr("data-onOpacity"),10);isMobile&&(be=ce=1);var gb={flash_id:h.flash_id,strokeSize:parseInt(wa.attr("data-strokeSize"),10),play_color:$c.attr("data-bgcolor"),load_color:Ua.attr("data-bgcolor"),tolerance:parseInt(wa.attr("data-tolerance"),10),offOpacity:be,onOpacity:ce,circleWidth:Ua.width(),circleHeight:Ua.height()};if(ha){var sb=gb.strokeSize,zc=gb.play_color,ke=gb.load_color,H=Ua[0].getContext("2d"),Ha=$c[0].getContext("2d"),md=2*Math.PI,Wb=Math.PI/2,$=gb.circleWidth,ba= gb.circleHeight,yc=$/2,hd=yc-sb,ie=h.tolerance,gd,wc=!1,ca=0;Ua.bind(Pa,function(a){wc=vc(a)?!1:!0;ed(a);return!1});Ga=Ua}else Ua.remove(),$c.remove()}else Ga=e.find(".player_progress").css("cursor","pointer").bind(Pa,function(a){ed(a);return!1});if(nf&&!isMobile){Ga.bind("mouseover",xc);var ia=e.find(".player_progress_tooltip").css("zIndex",50);ia.find("p").html("0:00"+ld+"0:00");ia.bind("mouseenter",function(){Ga.unbind("mouseover",xc);ia.css("display","none")}).bind("mouseleave",function(){Ga.bind("mouseover", xc)})}else e.find(".player_progress_tooltip").remove();this.flashVideoPause=function(){sa("off");B=!1;nc()};this.flashVideoResume=function(){Ma("off");B=!0;mc()};this.flashVideoEnd=function(){lc()};this.flashVideoStart=function(){Ma("off");O=B=!0;mc()};this.flashYoutubeData=function(a,b,c,d){T?(isNaN(a)||isNaN(b)||"undefined"!==typeof k(S)&&k(S).pb_drawLoadbar(a/b),isNaN(c)||isNaN(d)||(ca=c/d,V||"undefined"!==typeof k(S)&&k(S).pb_drawSeekbar(c/d))):(isNaN(a)||isNaN(b)||ua&&ua.width(a/b*G),isNaN(c)|| isNaN(d)||ga&&ga.width(c/d*G));isNaN(c)||isNaN(d)||(pa&&pa.html(qb(c)+Sa),qa&&qa.html(rb(d)))};this.flashAudioData=function(a,b,c,d){a/=b;T?ha?(isNaN(a)||Ac(a),isNaN(c)||isNaN(d)||(ca=c/d,!V&&B&&La(c/d))):(null!==a&&"undefined"!==typeof k(S)&&k(S).pb_drawLoadbar(a),isNaN(c)||isNaN(d)||(ca=c/d,V||"undefined"!==typeof k(S)&&k(S).pb_drawSeekbar(c/d))):(!V&&ga&&ga.width(c/d*G),null!==a&&(a*=G,a>G&&(a=G),ua&&ua.width(a)),isNaN(c)||isNaN(d)||(pa&&pa.html(qb(c)+Sa),qa&&qa.html(rb(d))))};this.flashAudioEnd= function(){lc()};this.flashCircleToggle=function(a){nb()};this.flashCircleOverLoader=function(a){ia.css("display","block");kd(a)};this.flashCircleOutLoader=function(){ia.css("display","none")};this.flashCircleSeek=function(a){id(a)};this.embedFlash=function(){if(Q)h.useOnlyMp3Format&&!Ta&&(a=s.substr(1),embedFlashAudio(a));else{var a=A.substr(1);embedFlashMain(a);a=s.substr(1);embedFlashAudio(a);T&&(a=S.substr(1),embedFlashCircle(a))}};of&&za.keyup(function(a){if(!m||u)return!1;a||(a=window.event); a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=a.keyCode;37==a?I.previousAudio():39==a?I.nextAudio():32==a?I.toggleAudio():77==a&&(pc(),Ya());return!1});jf.resize(function(){if(!m||u)return!1;Zc&&clearTimeout(Zc);Zc=setTimeout(Ld,150)});this.setPlayIcon=function(){ma&&ma.hasClass("play_link")&&ma.attr("src",jc);B=!1};this.playAudio=function(){if(!m||u||!t||B||!O)return!1;if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;Q?v.togglePlayback():"undefined"!==typeof k(A)&& k(A).pb_togglePlayback()}else M?n&&n.play():"undefined"!==typeof k(s)&&k(s).pb_play();Ma("off");O=B=!0};this.pauseAudio=function(){if(!m||u||!t||!B||!O)return!1;if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;Q?v.togglePlayback():"undefined"!==typeof k(A)&&k(A).pb_togglePlayback()}else M?n&&n.pause():"undefined"!==typeof k(s)&&k(s).pb_pause();sa("off");B=!1};this.toggleAudio=function(){if(!m||u||!t||!O)return!1;nb()};this.stopAudio=function(){if(!m||u||!t||!O)return!1;if("youtube_single"== x||"youtube_playlist"==x){if(!Aa)return!1;Q?v.stop():"undefined"!==typeof k(A)&&k(A).pb_dispose()}else M?n&&(n.src="",Ta?n.src=Z:Mb&&(n.src=Qa)):"undefined"!==typeof k(s)&&k(s).pb_dispose();Ec();B=!1};this.checkAudio=function(a){if(!m||u||!t)return!1;a=a.toLowerCase();if(B){if("pause"==a)if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;Q?v.togglePlayback():"undefined"!==typeof k(A)&&k(A).pb_togglePlayback()}else M?n&&n.pause():"undefined"!==typeof k(s)&&k(s).pb_pause();else if("stop"== a){if("youtube_single"==x||"youtube_playlist"==x){if(!Aa)return!1;v.stop()}else M?n&&(n.src="",Ta?n.src=Z:Mb&&(n.src=Qa)):"undefined"!==typeof k(s)&&k(s).pb_dispose();Ec()}B=!1;sa("off")}};this.nextAudio=function(){if(!m||u||!t)return!1;ya();p.advanceHandler(1,!0)};this.previousAudio=function(){if(!m||u||!t)return!1;ya();p.advanceHandler(-1,!0)};this.loadAudio=function(a){if(!m||u||!t)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<C;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return q&&alert('Track with name "'+ a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a>C-1)return q&&alert('Invalid track number. Track number "'+a+'" doesnt exist. Load audio failed.'),!1}else return q&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;ya();p.processPlaylistRequest(a)};this.loadPlaylist=function(a){if(!m||u)return!1;if("undefined"===typeof a)return q&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1; ab=a;ud(ab)};this.addTrack=function(a,b,c,d){if(!m||u)return!1;if("undefined"===typeof a)return q&&alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"===typeof b)return q&&alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof c)return q&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var f=1,e=!1;if("string"!==typeof c&&"[object Object]"!==Object.prototype.toString.call(c))if("[object Array]"===Object.prototype.toString.call(c))f= c.length,e=!0;else return q&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;la=d;a=a.toLowerCase();"visible"==a?(t&&da&&Bb(),Db=!0,da=!1):(t&&!da&&Bb(),da=$a=!0);Na=!1;if(t)if("undefined"!==typeof la){if(0>la||la>C)return q&&alert('Invalid position to insert track to. Position number "'+d+'" doesnt exist. AddTrack failed.'),!1;la==C&&(Na=!0)}else Na=!0,la=C-1;else{if("undefined"!==typeof la){if(0!=la)return q&&alert('Invalid position to insert track to. Position number "'+ d+'" doesnt exist. AddTrack failed.'),!1}else la=0;Na=!0}vd();u=!0;Cb=!1;d=0;var h;h="playlist"+Math.floor(9999*Math.random());var k=g("<ul id = "+h+"></ul>");b=b.toLowerCase();for(d;d<f;d++)h=e?c[d]:c,"html"==b?Ic(h).appendTo(k):(h.type&&h.mp3||h.path)&&Dd(h).appendTo(k);w=[];bb.empty();k.appendTo(bb).find("li[class='playlistItem']").each(function(){w.push(g(this))});Za=!1;t||(Za=!0,t="visible"==a?xa:xd);E()};this.inputAudio=function(a){if(!m||u)return!1;if("undefined"===typeof a)return q&&alert("inputAudio method requires data parameter. inputAudio failed."), !1;if("undefined"===a.mp3)return q&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."),!1;ya();p.reSetCounter();Z=a.mp3;"undefined"!==a.ogg&&(Qa=a.ogg);"undefined"!==a.title?Fa(a.title):Fa(Nb);isMobile&&(X=!0,M||"undefined"!==typeof k(s)&&k(s).pb_setAutoplay(!0));Ab();Qc()};this.removeTrack=function(a){if(!m||u||!t)return!1;if("undefined"===typeof a)return q&&alert("removeTrack method requires track parameter. removeTrack failed."),!1;if("string"===typeof a){var b=0,c=!1;for(b;b< C;b++)if(a==y[b].title){a=b;c=!0;break}if(!c)return q&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'),!1;N[a]&&y[a]?(N[a].remove(),y.splice(a,1),ib(a)):q&&alert('RemoveTrack with name "'+a+'" failed.')}else if("number"===typeof a){if(0>a||a>C-1)return q&&alert('Invalid track number. Track number "'+a+'" doesnt exist. RemoveTrack failed.'),!1;N[a]&&y[a]?(N[a].remove(),y.splice(a,1),ib(a)):q&&alert('RemoveTrack with name "'+a+'" failed.')}else if("[object Array]"===Object.prototype.toString.call(a))if("string"=== typeof a[0]?b=!0:"number"===typeof a[0]&&(b=!1),b){var b=0,c=a.length,d,f,e;b;a:for(;b<c;b++)if(f=a[b],"string"===typeof f){e=0;d=y.length;if(0==d){ib();break a}for(e;e<d;e++)if(f==y[e].title&&N[e]&&y[e]){N[e].remove();y.splice(e,1);ib(e);break}}}else a:for(a.sort(gf),b=0,c=a.length,b;b<c;b++){if(f=a[b],"number"===typeof f){d=y.length;if(0==d){ib();break a}-1<f&&f<d&&N[f]&&y[f]&&(N[f].remove(),y.splice(f,1),ib(f))}}else return q&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."), !1};this.destroyAudio=function(){if(!m||u||!t)return!1;rd()};this.destroyPlaylist=function(){if(!m||u||!t)return!1;Bb()};this.setTitle=function(a){if(!m||u||!t)return!1;Fa(a)};this.toggleShuffle=function(){if(!m||u)return!1;ka?(e.find(".player_shuffle").find("img").attr("src",Zb),ka=!1):(e.find(".player_shuffle").find("img").attr("src",zb),ka=!0);p.setRandom(ka)};this.toggleLoop=function(){if(!m||u)return!1;ja?(e.find(".player_loop").find("img").attr("src",Yb),ja=!1):(e.find(".player_loop").find("img").attr("src", yb),ja=!0);p.setLooping(ja)};this.setVolume=function(a){if(!m||u)return!1;0>a?a=0:1<a&&(a=1);z=a;Ya()};this.getVolume=function(){return m?z:!1};this.setAutoPlay=function(a){if(!m)return!1;X=a;M||"undefined"!==typeof k(s)&&k(s).pb_setAutoplay(a)};this.getAutoPlay=function(){return m?X:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return eb};this.getSetupDone=function(){return m};this.getPlaylistLoaded=function(){return Cb};this.getPlaylistTransition=function(){return u}; this.getMediaPlaying=function(){return!m||u?!1:B};this.getAudioInited=function(){return!m||u?!1:O};this.getMediaType=function(){return!m||u?!1:x};this.getActiveItem=function(){return!m||u?!1:p.getCounter()};this.getPlaylistItems=function(a){if(!m||u||!N||0==N.length)return!1;if("string"===typeof a)return N;if("number"===typeof a)return 0>num||num>C-1||!N[num]?!1:N[num]};this.getMediaCount=function(){return!m||u?!1:isNaN(C)?0:C};this.getPlaylistHidden=function(){return!m||u?!1:da};this.getPlaylistList= function(){return m&&Ia&&0!=Ia.length?Ia:!1};this.orderPlaylist=function(a,b){if(!m||!t)return!1;if("undefined"===typeof a)return q&&alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var c=t.children("li"),d=c.length;if(0==d)return!1;var e=a.toLowerCase();if("reverse"==e)t.append(c.get().reverse());else if("random"==e||"remap"==e||"swap"==e){if("random"==e)b=ef(d);else if("remap"==e){if("undefined"===typeof b||b.length!=d)return!1}else if("swap"==e){if("undefined"=== typeof b||2!=b.length)return!1;c=ff(d);c.splice(b[1],1,b[0]);c.splice(b[0],1,b[1]);b=g.extend(!0,[],c)}else return!1;orderedItems=jQuery.map(b,function(a){return jQuery(N).get(a)});t.empty().html(orderedItems)}else return q&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;gc();if(c=xa.find("a[class=playlistSelected]").attr("data-id"))p.reSetCounter(c),Oa&&Fa()};this.checkScroll=function(){if(!m||u||!t)return!1;Bc()};this.reinitScroll=function(){if(!m||u||!t)return!1; R&&(R.reinitialise(),"vertical"==tb?(R.scrollToY(0),g(".jspPane").css("top","0px")):(R.scrollToX(0),g(".jspPane").css("left","0px")));hb&&fa&&p&&-1!=p.getCounter()&&Oa&&Fa()};this.getPlaylistData=function(){return m&&!u&&t?y:!1};this.getSoundId=function(){return m?J:!1};this.getTouch=function(){return m?ra:!1};Q?(g(".flashMain").remove(),g(".circleMain").remove(),M?(g(".flashAudio").remove(),fb()):Ve()):Se();return this}})(jQuery);