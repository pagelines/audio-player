(function(e){e.fn.html5audio=function(t){function n(){var n=0==On.find("div[class='fontMeasure']").length?e("<div/>").addClass("fontMeasure").appendTo(On):On.find("div[class='fontMeasure']");rs=new apTextScroller;rs.init(n,In,Fn,"left",t.scrollSeparator,t.scrollSpeed)}function r(e){if($t&&!ti&&!ks){if(!bs){if(as){if(e=e.originalEvent.touches,!(e&&0<e.length))return!1}else e.preventDefault();bs=!0;Qt.bind(os,function(e){e:{var t;if(as){if(e.originalEvent.touches&&e.originalEvent.touches.length)t=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)break e;t=e.originalEvent.changedTouches}if(1<t.length)break e;t=t[0]}else t=e;e.preventDefault();i(t)}}).bind(us,function(e){e:if(bs){bs=!1;Qt.unbind(os).unbind(us);var t;if(as){if(e.originalEvent.touches&&e.originalEvent.touches.length)t=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)break e;t=e.originalEvent.changedTouches}if(1<t.length)break e;t=t[0]}else t=e;e.preventDefault();i(t)}})}return!1}}function i(e){"horizontal"==ds?hs=Math.max(0,Math.min(1,(e.pageX-ws.offset().left)/Es)):(hs=Math.max(0,Math.min(1,(e.pageY-ws.offset().top)/Es)),hs=1-hs);o()}function s(){if(!$t||ti)return!1;cs?(hs=ls,cs=!1):(ls=hs,hs=0,cs=!0)}function o(){"horizontal"==ds?Ss.css("width",hs*Es+"px"):Ss.css("height",hs*Es+"px");ai&&("youtube_single"==ui||"youtube_playlist"==ui?on?Hi&&Hi.setVolume(hs):"undefined"!=typeof ct(zi)&&ct(zi).pb_setVolume(hs):Cr?Di&&(Di.volume=hs):"undefined"!=typeof ct(Ai)&&ct(Ai).pb_setVolume(hs));0<hs?On.find(".player_volume").find("img").attr("src",gn):On.find(".player_volume").find("img").attr("src",bn);isMobile&&fs&&(ms&&clearTimeout(ms),ms=setTimeout(ys,gs))}function u(){fs&&ms&&clearTimeout(ms);xs.css("display","block");ps.bind("mousemove",f).bind("mouseout",a);Qt.bind("mouseout",a)}function a(){fs&&(ms&&clearTimeout(ms),ms=setTimeout(ys,gs));xs.css("display","none");ps.unbind("mousemove",f).unbind("mouseout",a);Qt.unbind("mouseout",a)}function f(e){if("horizontal"==ds){e=e.pageX-ps.offset().left;if(isNaN(e))return!1;0>e?e=0:e>Es&&(e=Es);var t=parseInt(e-xs.width()/2,10);xs.css("left",t+"px");e=Math.max(0,Math.min(1,e/Es));e=parseInt(100*e,10)}else{e=e.pageY-ps.offset().top;if(isNaN(e))return!1;0>e?e=0:e>Es&&(e=Es);t=parseInt(e-xs.height()/2,10);xs.css("top",t+Ts+"px");e=Math.max(0,Math.min(1,e/Es));e=parseInt(100*(1-e),10)}xs.find("p").html(e+" %")}function l(e){if($t&&!ti&&ai&&!bs&&!ni){if(!ks){if(as){if(e=e.originalEvent.touches,!(e&&0<e.length))return!1}else e.preventDefault();ks=!0;Qt.bind(os,function(e){e:{var t;if(as){if(e.originalEvent.touches&&e.originalEvent.touches.length)t=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)break e;t=e.originalEvent.changedTouches}if(1<t.length)break e;t=t[0]}else t=e;e.preventDefault();h(t,e)}}).bind(us,function(e){c(e)})}return!1}}function c(e){if(ks){ks=!1;Qt.unbind(os).unbind(us);var t;if(as){if(e.originalEvent.touches&&e.originalEvent.touches.length)t=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;t=e.originalEvent.changedTouches}if(1<t.length)return!1;t=t[0]}else t=e;e.preventDefault();h(t,e)}if(Mn)var n=setTimeout(function(){n&&clearTimeout(n);Ds=!1},500);return!1}function h(e,t){if(!Mn){Ns=e.pageX-Ls.offset().left;0>Ns?Ns=0:Ns>_s&&(Ns=_s);Os.width(Ns);var n=Math.max(0,Math.min(1,Ns/_s))}else if(_n){if(S(t)){if(Zs||Ys>Qs-Gs)return!1;ks||(N(!0),zs.clearRect(0,0,$s,Js),b(eo),E());return!1}if(!Zs)return!1;Ds=!0;var n=e.pageX-Bs.offset().left-$s/2,r=e.pageY-Bs.offset().top-Js/2,n=Math.atan2(r,n);n>-1*Math.PI&&n<-0.5*Math.PI&&(n=2*Math.PI+n);eo=n=Math.max(0,Math.min((n+Math.PI/2)/2*Math.PI*10))/100;zs.clearRect(0,0,$s,Js);b(eo);E()}if(isNaN(n))return!1;Cs=eo;p(n)}function p(e){"youtube_single"==ui||"youtube_playlist"==ui?on?(e=(e*Hi.getDuration()).toFixed(1),isNaN(e)||Hi.seek(e)):"undefined"!=typeof ct(zi)&&ct(zi).pb_seek(e):Cr?Di&&Di.seekable&&0<Di.seekable.length&&(!tn||isMobile?Di.currentTime=e*Di.duration:e*Di.duration>=Di.buffered.end(0)-5?Di.currentTime=Di.buffered.end(0)-5:Di.currentTime=e*Di.duration):"undefined"!=typeof ct(Ai)&&ct(Ai).pb_seek(e)}function d(){ai&&(to.css("display","block"),Ms.bind("mousemove",m).bind("mouseout",v),Qt.bind("mouseout",v))}function v(){ai&&(to.css("display","none"),Ms.unbind("mousemove",m).unbind("mouseout",v),Qt.unbind("mouseout",v))}function m(e){if(!Mn){e=e.pageX-Ms.offset().left;if(isNaN(e))return!1;0>e?e=0:e>_s&&(e=_s);var t=parseInt(e-to.width()/2,10);to.css("left",t+"px");t=Math.max(0,Math.min(1,e/_s))}else if(_n){if(S(e))return to.css("display","none"),!1;t=e.pageX-Bs.offset().left;e=e.pageY-Bs.offset().top;e=Math.atan2(e-Js/2,t-$s/2);e>-1*Math.PI&&e<-0.5*Math.PI&&(e=2*Math.PI+e);t=Math.max(0,Math.min((e+Math.PI/2)/2*Math.PI*10))/100;to.css("display","block")}if(isNaN(t))return!1;y(t)}function y(e){if(isNaN(e))return!1;var t,n;"youtube_single"==ui||"youtube_playlist"==ui?on?(n=Hi.getDuration(),t=e*n):"undefined"!=typeof ct(zi)&&(n=ct(zi).pb_getFlashDuration(),t=e*n):Cr?Di&&(n=Di.duration,t=e*n):"undefined"!=typeof ct(Ai)&&(n=ct(Ai).pb_getFlashDuration(),t=e*n);if(isNaN(t)||isNaN(n))return!1;to.find("p").html(Ot(t)+or+Mt(n))}function b(e){zs.beginPath();zs.arc($s/2,Js/2,Ks-qs/2,-Vs,Xs*e-Vs,!1);zs.strokeStyle=Rs;zs.lineCap="butt";zs.lineWidth=qs;zs.stroke()}function w(e){Ws.beginPath();Ws.arc($s/2,Js/2,Ks-qs/2,-Vs,Xs*e-Vs,!1);Ws.strokeStyle=Us;Ws.lineCap="butt";Ws.lineWidth=qs;Ws.stroke()}function E(){if(ci)e=62,t=57,zs.fillStyle=Rs,zs.fillRect(e,t,14,45),zs.fillRect(e+23,t,14,45);else{var e=65,t=57,n=65-e,r=102-t,i=Math.atan2(r,n)-Math.PI/3,r=Math.sqrt(n*n+r*r),n=Math.cos(i)*r+e,i=Math.sin(i)*r+t;zs.beginPath();zs.fillStyle=Rs;zs.moveTo(e,t);zs.lineTo(65,102);zs.lineTo(n,i);zs.fill()}}function S(e){var t;if(as){if(e.originalEvent.touches&&e.originalEvent.touches.length)e=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;e=e.originalEvent.changedTouches}if(1<e.length)return!1;t=e[0]}else t=e;e=t.pageX-Bs.offset().left;t=t.pageY-Bs.offset().top;var n=$s/2,r=Js/2;Ys=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r));return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r))<Qs}function x(t){bi?"vertical"==pr?Hn.outerHeight(!0)>=Pn.height()?(bi.reinitialise(),t&&(bi.scrollToY(0),e(".jspPane").css("top","0px"))):(bi.destroy(),bi=null):(bi.reinitialise(),t&&(bi.scrollToX(0),e(".jspPane").css("left","0px"))):(t=On.find(".componentPlaylist"),bi=t.jScrollPane().data().jsp,t.bind("jsp-initialised",function(e,t){}).jScrollPane({mouseWheelSpeed:20}),"horizontal"==pr&&(isMobile||t.bind("mousewheel",T)))}function T(e,t,n,r){if(!$t||ti)return!1;bi&&bi.scrollByX(100*(0<t?-1:1));return!1}function N(e){if(ci){if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?Hi.togglePlayback():("undefined"!=typeof ct(zi)&&ct(zi).pb_togglePlayback(),ai=!0)}else Cr?Di&&Di.pause():"undefined"!=typeof ct(Ai)&&ct(Ai).pb_pause();ci=!1;Lt("off")}else{if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?isMobile?!Ki&&Xn?($t=!1,nt("on")):Hi.togglePlayback():Hi.togglePlayback():("undefined"!=typeof ct(zi)&&ct(zi).pb_togglePlayback(),ai=!0)}else Cr?Di&&Di.play():"undefined"!=typeof ct(Ai)&&ct(Ai).pb_play();ci=!0;At("off")}if(!e)return!1}function C(t){if(!$t||ti)return!1;t||(t=window.event);t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();t=e(t.currentTarget);var n=t.attr("data-id");if(t.closest(".playlistItem").hasClass(Qr))return!1;Xn=!0;O();is.processPlaylistRequest(n);return!1}function k(t){if(!$t||ti)return!1;t||(t=window.event);t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();t=e(t.currentTarget).attr("class").split(" ");if(-1!=e.inArray("controls_prev",t))Xn=!0,O(),is.advanceHandler(-1,!0);else if(-1!=e.inArray("controls_toggle",t)){if(!ai)return;N()}else if(-1!=e.inArray("controls_next",t))Xn=!0,O(),is.advanceHandler(1,!0);else if(-1!=e.inArray("player_volume",t))isMobile?fs?(ms&&clearTimeout(ms),vs?(ps.css("display","none"),vs=!1):(ps.css("display","block"),vs=!0,ms=setTimeout(ys,gs))):(s(),o()):(s(),o());else if(-1!=e.inArray("player_download",t)){if(!qr)if(t=ui){var n=is.getCounter(),r=vi[n].download,n=Dt(n,!1);t=W(t,n,r);X(t.name,t.path)}else cr&&alert("Invalid data-type for file download function! Quitting."),qr=!1}else-1!=e.inArray("player_loop",t)?(rr?(On.find(".player_loop").find("img").attr("src",vn),rr=!1):(On.find(".player_loop").find("img").attr("src",mn),rr=!0),is.setLooping(rr)):-1!=e.inArray("player_shuffle",t)&&(ir?(On.find(".player_shuffle").find("img").attr("src",En),ir=!1):(On.find(".player_shuffle").find("img").attr("src",Sn),ir=!0),is.setRandom(ir));return!1}function L(t){if($t)return t||(t=window.event),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation(),t=e(t.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",t)?On.find(".controls_prev").find("img").attr("src",an):-1!=e.inArray("controls_toggle",t)?ci?At("on"):Lt("on"):-1!=e.inArray("controls_next",t)?On.find(".controls_next").find("img").attr("src",ln):-1!=e.inArray("player_volume",t)?0<hs?On.find(".player_volume").find("img").attr("src",yn):On.find(".player_volume").find("img").attr("src",wn):-1!=e.inArray("player_download",t)?On.find(".player_download").find("img").attr("src",Tn):-1!=e.inArray("player_loop",t)?rr?On.find(".player_loop").find("img").attr("src",vn):On.find(".player_loop").find("img").attr("src",mn):-1!=e.inArray("player_shuffle",t)&&(ir?On.find(".player_shuffle").find("img").attr("src",En):On.find(".player_shuffle").find("img").attr("src",Sn)),!1}function A(t){if($t)return t||(t=window.event),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation(),t=e(t.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",t)?On.find(".controls_prev").find("img").attr("src",un):-1!=e.inArray("controls_toggle",t)?ci?At("off"):Lt("off"):-1!=e.inArray("controls_next",t)?On.find(".controls_next").find("img").attr("src",fn):-1!=e.inArray("player_volume",t)?0<hs?On.find(".player_volume").find("img").attr("src",gn):On.find(".player_volume").find("img").attr("src",bn):-1!=e.inArray("player_download",t)?On.find(".player_download").find("img").attr("src",xn):-1!=e.inArray("player_loop",t)?rr?On.find(".player_loop").find("img").attr("src",mn):On.find(".player_loop").find("img").attr("src",vn):-1!=e.inArray("player_shuffle",t)&&(ir?On.find(".player_shuffle").find("img").attr("src",Sn):On.find(".player_shuffle").find("img").attr("src",En)),!1}function O(){if(!Dr&&-1!=is.getCounter()){var t=e(mi[is.getCounter()]);if(t&&t.hasClass("playlistSelected")){var n=t.attr("data-id");t.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!=typeof playlistItemEnabled&&playlistItemEnabled(Jt,Wn,t,n)}}}function M(){if(!Dr){var t=e(mi[is.getCounter()]);if(t&&t.hasClass("playlistNonSelected")){var n=t.attr("data-id");t.removeClass("playlistNonSelected").addClass("playlistSelected");"undefined"!=typeof playlistItemDisabled&&playlistItemDisabled(Jt,Wn,t,n)}}}function _(){var e=t.activeItem;isNaN(e)||-1==e?Xn=!0:(0>e?e=0:e>yi-1&&(e=yi-1),is.setCounter(e,!1))}function D(){ei&&-1!=is.getCounter()&&(H(),Ct(),O())}function P(){H();Ct();var t=0,n;for(t;t<yi;t++)n=e(mi[t]).unbind("click",C),Sr&&!isMobile&&n.unbind("mouseenter").unbind("mouseleave");ei&&(ei.children().each(function(){var t=e(this);t.data("hap_wrap_player")&&t.data("hap_wrap_player").destroyPlaylist()}),ei.empty(),ei=null);Hn.empty();Dr=Gr=!1;zr=Rr=Zr=null;_r=Mr=Or=!1;lr=null;is.reSetCounter();vi=[];mi=[];gi=[];bi&&bi.reinitialise()}function H(){$i&&(on?Hi&&Hi.stop():"undefined"!=typeof ct(zi)&&ct(zi).pb_dispose(),$i=!1);Cr?(pi&&clearInterval(pi),Di&&(Di.pause(),Di.src=""),_i&&_i.unbind("ended pause play canplay canplaythrough loadedmetadata")):"undefined"!=typeof ct(Ai)&&ct(Ai).pb_dispose();kt();zr?Un.css("display","block"):Un.css("display","none");Cs=null;ri=ai=ci=ni=!1}function B(t){if("undefined"==typeof t)return cr&&alert("setPlaylist method requires data parameter. loadPlaylist failed."),!1;if("undefined"==typeof t.hidden)return cr&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var n=Ut(t.hidden);if("undefined"==typeof t.id)return cr&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."),!1;t=t.id;ti=!0;Nt();Hn.css("opacity",0);ei&&P();Gr=!1;Dr=n;Dn&&isIE?(n=e(zn.find(t).css("display","block").clone().wrap("<p>").parent().html()),e(zn.find(t).css("display","none"))):(n=zn.find(t).css("display","block").clone(),zn.find(t).css("display","none"));n.css("fontSize",0);if(0==n.length)return cr&&alert('Failed to select playlist! Make sure that element: "'+t+'" exist in playlist list! Quitting.'),Tt(),!1;if(Dr)Si.empty(),n.appendTo(Si),Ar=0,_r=Mr=Lr=!0,ei=xi;else{if(!bi&&0==Hn.length)return cr&&alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),!1;n.appendTo(Hn);ei=n}vi=[];mi=[];gi=[];Li=[];n.find("li[class*='playlistItem']").each(function(){Li.push(e(this))});j()}function j(){Li.length?F():q()}function F(){Xr=Wr=Ur=Rr=jr=null;Br=!1;var t=Li[0],n=t.attr("data-type").toLowerCase(),r=t.attr("data-path"),i=t.hasClass(Pr);ki=[];t.hasClass(Hr)&&(Br=!0);void 0==t.attr("data-plink")||Ft(t.attr("data-plink"))||(jr=t.attr("data-plink"));void 0!=t.attr("data-dlink")&&("youtube_single"==n||"youtube_playlist"==n?Ft(t.attr("data-dlink"))||(Rr=t.attr("data-dlink")):Rr=Ft(t.attr("data-dlink"))?!0:t.attr("data-dlink"));void 0!=t.attr("data-download")&&("youtube_single"==n||"youtube_playlist"==n?Ft(t.attr("data-download"))||(Ur=t.attr("data-download")):Ur=Ft(t.attr("data-download"))?!0:t.attr("data-download"));void 0==t.attr("data-thumb")||Ft(t.attr("data-thumb"))||(Wr=t.attr("data-thumb"));Ft(e.trim(t.html()))||(Xr=t.html());if(i)Zr=t,Li.shift(),j();else if("local"==n)Zr=t,Li.shift(),j();else if("soundcloud"==n)Zr=t.data("toremove","true"),si=0,ht(r);else if("podcast"==n)Zr=t.data("toremove","true"),i="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+Yn+"&callback=?&q="+encodeURIComponent(r),e.ajax({type:"GET",url:i,dataType:"jsonp",cache:!1}).done(function(t){if(null==t.responseData)cr&&alert("Playlist process failed, podcast: "+r),Zr&&"true"==Zr.data("toremove")&&Zr.remove(),Li.shift(),j();else{if(ieBelow9){t=qt(t.responseData.xmlString);var n;e(t).find("item").each(function(){n=e(this);a={type:"podcast"};a.mp3=n.find("enclosure").attr("url");a.ogg="";a.title=n.find("title").text();0<n.find("media\\:thumbnail").length?n.find("media\\:thumbnail").attr("url")?a.thumb=n.find("media\\:thumbnail").attr("url"):Wr&&(a.thumb=Wr):Wr&&(a.thumb=Wr);jr&&(a.url=jr);Rr&&(a.dlink=Rr);Ur&&(a.download=Ur);ki.push(a)})}else{wi.html(t.responseData.xmlString);t=wi.get(0).getElementsByTagName("item");var i=0,s=t.length,o,u,a;for(i;i<s;i++)o=t[i],a={type:"podcast"},a.mp3=o.getElementsByTagName("enclosure")[0].getAttribute("url"),a.ogg="",void 0!=o.getElementsByTagName("itunes:duration")[0]&&(u=It(o.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue),a.length=parseInt(1e3*u,10)),void 0!=o.getElementsByTagName("media:thumbnail")[0]?void 0!=o.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?a.thumb=o.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):Wr&&(a.thumb=Wr):Wr&&(a.thumb=Wr),a.title=o.getElementsByTagName("title")[0].childNodes[0].nodeValue,jr&&(a.url=jr),Rr&&(a.dlink=Rr),Ur&&(a.download=Ur),ki.push(a)}I()}}).fail(function(e,t,n){cr&&alert("Parse feed error: "+e.responseText);cr&&alert("Playlist process failed, podcast: "+r);Zr&&"true"==Zr.data("toremove")&&Zr.remove();Li.shift();j()});else if("folder"==n){Zr=t.data("toremove","true");var i=hap_source_path+"folder_parser.php",s=!0;void 0!=t.attr("data-subdirs")&&"false"==t.attr("data-subdirs")&&(s=!1);s={dir:r,subdirs:s};e.ajax({type:"GET",url:i,data:s,dataType:"json"}).done(function(e){jt(e,"title");var t=0,n=e.length,r,i;xr&&(kr=ki.length?ki.length-1:0);for(t;t<n;t++)if(r=e[t],i=r.path,i=i.replace(/\\'/g,"'"),i=i.replace(/\\"/g,'"'),i=i.replace(/\\0/g,"\0"),path=i=i.replace(/\\\\/g,"\\"),i={type:"folder"},/.mp3/.test(path)){i.mp3=path;i.ogg=path.substr(0,path.lastIndexOf("."))+".ogg";var s=path.substr(0,path.lastIndexOf("."));title=/\//i.test(s)?s.substr(s.lastIndexOf("/")+1):s;title=title.split("_").join(" ");i.title=title;i.thumb=path.substr(0,path.lastIndexOf("."))+".jpg";i.size=parseInt(r.size,10);i.lastmod=parseInt(r.lastmod,10);jr&&(i.url=jr);Rr&&(i.dlink=Rr);Ur&&(i.download=Ur);Wr&&(i.thumb=Wr);ki.push(i)}ki.length&&xr?vt():I()}).fail(function(e,t,n){cr&&alert("Read folder error! Make sure you run this online or on local server!");cr&&alert("Playlist process failed, folder: "+r);Zr&&"true"==Zr.data("toremove")&&Zr.remove();Li.shift();j()})}else if("xml"==n){Zr=t;var i=hap_source_path+r,o,u=[];e.ajax({type:"GET",url:i,dataType:"html",cache:!1}).done(function(n){Li.shift();e(n).find("li[class='playlistItem']").each(function(){o=Xt(e(this));Zr?Zr.after(e(o)):0<ei.children().size()?e(o).prependTo(ei):e(o).appendTo(ei);Zr=e(o);u.push(e(o))});n=0;var r=u.length;u.reverse();for(n;n<r;n++)Li.unshift(u[n]);u=null;t.remove();j()}).fail(function(e,t,n){cr&&alert("Playlist process failed, xml: "+r);Zr&&Zr.remove();Li.shift();j()})}else if("database_data"==n||"database_html"==n)if(void 0==t.attr("data-table")||Ft(t.attr("data-table")))cr&&(alert("Database table missing!"),alert("Playlist process failed, database query: "+r)),Li.shift(),j();else{var a=s=null,f=null;void 0==t.attr("data-limit")||Ft(t.attr("data-limit"))||(s=parseInt(t.attr("data-limit"),10));void 0==t.attr("data-range")||Ft(t.attr("data-range"))||(i=t.attr("data-range").split(","),2==i.length&&(a=i[0],f=i[1]));Zr=t;i=hap_source_path+"includes/database.php";u=[];s={db_name:r,db_table:t.attr("data-table"),db_type:n,limit:s,range_from:a,range_to:f};e.ajax({type:"POST",url:i,data:s}).done(function(i){if(-1<i.indexOf("Database information missing!")||-1<i.indexOf("Db connection failed")||-1<i.indexOf("Db selection failed")||-1<i.indexOf("Db query failed"))cr&&(alert(i),alert("Playlist process failed, database query: "+r)),Zr&&Zr.remove(),Li.shift();else{Li.shift();i=e.parseJSON(i);var s=0,a=i.length,f;for(s;s<a;s++){f=i[s];if("database_data"==n){if(!(f.type&&f.mp3||f.path))continue;o=Wt(f)}else{if(!f.path)continue;o=Xt(f.path)}Zr?Zr.after(e(o)):0<ei.children().size()?e(o).prependTo(ei):e(o).appendTo(ei);Zr=e(o);u.push(e(o))}s=0;a=u.length;u.reverse();for(s;s<a;s++)Li.unshift(u[s]);u=null;t.remove()}j()}).fail(function(e,t,n){cr&&alert("Playlist process failed, database query: "+r);Zr&&Zr.remove();Li.shift();j()})}else"youtube_single"==n?(Ri=r,youtube_path="http://gdata.youtube.com/feeds/api/videos/"+r+"?v=2&format=5&alt=jsonc",Zr=t.data("toremove","true"),et(n,youtube_path)):"youtube_playlist"==n?(r.substr(0,2).toUpperCase(),Fi=r,Bi=1,youtube_path="http://gdata.youtube.com/feeds/api/playlists/"+Fi+"?start-index="+Bi+"&max-results=50&v=2&format=5&alt=jsonc",Zr=t.data("toremove","true"),et(n,youtube_path)):"ofm_single"==n?(Zr=t.data("toremove","true"),Yi=[],Yi.push({id:r,type:n}),Q()):"ofm_playlist"==n||"ofm_project"==n?(Zr=t.data("toremove","true"),Zi=n,es=r,Yi=[],ts=1,Z()):(cr&&alert("Invalid playlist data-type attribute!"),Li.shift(),j())}function I(){if(ki.length){var t,n,r=0,i=ki.length,s,o;for(r;r<i;r++)s=ki[r],t=e('<li class="playlistItem" data-type="'+s.type+'"data-mp3="'+s.mp3+'" data-ogg="'+s.ogg+'" data-thumb="'+s.thumb+'"></li>'),o=s.mp3,/\.(mp3)$/i.test(s.mp3)||(o+=".mp3"),Br&&t.addClass(Hr),s.url&&t.attr("data-plink",s.url),s.dlink&&(1!=s.dlink&&"true"!=s.dlink?t.attr("data-dlink",s.dlink):t.attr("data-dlink",o)),s.download&&(1!=s.download&&"true"!=s.download?t.attr("data-download",s.download):t.attr("data-download",o)),s.title&&t.attr("data-title",s.title),s.thumb&&("//"==s.thumb.substr(0,2)&&(s.thumb="http:"+s.thumb),t.attr("data-thumb",s.thumb)),s.length&&t.attr("data-length",s.length),"title"==br?n=e('<a class="playlistNonSelected" href="#">"'+s.title+'"</a>').appendTo(t):"thumb"==br?n=e('<a class="playlistNonSelected" href="#"><img src="'+s.thumb+'" alt="thumb"/></a>').appendTo(t):"all"==br&&(n=e('<a class="playlistNonSelected" href="#"></a>').appendTo(t),e('<span class="hap_thumb"><img src="'+s.thumb+'" alt="thumb"/></span>').appendTo(n),e('<span class="hap_title"><p>'+s.title+"</p></span>").appendTo(n)),Xr&&n.after(Xr),Zr?(Zr.after(t),"true"==Zr.data("toremove")&&Zr.remove()):t.appendTo(ei),Zr=t}Li.shift();j()}function q(){if(Or||Mr){var t=0;Zr=null;var n;Si.find("li[class*='playlistItem']").each(function(){n=e(this);Zr?Zr.after(n):Lr?n.appendTo(ei):ei.children().eq(Ar).before(n);Zr=n;t++});Si.empty()}R();Hn.css("opacity",1);$t||U();Zr=null;ti=!1;Tt();if(0<yi){if(Or||Mr){var r=is.getCounter();is.setPlaylistItems(yi,!1);Ar<=r&&(Lr||is.reSetCounter(r+t));_r&&(_r=!1,_())}else is.setPlaylistItems(yi),_();nr&&_t()}Mr=Or=!1;0==yi&&"undefined"!=typeof playlistEmpty&&playlistEmpty(Jt,Wn);"undefined"!=typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(Jt,Wn);Gr=!0}function R(){vi=[];gi=[];mi=[];if(0==ei.length)return cr&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),!1;var t=0,n,r,i=ei.find("li"),s=i.length,o,u,a,f,l,c,h,p,d,v;Yr=0;for(t;t<s;t++)r=e(i[t]).addClass(Pr),gi.push(r),Kr&&r.addClass(Qr),Yr="horizontal"==pr?Yr+r.outerWidth(!0):Yr+r.outerHeight(!0),n=r.find("a[class=playlistNonSelected]"),0==n.length&&(n=r.find("a[class=playlistSelected]")),n.unbind().bind("click",C).attr("data-id",t),mi.push(n),Sr&&!isMobile&&n.bind("mouseenter",function(t){if(!$t||ti)return!1;t||(t=window.event);t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();t=e(t.currentTarget).attr("data-id");var n=e(mi[t]),r=!1;is.getCounter()==t&&(r=!0);"undefined"!=typeof playlistItemRollover&&playlistItemRollover(Jt,Wn,n,t,r);return!1}).bind("mouseleave",function(t){if(!$t||ti)return!1;t||(t=window.event);t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();t=e(t.currentTarget).attr("data-id");var n=e(mi[t]),r=!1;is.getCounter()==t&&(r=!0);"undefined"!=typeof playlistItemRollout&&playlistItemRollout(Jt,Wn,n,t,r);return!1}),o="",void 0!=r.attr("data-title")?o=r.attr("data-title"):"title"==br?o=n.html():"thumb"!=br&&"all"==br&&(o=n.find("span[class=hap_title]").find("p").html()),ar&&(u=Pt(t)+fr+o,n.html(u)),r=e(gi[t]).attr({"data-id":t,"data-title":o}),a=u=c=l="",f=void 0,v=d=p=h=null,void 0!=r.attr("data-mp3")&&(l=r.attr("data-mp3")),void 0!=r.attr("data-ogg")&&(c=r.attr("data-ogg")),void 0!=r.attr("data-type")&&(u=r.attr("data-type")),void 0!=r.attr("data-origtype")&&(a=r.attr("data-origtype")),void 0==r.attr("data-length")||Ft(r.attr("data-length"))||(f=r.attr("data-length")),"youtube_single"==u||"youtube_playlist"==u?(void 0==r.attr("data-download")||Ft(r.attr("data-download"))||(h=r.attr("data-download")),void 0==r.attr("data-dlink")||Ft(r.attr("data-dlink"))||(p=r.attr("data-dlink"))):(void 0!=r.attr("data-download")&&(h=Ft(r.attr("data-download"))||"true"==r.attr("data-download")?l:r.attr("data-download")),void 0!=r.attr("data-dlink")&&(p=Ft(r.attr("data-dlink"))||"true"==r.attr("data-dlink")?l:r.attr("data-dlink"))),void 0==r.attr("data-plink")||Ft(r.attr("data-plink"))||(d=r.attr("data-plink")),void 0==r.attr("data-thumb")||Ft(r.attr("data-thumb"))||(v=r.attr("data-thumb")),Dr||(d&&0==r.find("a[class=plink]").length&&(d=e('<a class="plink" href="'+d+'" target="_blank"><img src="'+Nn+'" alt="purchase"/></a>'),n.after(d)),p&&0==r.find("a[class=dlink]").length&&(p=e('<a class="dlink" href="#" data-dlink="'+p+'"><img src="'+Cn+'" alt="download"/></a>'),n.after(p),Ft(r.attr("data-dlink"))),mr&&0==r.find("a[class=premove]").length&&(r=e('<a class="premove" href="#"><img src="'+kn+'" alt="remove"/></a>'),n.after(r))),vi.push({id:t,type:u,origtype:a,title:o,mp3:l,ogg:c,length:f,download:h,thumb:v});i=null;yi=vi.length;Dr||(z(),dr&&(ei.hasClass("ui-sortable")||ei.sortable({cursor:"move",update:function(e,t){R();0<yi&&is.setPlaylistItems(yi);var n=Hn.find("a[class=playlistSelected]").attr("data-id");n&&(is.reSetCounter(n),nr&&_t());1==yi&&_()},receive:function(e,t){"undefined"!=typeof dropReceive&&dropReceive(Jt,Wn)}})),hr&&("horizontal"==pr&&Hn.width(Yr),x(!0)));return!0}function U(){$t=!0;ti=!1;Tt();xt();"undefined"!=typeof audioPlayerSetupDone&&audioPlayerSetupDone(Jt,Wn);K()}function z(){var t=as?ss:"click";On.find("a[class=dlink]").unbind().bind(t,function(t){t.preventDefault();if(qr)return!1;var n=e(this);t=n.closest(".playlistItem");var r=t.attr("data-id");if(t.hasClass(Qr))return!1;if(void 0==t.attr("data-type")||Ft(t.attr("data-type")))return cr&&alert("Invalid data-type for file download function! Quitting."),qr=!1;t=t.attr("data-type");void 0==n.attr("data-dlink")||Ft(n.attr("data-dlink"))||(n=n.attr("data-dlink"),r=Dt(r,!1),t=W(t,r,n),X(t.name,t.path))});On.find("a[class=plink]").unbind().bind("click",function(t){if(e(this).closest(".playlistItem").hasClass(Qr))return!1});mr&&On.find("a[class=premove]").unbind().bind("click",function(t){t.preventDefault();t=e(this).closest(".playlistItem");var n=parseInt(t.attr("data-id"),10);if(t.hasClass(Qr))return!1;Jt.removeTrack(n)})}function W(e,t,n){"local"==e||"folder"==e?(n.indexOf("\\")&&(n=n.replace(/\\/g,"/")),n.match(/^http([s]?):\/\/.*/)||(e=window.location.href,e=e.substr(0,e.lastIndexOf("/")+1),/^\.\.\//i.test(n)&&(n=n.substr(3),"/"==e.charAt(e.length-1)&&(e=e.substr(0,e.lastIndexOf("/"))),e=e.substr(0,e.lastIndexOf("/")+1)),n=e+n),Yt||(t=0<n.lastIndexOf("/")?n.substr(n.lastIndexOf("/")+1):n)):"soundcloud"==e&&(n=n.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));t=t.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(t)||(t+=".mp3");return{name:t,path:n}}function X(e,t){if(Yt)if(qr=!0,vr)Fr||(Ir=J())&&(Fr=!0),Ir?V(Ir,e,t):qr=!1;else{var n=J();n?V(n,e,t):qr=!1}else Ei.attr("src","dl.php?path="+t+"&name="+e)}function V(t,n,r){e.ajax({type:"POST",url:"mail.php",data:"mail="+t+"&name="+n+"&path="+r}).done(function(e){qr=!1}).fail(function(e,t,n){cr&&alert("Send email error: "+e.responseText);$();qr=!1});Ci.css({marginTop:-Ci.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Ti&&clearTimeout(Ti);Ti=setTimeout($,Ni)}function $(){Ti&&clearTimeout(Ti);Ci.stop().animate({opacity:0},{duration:500,complete:function(){Ci.css("display","none")}})}function J(){for(var e=prompt("Please enter your email address where download link will be sent:"),t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!t.test(e)||Ft(e))&&null!=e;)e=prompt("Please enter a valid email address:");return e}function K(){e(".hap_text_link").each(function(){var t=e(this),n=t.attr("href");"undefined"!=typeof n&&!1!==n&&-1<n.toLowerCase().indexOf(".mp3")&&t.prepend('<img class="play_link" src="'+An+'"/>')});e(".hap_text_link, .hap_image_link").click(function(t){if(!$t)return!1;t=e(this);var n=t.attr("href");if("undefined"==typeof n||!1===n)return!1;if(Jr&&Jr==n)return N();O();is.reSetCounter();Jr=n;Vr=t;$r&&$r.attr("src",An);t.hasClass("hap_text_link")&&($r=t.find("img").attr("src",Ln));fi=Jr;li=fi.substr(0,fi.lastIndexOf("."))+".ogg";Xn=!0;Cr||"undefined"!=typeof ct(Ai)&&ct(Ai).pb_setAutoplay(!0);H();Et();return!1})}function Q(){Yi.length?G(Yi.shift()):(0==ki.length&&Zr&&"true"==Zr.data("toremove")&&Zr.remove(),ki.length>er&&(ki=ki.slice(0,er)),I())}function G(t){var n=t.id,r=t.type;e.ajax({url:"http://api.official.fm/tracks/"+n+"?fields=streaming,cover&api_version=2",dataType:"json",cache:!1}).done(function(e){var t={},n,i;e.track&&e.track.streaming&&e.track.streaming.http&&(e=e.track,t.type=r,t.length=e.duration?e.duration:null,t.mp3=e.streaming.http,t.ogg=e.streaming.http,n=e.artist?e.artist:"Official Fm artist",i=e.title?e.title:"Official Fm track",t.title=n+" - "+i,jr&&(t.url=jr),Rr&&(t.dlink=Rr),Ur&&(t.download=Ur),e.cover.urls.small?t.thumb=e.cover.urls.small:Wr&&(t.thumb=Wr),ki.push(t));Q()}).fail(function(e,t,r){cr&&alert("Playlist process failed, ofm: "+n);Q()})}function Y(){1<ns?(ts+=1,ts<=ns&&Yi.length<er?Z():Yi.length?Q():(Li.shift(),j())):Yi.length?Q():(0==ki.length&&Zr&&"true"==Zr.data("toremove")&&Zr.remove(),Li.shift(),j())}function Z(){e.ajax({url:"ofm_playlist"==Zi?"http://api.official.fm/playlists/"+es+"/tracks?api_version=2&page="+ts+"":"http://api.official.fm/projects/"+es+"/tracks?fields=cover&api_version=2&page="+ts+"",dataType:"json",cache:!1}).done(function(e){ns=e.total_pages;if(e.tracks&&e.tracks.length){var t=0,n=e.tracks.length,r;n>er&&(n=er);for(t;t<n;t++)r=e.tracks[t].track,r.url&&(r=r.url.substr(r.url.lastIndexOf("/")+1),r=r.substr(0,r.indexOf("?")),Yi.push({id:r,type:Zi}))}Y()}).fail(function(e,t,n){cr&&alert("Playlist process failed, ofm: "+es);Y()})}function et(t,n){e.ajax({url:n,dataType:"jsonp",success:function(e){if("youtube_single"==t){var n={};(e=e.data)?e.accessControl?(n.type="youtube_single",n.mp3=e.id,n.ogg="",n.title=e.title?e.title:"",n.description=e.description?e.description:"",e.thumbnail?n.thumb=e.thumbnail.hqDefault?e.thumbnail.hqDefault:e.thumbnail.sqDefault:Wr&&(n.thumb=Wr),jr&&(n.url=jr),Rr&&(n.dlink=Rr),Ur&&(n.download=Ur),ki.push(n),I()):(Li.shift(),j()):(cr&&alert("Playlist process failed, youtube single: "+Ri),Zr&&"true"==Zr.data("toremove")&&Zr.remove(),Li.shift(),j())}else if(e.error)cr&&alert("Playlist process failed, youtube playlist: "+Fi),Zr&&"true"==Zr.data("toremove")&&Zr.remove(),Li.shift(),j();else if(e.data.items){var n=e.data.items.length,r=0,i;for(r;r<n;r++)n>Zn&&(n=Zn),(i=e.data.items[r].video)&&i.accessControl&&(obj={type:"youtube_playlist"},obj.mp3=i.id,obj.ogg="",obj.title=i.title?i.title:"",obj.description=i.description?i.description:"",i.thumbnail?obj.thumb=i.thumbnail.hqDefault?i.thumbnail.hqDefault:i.thumbnail.sqDefault:Wr&&(obj.thumb=Wr),jr&&(obj.url=jr),Rr&&(obj.dlink=Rr),Ur&&(obj.download=Ur),ki.push(obj));Bi<=Zn?(Bi+=ji,e="http://gdata.youtube.com/feeds/api/playlists/"+Fi+"?start-index="+Bi+"&max-results=50&v=2&format=5&alt=jsonc",et("youtube_playlist",e)):(ki.length>Zn&&(ki=ki.slice(0,Zn)),I())}else ki.length>Zn&&(ki=ki.slice(0,Zn)),I()},error:function(e){cr&&alert("Playlist process failed, youtube: "+n);Zr&&"true"==Zr.data("toremove")&&Zr.remove();Li.shift();j()}})}function tt(){Ii?isMobile?Ki?Hi.initVideo(fi):($t=!1,Gi=!0,nt("on")):Hi.initVideo(fi):(Ui=0==On.find("div[class='youtubeIframeMain']").length?e("<div/>").css({display:"block",left:"-10000px"}).addClass("youtubeIframeMain").appendTo(On):On.find("div[class='youtubeIframeMain']"),Hi=e.youtubePlayer({parent:Jt,autoPlay:$n,defaultVolume:hs,mediaPath:fi,youtubeHolder:Ui,youtubeChromeless:qi,isMobile:isMobile,initialAutoplay:Vn,quality:Wi}),e(Hi).bind("ap_YoutubePlayer.YT_READY",function(){Qi||Ui.css("left","-10000px");Ji=!0}),e(Hi).bind("ap_YoutubePlayer.START_PLAY",function(){pi&&clearInterval(pi);pi=setInterval(mt,hi);Gi&&(Hi.stop(),Hi.initVideo(fi),Gi=!1);!Ki&&isMobile&&(nt("off"),$t=Ki=!0)}),e(Hi).bind("ap_YoutubePlayer.END_PLAY",function(){yt()}),e(Hi).bind("ap_YoutubePlayer.STATE_PLAYING",function(){bt()}),e(Hi).bind("ap_YoutubePlayer.STATE_PAUSED",function(){isMobile?"iPhone"==en||"iPod"==en?ci&&(ci=!1,Lt("off")):wt():wt()}),Ii=!0);ai=$i=!0}function nt(e){"on"==e?(Qi=!0,Ui.css({top:"0px",left:"0px"})):(Ui.css("left","-10000px"),Qi=null)}function rt(){var e=zi.substr(1);embedFlashMain(e);e=Ai.substr(1);embedFlashAudio(e);"undefined"!=typeof ct(zi)?Vi=setInterval(it,Xi):(cr&&alert("Problems with flash initialization (startFlashInit)! Flash for youtube not initialized! Sound_id: "+Wn),st())}function it(){void 0!=ct(zi).setData&&(Vi&&clearInterval(Vi),ct(zi).setData(t),On.find(".flashMain").css("left","-10000px"),st())}function st(){"undefined"!=typeof ct(Ai)?Vi=setInterval(ut,Xi):(cr&&alert("Problems with flash initialization (checkFlashSound)! Flash audio backup not initialized! Sound_id: "+Wn),ft())}function ot(){var e=Ai.substr(1);embedFlashAudio(e);var t=setTimeout(function(){t&&clearTimeout(t);"undefined"!=typeof ct(Ai)?Vi=setInterval(at,Xi):(cr&&alert("Problems with flash initialization (checkFlashSound_b)! Flash audio backup not initialized! Sound_id: "+Wn),St())},500)}function ut(){void 0!=ct(Ai).setData&&(Vi&&clearInterval(Vi),ct(Ai).setData(t),On.find(".flashAudio").css("left","-10000px"),ft())}function at(){void 0!=ct(Ai).setData&&(Vi&&clearInterval(Vi),ct(Ai).setData(t),On.find(".flashAudio").css("left","-10000px"),St())}function ft(){if(Mn){var t=Oi.substr(1);embedFlashCircle(t);"undefined"!=typeof ct(Oi)?Vi=setInterval(lt,Xi):(cr&&alert
("Problems with flash initialization (checkFlashCircle)! Flash circle backup (canvas support is false) not initialized! Sound_id: "+Wn),St())}else e(".circleMain").remove(),St()}function lt(){void 0!=ct(Oi).setData&&(Vi&&clearInterval(Vi),ct(Oi).setData(Is),St())}function ct(e){"#"==e.charAt(0)&&(e=e.substr(1));return-1!=navigator.appName.indexOf("Microsoft")?window[e]:document[e]}function ht(t){if(Ft(Qn))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),Li.shift(),j(),!1;/\/likes$/.test(t)&&(t=t.replace(/\/likes$/,"/favorites"));var n=dt(t,Qn);e.ajax({url:n,dataType:"jsonp",cache:!1}).done(function(n){var r,i;if(n.tracks){r=n.tracks.length;r>Gn&&(r=Gn);for(i=0;i<r;i++)n.tracks[i].streamable&&n.tracks[i].stream_url?ki.push(pt(n.tracks[i])):(r+=1,r>n.tracks.length&&(r=n.tracks.length));ki.length>Gn&&(ki=ki.slice(0,Gn));I()}else if(n.duration)n.permalink_url=t,n.streamable&&n.stream_url&&ki.push(pt(n)),ki.length>Gn&&(ki=ki.slice(0,Gn)),I();else if(n.username)ii=/likes/.test(t)?n.uri+"/likes":/favorites/.test(t)?n.uri+"/favorites":n.uri+"/tracks",ht(ii);else if(e.isArray(n)){r=n.length;r>Gn&&(r=Gn);for(i=0;i<r;i++)n[i].streamable&&n[i].stream_url?ki.push(pt(n[i])):(r+=1,r>n.length&&(r=n.length));r==oi?(si+=oi,si<Gn?ht(ii):(ki.length>Gn&&(ki=ki.slice(0,Gn)),I())):(ki.length>Gn&&(ki=ki.slice(0,Gn)),I())}else n.kind&&"group"==n.kind?(ii=n.uri+"/tracks",ht(ii)):(Li.shift(),j())}).fail(function(e,n,r){cr&&alert("Playlist process failed, soundcloud: "+t);Li.shift();j()})}function pt(e){var t={type:"soundcloud"};e.duration&&(t.length=e.duration);t.mp3=e.stream_url+(/\?/.test(e.stream_url)?"&":"?")+"consumer_key="+Qn;t.ogg="";t.title=e.title;jr&&(t.url=jr);e.downloadable&&e.download_url?(Rr&&(t.dlink=Rr),Ur&&(t.download=Ur)):(Rr&&1!=Rr&&"true"!=Rr&&(t.dlink=Rr),Ur&&1!=Ur&&"true"!=Ur&&(t.download=Ur));e.artwork_url?t.thumb=e.artwork_url:Wr&&(t.thumb=Wr);return t}function dt(e,t){return(/api\./.test(e)?e+"?":"http://api.soundcloud.com/resolve?url="+e+"&")+"format=json&offset="+si+"&consumer_key="+t+"&callback=?"}function vt(){var e=ki[kr].mp3;ID3.loadTags(e,function(){var t=ID3.getAllTags(e);t.title&&(ki[kr].title=t.title);t.artist&&(ki[kr].artist=t.artist);t.album&&(ki[kr].album=t.album);if(t=t.picture){var n="",r=0,i=t.data.length;for(r;r<i;r++)n+=String.fromCharCode(t.data[r]);ki[kr].thumb="data:"+t.format+";base64,"+_win.btoa(n)}kr++;kr<ki.length?vt():I()},{tags:["title","artist","album","picture"]})}function mt(){if(on){var e=Hi.getCurrentTime(),t=Hi.getDuration();di=Hi.getVideoBytesLoaded()/Hi.getVideoBytesTotal();isNaN(e)||isNaN(t)?ni=!0:(ni=!1,Bn.html(Ot(e)+sr),jn.html(Mt(t)),Mn)?_n&&(isNaN(di)||w(di),eo=e/t,!ks&&ci&&(Ds||b(e/t))):(isNaN(di)||As.width(di*_s),ks||Os.width(e/t*_s))}}function gt(){var e=Di.currentTime,t=Di.duration;void 0==Di.buffered||0==Di.buffered.length||isNaN(t)||(di=Di.buffered.end(0)/t);isNaN(e)||isNaN(t)||(Bn&&Bn.html(Ot(e)+sr),jn&&jn.html(Mt(t)));if(Mn)_n&&(isNaN(di)||w(di),isNaN(e)||isNaN(t)||(eo=e/t,!ks&&ci&&b(e/t)));else{if(!isNaN(di)){var n=di*_s;n>_s&&(n=_s);As&&As.width(n)}isNaN(e)||isNaN(t)||!ks&&Os&&Os.width(e/t*_s)}}function yt(){"undefined"!=typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(Jt,Wn,is.getCounter());O();is.advanceHandler(1,!0)}function bt(){ri||("undefined"!=typeof audioPlayerSoundStart&&audioPlayerSoundStart(Jt,Wn,is.getCounter()),ri=!0);"undefined"!=typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(Jt,Wn,is.getCounter());Mn&&_n&&E()}function wt(){"undefined"!=typeof audioPlayerSoundPause&&audioPlayerSoundPause(Jt,Wn,is.getCounter())}function Et(){if("youtube_single"==ui||"youtube_playlist"==ui)on?(tt(),isMobile&&!Ki&&Xn&&($t=!1,nt("on"))):("undefined"!=typeof ct(zi)&&(ct(zi).pb_play(fi,0,100,100,"youtube",Xn),ai=!0),$i=Ji=!0);else if(Cr){if(Mi)rn?Di.src=fi:sn&&(Di.src=li),Di.load(),Di.play();else{var e="",e=Jn?e+'<audio class="hap_audio_cont" preload="auto">':e+'<audio class="hap_audio_cont" preload="none">',e=e+('<source src="'+fi+'" type="audio/mpeg" />'),e=e+('<source src="'+li+'" type="audio/ogg" />');Pi.html(e+"</audio>");_i=Pi.find(".hap_audio_cont");Di=_i[0];Di.volume=hs;Xn&&(Di.load(),Di.play());Mi=!0}_i.bind("ended",function(e){yt()}).bind("pause",function(e){wt()}).bind("play",function(e){pi&&clearInterval(pi);pi=setInterval(gt,hi);bt()}).bind("canplay",function(e){Cs&&(Di.seekable&&0<Di.seekable.length&&(Di.currentTime=Cs*Di.duration),Cs=null)}).bind("canplaythrough",function(e){}).bind("loadedmetadata",function(e){}).bind("error",function(e){}).bind("abort",function(e){}).bind("stalled",function(e){}).bind("suspend",function(e){});pi&&clearInterval(pi);pi=setInterval(gt,hi)}else"undefined"!=typeof ct(Ai)&&ct(Ai).pb_initAudio(fi);Xn?(ci=!0,At("off")):(ci=!1,Lt("off"));o();"youtube_single"!=ui&&"youtube_playlist"!=ui&&(ai=!0);Xn=!0;!isMobile&&Hi&&Hi.setAutoPlay(!0)}function St(){var t=[On.find(".controls_next"),On.find(".controls_prev"),On.find(".controls_toggle"),On.find(".player_volume"),On.find(".player_download"),On.find(".player_loop"),On.find(".player_shuffle")],n,r=t.length,i=0;for(i;i<r;i++)n=e(t[i]).css("cursor","pointer").bind(ss,k),Er&&!isMobile&&n.bind("mouseover",L).bind("mouseout",A);lr?B(lr):$t||U()}function xt(){if(!Mn&&(_s=Ls.width(),!isNaN(di)&&As&&As.width(di*_s),!ks&&Os)){var e,t;if("youtube_single"!=ui&&"youtube_playlist"!=ui){if(Cr)Di&&(e=Di.currentTime,t=Di.duration);else if("undefined"!=typeof ct(Ai))try{e=ct(Ai).pb_getFlashPosition,t=ct(Ai).pb_getFlashDuration()}catch(n){}try{e&&!isNaN(e)&&t&&!isNaN(t)&&Os.width(e/t*_s)}catch(r){}}}hr&&!Dr&&x();tr&&rs&&rs.checkSize()}function Tt(){Rn.css("display","none")}function Nt(){Rn.css("display","block")}function Ct(){pi&&clearInterval(pi);tr&&rs&&rs.deactivate();In.html(ur);Bn.html(Tr+sr);jn.html(Nr);Mn?_n&&(eo=0,zs.clearRect(0,0,$s,Js),Ws.clearRect(0,0,$s,Js)):(Os.width(0),As.width(0));Lt("off");Un.css("display","none")}function kt(){pi&&clearInterval(pi);nr||(tr&&rs&&rs.deactivate(),In.html(ur));Bn.html(Tr+sr);jn.html(Nr);Mn?_n&&(eo=0,zs.clearRect(0,0,$s,Js),Ws.clearRect(0,0,$s,Js)):(Os.width(0),As.width(0));Lt("off");Un.css("display","none")}function Lt(e){"on"==e?On.find(".controls_toggle").find("img").attr("src",hn):On.find(".controls_toggle").find("img").attr("src",cn);$r&&$r.hasClass("play_link")&&$r.attr("src",An);Mn&&(_n?(zs.clearRect(0,0,$s,Js),b(eo),E()):"undefined"!=typeof ct(Oi)&&ct(Oi).pb_toggle_icon("play"))}function At(e){"on"==e?On.find(".controls_toggle").find("img").attr("src",dn):On.find(".controls_toggle").find("img").attr("src",pn);$r&&$r.hasClass("play_link")&&Vr.hasClass("hap_text_link")&&$r.attr("src",Ln);Mn&&(_n?(zs.clearRect(0,0,$s,Js),b(eo),E()):"undefined"!=typeof ct(Oi)&&ct(Oi).pb_toggle_icon("pause"))}function Ot(e){e=Math.round(e);minutes=Math.floor(e/60);minutes=10<=minutes?minutes:"0"+minutes;e=Math.floor(e%60);return minutes+":"+(10<=e?e:"0"+e)}function Mt(e){e=Math.round(e);minutes=Math.floor(e/60);minutes=10<=minutes?minutes:"0"+minutes;e=Math.floor(e%60);return minutes+":"+(10<=e?e:"0"+e)}function _t(e){if("string"==typeof e){if(ar&&is&&-1!=is.getCounter()){var t=is.getCounter();e=Pt(vi[t].id)+fr+e}}else{if("number"==typeof e){if(!is||0>e||e>yi-1)return!1}else if(!is)return!1;t=is.getCounter();e=Dt(t)}tr&&rs?(rs.input(e),rs.activate()):In&&In.html(e)}function Dt(e,t){if("undefined"==typeof t||null===t)t=!0;return vi[e]&&vi[e].title&&!Ft(vi[e].title)?t?ar?Pt(vi[e].id)+fr+vi[e].title:vi[e].title:vi[e].title:ur}function Pt(e){return 9>e?"0"+(e+1):e+1}function Ht(e){var t=[],n=[],r=0;for(r;r<e;r++)t[r]=r;var r=0,i;for(r;r<e;r++)i=Math.round(Math.random()*(t.length-1)),n[r]=t[i],t.splice(i,1);return n}function Bt(e){var t=[],n=0;for(n;n<e;n++)t[n]=n;return t}function jt(e,t,n){"title"==t?e.sort(function(e,t){return e.title==t.title?0:e.title<t.title?-1:1}):"type"==t&&e.sort(function(e,t){return e.type==t.type?0:e.type<t.type?-1:1});n&&e.reverse()}function Ft(e){return e?0==e.replace(/^\s+|\s+$/g,"").length:!0}function It(e){e=e.split(":");for(var t=0,n=1;0<e.length;)t+=n*parseInt(e.pop()),n*=60;return t}function qt(e){if(window.ActiveXObject&&window.GetObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.loadXML(e);return t}if(window.DOMParser)return(new DOMParser).parseFromString(e,"text/xml");throw Error("No XML parser available")}function Rt(e,t){return t-e}function Ut(e){if("string"==typeof e)switch(e.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}else if("boolean"==typeof e)return Boolean(e)}function zt(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}function Wt(t){var n,r="",i,s="",o="",u="",a,f,l,c;n=t.type.toLowerCase();t.origtype&&(r=t.origtype.toLowerCase());t.mp3?i=t.mp3:t.path&&(i=t.path);t.ogg&&(s=t.ogg);t.title&&(o=t.title);t.thumb&&(u=t.thumb);t.download&&("youtube_single"==n||"youtube_playlist"==n?1==t.download||"true"==t.download||Ft(t.download)||(a=t.download):a=1==t.download?i:t.download);t.url&&(l=t.url);t.dlink&&("youtube_single"==n||"youtube_playlist"==n?1==t.dlink||"true"==t.dlink||Ft(t.dlink)||(f=t.dlink):f=1==t.dlink?i:t.dlink);"local"==n?"title"==br?c="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'>"+o+"</a></li>":"thumb"==br?c="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'><img src='"+u+"' alt='thumb'/></a></li>":"all"==br&&(c="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+u+"' alt='thumb'/></span><span class='hap_title'><p>'"+o+"'</p></span></a></li>"):(c="<li class= 'playlistItem' data-type='"+n+"' data-path='"+i+"' data-thumb='"+u+"'></li>","database_data"==n&&(i=t.table?t.table:null,r=t.limit?t.limit:null,t=t.range?t.range:null,i&&(i=' data-table="'+i+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index)),r&&(i=' data-limit="'+r+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index)),t&&(i=' data-range="'+t+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index))));a&&(i=' data-download="'+a+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index));"local"==n?(f&&(i="<a class='dlink' href='#' data-dlink='"+f+"'><img src='"+Cn+"' alt='download'/></a>",s=c.match(/\<\/a\>\<\/li\>/),c=c.slice(0,s.index)+i+c.slice(s.index)),l&&(i="<a class='plink' href='"+l+"' target='_blank'><img src='"+Nn+"' alt='purchase'/></a>",s=c.match(/\<\/a\>\<\/li\>/),c=c.slice(0,s.index)+i+c.slice(s.index))):(f&&(i=' data-dlink="'+f+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index)),l&&(i=' data-plink="'+l+'" ',s=c.match(/\>/),c=c.slice(0,s.index)+i+c.slice(s.index)));n=document.createElement("ul");n.innerHTML=c;return e(n.firstChild)}function Xt(t){t=e(t);var n;t=e("<div>").append(t.clone()).html();n=document.createElement("ul");n.innerHTML=t;return e(n.firstChild)}function Vt(e){yi=vi.length;if(0<yi){R();var t=is.getCounter();e==t?(D(),is.setPlaylistItems(yi)):(is.setPlaylistItems(yi,!1),e<t&&is.reSetCounter(is.getCounter()-1));nr&&_t()}else P(),lr=null,"undefined"!=typeof playlistEmpty&&playlistEmpty(Jt,Wn)}var $t=!1,Jt=this;e("body");var Kt=e(window),Qt=e(document),Gt,Yt=!1,Zt=navigator.userAgent,en;if(-1<Zt.indexOf("iPhone")||-1<Zt.indexOf("iPod")||-1<Zt.indexOf("iPad"))Yt=!0,-1<Zt.indexOf("iPhone")?en="iPhone":-1<Zt.indexOf("iPod")?en="iPod":-1<Zt.indexOf("iPad")&&(en="iPad");var tn=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),nn=document.createElement("audio"),rn,sn,on=!1;nn.canPlayType?(on=!0,rn=!!nn.canPlayType&&""!=nn.canPlayType("audio/mpeg"),sn=!!nn.canPlayType&&""!=nn.canPlayType('audio/ogg; codecs="vorbis"')):(rn=!0,sn=!1);var un=hap_source_path+t.buttonsUrl.prev,an=hap_source_path+t.buttonsUrl.prevOn,fn=hap_source_path+t.buttonsUrl.next,ln=hap_source_path+t.buttonsUrl.nextOn,cn=hap_source_path+t.buttonsUrl.play,hn=hap_source_path+t.buttonsUrl.playOn,pn=hap_source_path+t.buttonsUrl.pause,dn=hap_source_path+t.buttonsUrl.pauseOn,vn=hap_source_path+t.buttonsUrl.loop,mn=hap_source_path+t.buttonsUrl.loopOn,gn=hap_source_path+t.buttonsUrl.volume,yn=hap_source_path+t.buttonsUrl.volumeOn,bn=hap_source_path+t.buttonsUrl.mute,wn=hap_source_path+t.buttonsUrl.muteOn,En=hap_source_path+t.buttonsUrl.shuffle,Sn=hap_source_path+t.buttonsUrl.shuffleOn,xn=hap_source_path+t.buttonsUrl.download,Tn=hap_source_path+t.buttonsUrl.downloadOn,Nn=hap_source_path+t.buttonsUrl.trackUrlIcon,Cn=hap_source_path+t.buttonsUrl.trackDownloadIcon,kn=hap_source_path+t.buttonsUrl.trackRemoveIcon,Ln=hap_source_path+t.buttonsUrl.link_pause,An=hap_source_path+t.buttonsUrl.link_play,On=e(this),Mn=On.hasClass("hap_circle"),_n=!1;on&&zt()&&(_n=!0);var Dn="html5audio-popup"==On.attr("id"),Pn=On.find(".playlistHolder"),Hn=On.find(".playlist_inner").css("opacity",0);On.find(".playerHolder");On.find(".player_mediaTime");var Bn=On.find(".player_mediaTime_current"),jn=On.find(".player_mediaTime_total"),Fn=On.find(".player_mediaName_Mask"),In=On.find(".player_mediaName");On.find(".player_controls");var qn=On.find(".player_volume"),Rn=On.find(".preloader"),Un=On.find(".player_download");On.find(".componentPlaylist");var zn=e(t.playlistList);Dn&&window.opener&&(zn=window.opener.jQuery(t.playlistList));var Wn=t.sound_id,Xn=t.autoPlay,Vn=t.autoPlay,$n=t.autoPlay,Jn=t.autoLoad;isMobile&&(Xn=!1,$n=t.autoPlay=!1);var Kn=t.useOnlyMp3Format,Qn=t.soundcloudApiKey,Gn=t.soundcloud_result_limit,Yn=t.podcast_result_limit,Zn=t.yt_playlist_result_limit,er=t.ofm_result_limit,tr=t.useSongNameScroll,nr=t.autoSetSongTitle,rr=t.loopingOn,ir=t.randomPlay,sr=t.mediaTimeSeparator,or=t.seekTooltipSeparator,ur=t.defaultArtistData,ar=t.useNumbersInPlaylist,fr=t.titleSeparator,lr=t.activePlaylist,cr=t.useAlertMessaging,hr=t.activatePlaylistScroll,pr=t.playlistScrollOrientation.toLowerCase(),dr=t.sortablePlaylistItems,vr=t.autoReuseMailForDownload,mr=t.useRemoveBtnInTracks,gr=t.useVolumeTooltip,yr=t.useSeekbarTooltip,br=t.playlistItemContent.toLowerCase(),wr=t.useKeyboardNavigation,Er=t.useBtnRollovers,Sr=t.usePlaylistRollovers,xr=t.getTrackInfoFromID3;Bn.html("0:00");jn.html("0:00");var Tr=Bn.html(),Nr=jn.html();In.html(ur);Bn.html(Tr+sr);jn.html(Nr);var Cr=!0;if(!on||!rn&&Kn)Cr=!1;var kr,Lr,Ar,Or,Mr,_r,Dr=!1,Pr="hap_processed",Hr="hap_draggable",Br,jr,Fr,Ir,qr,Rr,Ur,zr,Wr,Xr,Vr,$r,Jr,Kr=!1;void 0!=Pn.attr("data-playlistLocked")&&(Kr=!0);var Qr="playlist_locked",Gr=!1,Yr,Zr,ei=null,ti=!0,ni=!1,ri=!1,ii,si,oi=50,ui,ai=!1,fi="",li="",ci=!1,hi=250,pi,di;rr&&On.find(".player_loop").find("img").attr("src",mn);ir&&On.find(".player_shuffle").find("img").attr("src",Sn);var vi=[],mi=[],gi=[],yi=0,bi,wi=0==On.find("div[id='feedParser']").length?e('<div id="feedParser"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(On):On.find("div[id='feedParser']"),Ei=0==On.find("iframe[id='dl_iframe']").length?e('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(On):On.find("iframe[id='dl_iframe']"),Si=e("<div/>"),xi=e("<div/>");if(Yt)var Ti,Ni=3e3,Ci=0==Pn.find("div[id='download_confirm']").length?e('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').addClass("download_confirm").css({opacity:0,zIndex:1e3}).appendTo(Pn):Pn.find("div[id='download_confirm']");var ki=[],Li=[],Ai=t.flashAudio,Oi=t.circleMain;if(Cr)var Mi=!1,_i,Di,Pi=0==On.find("div[id='hap_audioHolder']").length?e('<div id="hap_audioHolder"/>').css({position:"absolute",left:"-10000px"}).appendTo(On):On.find("div[id='hap_audioHolder']");var Hi,Bi,ji=50,Fi,Ii=!1,qi=!1,Ri,Ui,zi=t.flashYoutube,Wi=!1,Xi=100,Vi,$i=!1,Ji=!1,Ki=!1,Qi,Gi=!1,Yi=[],Zi,es,ts,ns,rs;tr&&n();var is=e.playlistManager({randomPlay:ir,loopingOn:rr});e(is).bind("ap_PlaylistManager.COUNTER_READY",function(){var e=is.getCounter(),t=vi[e];t&&!Kr&&(M(),nr&&_t(),ui=t.origtype?t.origtype:t.type,fi=t.mp3,li=t.ogg,t.download?zr=!0:zr=null,H(),Et(),"undefined"!=typeof itemTriggered&&itemTriggered(Jt,Wn,e))});e(is).bind("ap_PlaylistManager.PLAYLIST_END",function(){M();"undefined"!=typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(Jt,Wn);ci=!1;Lt("off")});e(is).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!=typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(Jt,Wn)});var ss="",os="",us="",as;"ontouchstart"in window?(as=!0,ss="touchstart.ap",os="touchmove.ap",us="touchend.ap"):(as=!1,ss="mousedown.ap",os="mousemove.ap",us="mouseup.ap");var fs=!1,ls,cs=!1,hs=t.defaultVolume;0>hs&&(hs=0);0==hs?ls=.5:1<hs&&(hs=1);var ps=On.find(".volume_seekbar").css("cursor","pointer").bind(ss,function(e){r(e);return cs=!1}),ds="horizontal";void 0!=ps.attr("data-orientation")&&(ds=ps.attr("data-orientation").toLowerCase());if(void 0!=ps.attr("data-autoHide")){var fs=!0,vs=!1,ms,gs=parseInt(ps.attr("data-autoHide"),10),ys=function(){ms&&clearTimeout(ms);ps.css("display","none");vs=!1};isMobile||qn.bind("mouseover",function(){if(!$t)return!1;ms&&clearTimeout(ms);ps.css("display","block");vs=!0;return!1}).bind("mouseout",function(){if(!$t)return!1;ms&&clearTimeout(ms);ms=setTimeout(ys,gs);return!1})}var bs=!1,ws=On.find(".volume_bg");if("horizontal"==ds)var Es=ws.width(),Ss=On.find(".volume_level").css("width",hs*Es+"px");else Es=ws.height(),Ss=On.find(".volume_level").css("height",hs*Es+"px");if(gr&&!isMobile){ps.bind("mouseover",u);var xs=On.find(".player_volume_tooltip"),Ts=parseInt(xs.css("top"),10);xs.bind("mouseenter",function(){ps.unbind("mouseover",u);xs.css("display","none")}).bind("mouseleave",function(){ps.bind("mouseover",u)})}else On.find(".player_volume_tooltip").remove();var Ns,Cs,ks=!1,Ls=On.find(".progress_bg"),As=On.find(".load_progress"),Os=On.find(".play_progress"),Ms=On.find(".player_progress"),_s=Ls.width(),Ds=!1;if(Mn){var Ps=On.find(".load_canvas").css("cursor","pointer"),Hs=On.find(".play_canvas"),Bs=On.find(".circlePlayer"),js=parseFloat(Bs.attr("data-offOpacity"),10),Fs=parseFloat(Bs.attr("data-onOpacity"),10);isMobile&&(js=Fs=1);var Is={flash_id:t.flash_id,strokeSize:parseInt(Bs.attr("data-strokeSize"),10),play_color:Hs.attr("data-bgcolor"),load_color:Ps.attr("data-bgcolor"),tolerance:parseInt(Bs.attr("data-tolerance"),10),offOpacity:js,onOpacity:Fs,circleWidth:Ps.width(),circleHeight:Ps.height()};if(_n){var qs=Is.strokeSize,Rs=Is.play_color,Us=Is.load_color,zs=Ps[0].getContext("2d"),Ws=Hs[0].getContext("2d"),Xs=2*Math.PI,Vs=Math.PI/2,$s=Is.circleWidth,Js=Is.circleHeight,Ks=$s/2,Qs=Ks-qs,Gs=t.tolerance,Ys,Zs=!1,eo=0;Ps.bind(ss,function(e){Zs=S(e)?!1:!0;l(e);return!1});Ms=Ps}else Ps.remove(),Hs.remove()}else Ms=On.find(".player_progress").css("cursor","pointer").bind(ss,function(e){l(e);return!1});if(yr&&!isMobile){Ms.bind("mouseover",d);var to=On.find(".player_progress_tooltip").css("zIndex",50);to.find("p").html("0:00"+or+"0:00");to.bind("mouseenter",function(){Ms.unbind("mouseover",d);to.css("display","none")}).bind("mouseleave",function(){Ms.bind("mouseover",d)})}else On.find(".player_progress_tooltip").remove();this.flashVideoPause=function(){Lt("off");ci=!1;wt()};this.flashVideoResume=function(){At("off");ci=!0;bt()};this.flashVideoEnd=function(){yt()};this.flashVideoStart=function(){At("off");ai=ci=!0;bt()};this.flashYoutubeData=function(e,t,n,r){Mn?(isNaN(e)||isNaN(t)||"undefined"!=typeof ct(Oi)&&ct(Oi).pb_drawLoadbar(e/t),isNaN(n)||isNaN(r)||(eo=n/r,ks||"undefined"!=typeof ct(Oi)&&ct(Oi).pb_drawSeekbar(n/r))):(isNaN(e)||isNaN(t)||As&&As.width(e/t*_s),isNaN(n)||isNaN(r)||Os&&Os.width(n/r*_s));isNaN(n)||isNaN(r)||(Bn&&Bn.html(Ot(n)+sr),jn&&jn.html(Mt(r)))};this.flashAudioData=function(e,t,n,r){e/=t;Mn?_n?(isNaN(e)||w(e),isNaN(n)||isNaN(r)||(eo=n/r,!ks&&ci&&b(n/r))):(null!==e&&"undefined"!=typeof ct(Oi)&&ct(Oi).pb_drawLoadbar(e),isNaN(n)||isNaN(r)||(eo=n/r,ks||"undefined"!=typeof ct(Oi)&&ct(Oi).pb_drawSeekbar(n/r))):(!ks&&Os&&Os.width(n/r*_s),null!==e&&(e*=_s,e>_s&&(e=_s),As&&As.width(e)),isNaN(n)||isNaN(r)||(Bn&&Bn.html(Ot(n)+sr),jn&&jn.html(Mt(r))))};this.flashAudioEnd=function(){yt()};this.flashCircleToggle=function(e){N()};this.flashCircleOverLoader=function(e){to.css("display","block");y(e)};this.flashCircleOutLoader=function(){to.css("display","none")};this.flashCircleSeek=function(e){p(e)};this.embedFlash=function(){if(on)t.useOnlyMp3Format&&!rn&&(e=Ai.substr(1),embedFlashAudio(e));else{var e=zi.substr(1);embedFlashMain(e);e=Ai.substr(1);embedFlashAudio(e);Mn&&(e=Oi.substr(1),embedFlashCircle(e))}};wr&&Qt.keyup(function(e){if(!$t||ti)return!1;e||(e=window.event);e.cancelBubble?e.cancelBubble=!0:e.stopPropagation&&e.stopPropagation();e=e.keyCode;37==e?Jt.previousAudio():39==e?Jt.nextAudio():32==e?Jt.toggleAudio():77==e&&(s(),o());return!1});Kt.resize(function(){if(!$t||ti)return!1;Gt&&clearTimeout(Gt);Gt=setTimeout(xt,150)});this.setPlayIcon=function(){$r&&$r.hasClass("play_link")&&$r.attr("src",An);ci=!1};this.playAudio=function(){if(!$t||ti||!ei||ci||!ai)return!1;if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?Hi.togglePlayback():"undefined"!=typeof ct(zi)&&ct(zi).pb_togglePlayback()}else Cr?Di&&Di.play():"undefined"!=typeof ct(Ai)&&ct(Ai).pb_play();At("off");ai=ci=!0};this.pauseAudio=function(){if(!$t||ti||!ei||!ci||!ai)return!1;if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?Hi.togglePlayback():"undefined"!=typeof ct(zi)&&ct(zi).pb_togglePlayback()}else Cr?Di&&Di.pause():"undefined"!=typeof ct(Ai)&&ct(Ai).pb_pause();Lt("off");ci=!1};this.toggleAudio=function(){if(!$t||ti||!ei||!ai)return!1;N()};this.stopAudio=function(){if(!$t||ti||!ei||!ai)return!1;if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?Hi.stop():"undefined"!=typeof ct(zi)&&ct(zi).pb_dispose()}else Cr?Di&&(Di.src="",rn?Di.src=fi:sn&&(Di.src=li)):"undefined"!=typeof ct(Ai)&&ct(Ai).pb_dispose();kt();ci=!1};this.checkAudio=function(e){if(!$t||ti||!ei)return!1;e=e.toLowerCase();if(ci){if("pause"==e)if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;on?Hi.togglePlayback():"undefined"!=typeof ct(zi)&&ct(zi).pb_togglePlayback()}else Cr?Di&&Di.pause():"undefined"!=typeof ct(Ai)&&ct(Ai).pb_pause();else if("stop"==e){if("youtube_single"==ui||"youtube_playlist"==ui){if(!Ji)return!1;Hi.stop()}else Cr?Di&&(Di.src="",rn?Di.src=fi:sn&&(Di.src=li)):"undefined"!=typeof ct(Ai)&&ct(Ai).pb_dispose();kt()}ci=!1;Lt("off")}};this.nextAudio=function(){if(!$t||ti||!ei)return!1;O();is.advanceHandler(1,!0)};this.previousAudio=function(){if(!$t||ti||!ei)return!1;O();is.advanceHandler(-1,!0)};this.loadAudio=function(e){if(!$t||ti||!ei)return!1;if("string"==typeof e){var t=0,n=!1;for(t;t<yi;t++)if(e==vi[t].title){e=t;n=!0;break}if(!n)return cr&&alert('Track with name "'+e+'" doesnt exist. Load audio failed.'),!1}else{if("number"!=typeof e)return cr&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;if(0>e||e>yi-1)return cr&&alert('Invalid track number. Track number "'+e+'" doesnt exist. Load audio failed.'),!1}O();is.processPlaylistRequest(e)};this.loadPlaylist=function(e){if(!$t||ti)return!1;if("undefined"==typeof e)return cr&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1;lr=e;B(lr)};this.addTrack=function(t,n,r,i){if(!$t||ti)return!1;if("undefined"==typeof t)return cr&&alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"==typeof n)return cr&&alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"==typeof r)return cr&&alert("addTrack method requires track parameter. AddTrack failed."),!1;var s=1,o=!1;if("string"!=typeof r&&"[object Object]"!==Object.prototype.toString.call(r)){if("[object Array]"!==Object.prototype.toString.call(r))return cr&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;s=r.length,o=!0}Ar=i;t=t.toLowerCase();"visible"==t?(ei&&Dr&&P(),Or=!0,Dr=!1):(ei&&!Dr&&P(),Dr=Mr=!0);Lr=!1;if(ei)if("undefined"!=typeof Ar){if(0>Ar||Ar>yi)return cr&&alert('Invalid position to insert track to. Position number "'+i+'" doesnt exist. AddTrack failed.'),!1;Ar==yi&&(Lr=!0)}else Lr=!0,Ar=yi-1;else{if("undefined"!=typeof Ar){if(0!=Ar)return cr&&alert('Invalid position to insert track to. Position number "'+i+'" doesnt exist. AddTrack failed.'),!1}else Ar=0;Lr=!0}Nt();ti=!0;Gr=!1;i=0;var u;u="playlist"+Math.floor(9999*Math.random());var a=e("<ul id = "+u+"></ul>");n=n.toLowerCase();for(i;i<s;i++)u=o?r[i]:r,"html"==n?Xt(u).appendTo(a):(u.type&&u.mp3||u.path)&&Wt(u).appendTo(a);Li=[];Si.empty();a.appendTo(Si).find("li[class='playlistItem']").each(function(){Li.push(e(this))});_r=!1;ei||(_r=!0,ei="visible"==t?Hn:xi);j()};this.inputAudio=function(e){if(!$t||ti)return!1;if("undefined"==typeof e)return cr&&alert("inputAudio method requires data parameter. inputAudio failed."),!1;if("undefined"===e.mp3)return cr&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."),!1;O();is.reSetCounter();fi=e.mp3;"undefined"!==e.ogg&&(li=e.ogg);"undefined"!==e.title?_t(e.title):_t(ur);isMobile&&(Xn=!0,Cr||"undefined"!=typeof ct(Ai)&&ct(Ai).pb_setAutoplay(!0));H();Et()};this.removeTrack=function(e){if(!$t||ti||!ei)return!1;if("undefined"==typeof e)return cr&&alert("removeTrack method requires track parameter. removeTrack failed."),!1;if("string"==typeof e){var t=0,n=!1;for(t;t<yi;t++)if(e==vi[t].title){e=t;n=!0;break}if(!n)return cr&&alert('Track with name "'+e+'" doesnt exist. RemoveTrack failed.'),!1;gi[e]&&vi[e]?(gi[e].remove(),vi.splice(e,1),Vt(e)):cr&&alert('RemoveTrack with name "'+e+'" failed.')}else if("number"==typeof e){if(0>e||e>yi-1)return cr&&alert('Invalid track number. Track number "'+e+'" doesnt exist. RemoveTrack failed.'),!1;gi[e]&&vi[e]?(gi[e].remove(),vi.splice(e,1),Vt(e)):cr&&alert('RemoveTrack with name "'+e+'" failed.')}else{if("[object Array]"!==Object.prototype.toString.call(e))return cr&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."),!1;if("string"==typeof e[0]?t=!0:"number"==typeof e[0]&&(t=!1),t){var t=0,n=e.length,r,i,s;t;e:for(;t<n;t++)if(i=e[t],"string"==typeof i){s=0;r=vi.length;if(0==r){Vt();break e}for(s;s<r;s++)if(i==vi[s].title&&gi[s]&&vi[s]){gi[s].remove();vi.splice(s,1);Vt(s);break}}}else e:for(e.sort(Rt),t=0,n=e.length,t;t<n;t++)if(i=e[t],"number"==typeof i){r=vi.length;if(0==r){Vt();break e}-1<i&&i<r&&gi[i]&&vi[i]&&(gi[i].remove(),vi.splice(i,1),Vt(i))}}};this.destroyAudio=function(){if(!$t||ti||!ei)return!1;D()};this.destroyPlaylist=function(){if(!$t||ti||!ei)return!1;P()};this.setTitle=function(e){if(!$t||ti||!ei)return!1;_t(e)};this.toggleShuffle=function(){if(!$t||ti)return!1;ir?(On.find(".player_shuffle").find("img").attr("src",En),ir=!1):(On.find(".player_shuffle").find("img").attr("src",Sn),ir=!0);is.setRandom(ir)};this.toggleLoop=function(){if(!$t||ti)return!1;rr?(On.find(".player_loop").find("img").attr("src",vn),rr=!1):(On.find(".player_loop").find("img").attr("src",mn),rr=!0);is.setLooping(rr)};this.setVolume=function(e){if(!$t||ti)return!1;0>e?e=0:1<e&&(e=1);hs=e;o()};this.getVolume=function(){return $t?hs:!1};this.setAutoPlay=function(e){if(!$t)return!1;Xn=e;Cr||"undefined"!=typeof ct(Ai)&&ct(Ai).pb_setAutoplay(e)};this.getAutoPlay=function(){return $t?Xn:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return en};this.getSetupDone=function(){return $t};this.getPlaylistLoaded=function(){return Gr};this.getPlaylistTransition=function(){return ti};this.getMediaPlaying=function(){return!$t||ti?!1:ci};this.getAudioInited=function(){return!$t||ti?!1:ai};this.getMediaType=function(){return!$t||ti?!1:ui};this.getActiveItem=function(){return!$t||ti?!1:is.getCounter()};this.getPlaylistItems=function(e){if(!$t||ti||!gi||0==gi.length)return!1;if("string"==typeof e)return gi;if("number"==typeof e)return 0>num||num>yi-1||!gi[num]?!1:gi[num]};this.getMediaCount=function(){return!$t||ti?!1:isNaN(yi)?0:yi};this.getPlaylistHidden=function(){return!$t||ti?!1:Dr};this.getPlaylistList=function(){return $t&&zn&&0!=zn.length?zn:!1};this.orderPlaylist=function(t,n){if(!$t||!ei)return!1;if("undefined"==typeof t)return cr&&alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var r=ei.children("li"),i=r.length;if(0==i)return!1;var s=t.toLowerCase();if("reverse"==s)ei.append(r.get().reverse());else{if("random"!=s&&"remap"!=s&&"swap"!=s)return cr&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;if("random"==s)n=Ht(i);else if("remap"==s){if("undefined"==typeof n||n.length!=i)return!1}else{if("swap"!=s)return!1;if("undefined"==typeof n||2!=n.length)return!1;r=Bt(i);r.splice(n[1],1,n[0]);r.splice(n[0],1,n[1]);n=e.extend(!0,[],r)}orderedItems=jQuery.map(n,function(e){return jQuery(gi).get(e)});ei.empty().html(orderedItems)}R();if(r=Hn.find("a[class=playlistSelected]").attr("data-id"))is.reSetCounter(r),nr&&_t()};this.checkScroll=function(){if(!$t||ti||!ei)return!1;x()};this.reinitScroll=function(){if(!$t||ti||!ei)return!1;bi&&(bi.reinitialise(),"vertical"==pr?(bi.scrollToY(0),e(".jspPane").css("top","0px")):(bi.scrollToX(0),e(".jspPane").css("left","0px")));tr&&rs&&is&&-1!=is.getCounter()&&nr&&_t()};this.getPlaylistData=function(){return $t&&!ti&&ei?vi:!1};this.getSoundId=function(){return $t?Wn:!1};this.getTouch=function(){return $t?as:!1};on?(e(".flashMain").remove(),e(".circleMain").remove(),Cr?(e(".flashAudio").remove(),St()):ot()):rt();return this}})(jQuery);