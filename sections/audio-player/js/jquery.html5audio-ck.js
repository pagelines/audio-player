/*
 * HTML5 Audio Player with Playlist by Tean v3.03
 * http://codecanyon.net/item/html5-audio-player-with-playlist/1694831
 */(function(e){e.fn.html5audio=function(t){function Nr(){if(U.find("div[class='fontMeasure']").length==0)var n=e("<div/>").addClass("fontMeasure").appendTo(U);else var n=U.find("div[class='fontMeasure']");Tr=new apTextScroller;Tr.init(n,et,Z,"left",t.scrollSeparator,t.scrollSpeed)}function $r(e){if(!n||bn)return;if(oi)return;if(!zr){var t;if(Mr){var r=e.originalEvent.touches;if(!(r&&r.length>0))return!1;t=r[0]}else{t=e;e.preventDefault()}zr=!0;o.bind(Ar,function(e){Jr(e)}).bind(Or,function(e){Kr(e)})}return!1}function Jr(e){var t;if(Mr){var n;if(e.originalEvent.touches&&e.originalEvent.touches.length)n=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;n=e.originalEvent.changedTouches}if(n.length>1)return!1;t=n[0];e.preventDefault()}else{t=e;e.preventDefault()}Qr(t);return!1}function Kr(e){if(zr){zr=!1;o.unbind(Ar).unbind(Or);var t;if(Mr){var n;if(e.originalEvent.touches&&e.originalEvent.touches.length)n=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;n=e.originalEvent.changedTouches}if(n.length>1)return!1;t=n[0];e.preventDefault()}else{t=e;e.preventDefault()}Qr(t)}return!1}function Qr(e){if(jr=="horizontal"){var t=e.pageX;Hr=Math.max(0,Math.min(1,(t-Wr.offset().left)/Xr))}else{var n=e.pageY;Hr=Math.max(0,Math.min(1,(n-Wr.offset().top)/Xr));Hr=1-Hr}Yr()}function Gr(){if(!n||bn)return!1;if(!Pr){Dr=Hr;Hr=0;Pr=!0}else{Hr=Dr;Pr=!1}}function Yr(){jr=="horizontal"?Vr.css("width",Hr*Xr+"px"):Vr.css("height",Hr*Xr+"px");Cn&&(Nn=="youtube_single"||Nn=="youtube_playlist"?m?er&&er.setVolume(Hr):typeof qs(ar)!="undefined"&&qs(ar).pb_setVolume(Hr):zt?Yn&&(Yn.volume=Hr):typeof qs(Jn)!="undefined"&&qs(Jn).pb_setVolume(Hr));Hr>0?U.find(".player_volume").find("img").attr("src",k):U.find(".player_volume").find("img").attr("src",A);if(isMobile&&_r){Ir&&clearTimeout(Ir);Ir=setTimeout(Rr,qr)}}function ti(){_r&&Ir&&clearTimeout(Ir);Zr.css("display","block");Br.bind("mousemove",ri).bind("mouseout",ni);o.bind("mouseout",ni)}function ni(){if(_r){Ir&&clearTimeout(Ir);Ir=setTimeout(Rr,qr)}Zr.css("display","none");Br.unbind("mousemove",ri).unbind("mouseout",ni);o.unbind("mouseout",ni)}function ri(e){if(jr=="horizontal"){var t=e.pageX-Br.offset().left;if(isNaN(t))return!1;t<0?t=0:t>Xr&&(t=Xr);var n=parseInt(t-Zr.width()/2,10);Zr.css("left",n+"px");var r=Math.max(0,Math.min(1,t/Xr)),i=parseInt(r*100,10)}else{var t=e.pageY-Br.offset().top;if(isNaN(t))return!1;t<0?t=0:t>Xr&&(t=Xr);var n=parseInt(t-Zr.height()/2,10);Zr.css("top",n+ei+"px");var r=Math.max(0,Math.min(1,t/Xr));r=1-r;var i=parseInt(r*100,10)}Zr.find("p").html(i+" %")}function Pi(e){if(!n||bn)return;if(!Cn)return;if(zr)return;if(wn)return;if(!oi){var t;if(Mr){var r=e.originalEvent.touches;if(!(r&&r.length>0))return!1;t=r[0]}else{t=e;e.preventDefault()}oi=!0;o.bind(Ar,function(e){Hi(e)}).bind(Or,function(e){Bi(e)})}return!1}function Hi(e){var t;if(Mr){var n;if(e.originalEvent.touches&&e.originalEvent.touches.length)n=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;n=e.originalEvent.changedTouches}if(n.length>1)return!1;t=n[0];e.preventDefault()}else{t=e;e.preventDefault()}ji(t,e);return!1}function Bi(e){if(oi){oi=!1;o.unbind(Ar).unbind(Or);var t;if(Mr){var n;if(e.originalEvent.touches&&e.originalEvent.touches.length)n=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;n=e.originalEvent.changedTouches}if(n.length>1)return!1;t=n[0];e.preventDefault()}else{t=e;e.preventDefault()}ji(t,e)}if(z)var r=setTimeout(function(){r&&clearTimeout(r);hi=!1},500);return!1}function ji(e,t){if(!z){ii=e.pageX-ui.offset().left;ii<0?ii=0:ii>ci&&(ii=ci);fi.width(ii);var n=Math.max(0,Math.min(1,ii/ci))}else if(W){if($i(t)){if(_i)return!1;if(Mi>Ai-Oi)return!1;if(!oi){Gi(!0);Si.clearRect(0,0,Ci,ki);Wi(Di);Vi()}return!1}if(!_i)return!1;hi=!0;var r=e.pageX-vi.offset().left-Ci/2,i=e.pageY-vi.offset().top-ki/2,s=Math.atan2(i,r);s>-1*Math.PI&&s<-0.5*Math.PI&&(s=2*Math.PI+s);var n=Math.max(0,Math.min((s+Math.PI/2)/2*Math.PI*10))/100;Di=n;Si.clearRect(0,0,Ci,ki);Wi(Di);Vi()}if(isNaN(n))return!1;si=Di;Fi(n)}function Fi(e){if(Nn=="youtube_single"||Nn=="youtube_playlist")if(m){var t=e*er.getDuration(),n=t.toFixed(1);isNaN(n)||er.seek(n)}else typeof qs(ar)!="undefined"&&qs(ar).pb_seek(e);else zt?Yn&&Yn.seekable&&Yn.seekable.length>0&&(!h||isMobile?Yn.currentTime=e*Yn.duration:e*Yn.duration>=Yn.buffered.end(0)-5?Yn.currentTime=Yn.buffered.end(0)-5:Yn.currentTime=e*Yn.duration):typeof qs(Jn)!="undefined"&&qs(Jn).pb_seek(e)}function qi(){if(!Cn)return;Ii.css("display","block");li.bind("mousemove",Ui).bind("mouseout",Ri);o.bind("mouseout",Ri)}function Ri(){if(!Cn)return;Ii.css("display","none");li.unbind("mousemove",Ui).unbind("mouseout",Ri);o.unbind("mouseout",Ri)}function Ui(e){if(!z){var t=e.pageX-li.offset().left;if(isNaN(t))return!1;t<0?t=0:t>ci&&(t=ci);var n=parseInt(t-Ii.width()/2,10);Ii.css("left",n+"px");var r=Math.max(0,Math.min(1,t/ci))}else if(W){if($i(e)){Ii.css("display","none");return!1}var i=e.pageX-vi.offset().left,s=e.pageY-vi.offset().top,o=i-Ci/2,u=s-ki/2,a=Math.atan2(u,o);a>-1*Math.PI&&a<-0.5*Math.PI&&(a=2*Math.PI+a);var r=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;Ii.css("display","block")}if(isNaN(r))return!1;zi(r)}function zi(e){if(isNaN(e))return!1;var t,n;Nn=="youtube_single"||Nn=="youtube_playlist"?m?(n=er.getDuration(),t=e*n):typeof qs(ar)!="undefined"&&(n=qs(ar).pb_getFlashDuration(),t=e*n):zt?Yn&&(n=Yn.duration,t=e*n):typeof qs(Jn)!="undefined"&&(n=qs(Jn).pb_getFlashDuration(),t=e*n);if(!!isNaN(t)||!!isNaN(n))return!1;Ii.find("p").html(uo(t)+xt+ao(n))}function Wi(e){Si.beginPath();Si.arc(Ci/2,ki/2,Li-bi/2,-Ni,Ti*e-Ni,!1);Si.strokeStyle=wi;Si.lineCap="butt";Si.lineWidth=bi;Si.stroke()}function Xi(e){xi.beginPath();xi.arc(Ci/2,ki/2,Li-bi/2,-Ni,Ti*e-Ni,!1);xi.strokeStyle=Ei;xi.lineCap="butt";xi.lineWidth=bi;xi.stroke()}function Vi(){if(!An){var e=65,t=57,n=65,r=102,i=n-e,s=r-t,o=Math.atan2(s,i)-Math.PI/3,u=Math.sqrt(i*i+s*s),a=Math.cos(o)*u+e,f=Math.sin(o)*u+t;Si.beginPath();Si.fillStyle=wi;Si.moveTo(e,t);Si.lineTo(n,r);Si.lineTo(a,f);Si.fill()}else{var e=62,t=57,l=14,c=45,h=23;Si.fillStyle=wi;Si.fillRect(e,t,l,c);Si.fillRect(e+h,t,l,c)}}function $i(e){var t;if(Mr){var n;if(e.originalEvent.touches&&e.originalEvent.touches.length)n=e.originalEvent.touches;else{if(!e.originalEvent.changedTouches||!e.originalEvent.changedTouches.length)return!1;n=e.originalEvent.changedTouches}if(n.length>1)return!1;t=n[0]}else t=e;var r=t.pageX-vi.offset().left,i=t.pageY-vi.offset().top,s=Ci/2,o=ki/2;Mi=Math.sqrt((r-s)*(r-s)+(i-o)*(i-o));return Math.sqrt((r-s)*(r-s)+(i-o)*(i-o))<Ai}function Ji(t){if(!Fn){var n=U.find(".componentPlaylist");Fn=n.jScrollPane().data().jsp;n.bind("jsp-initialised",function(e,t){}).jScrollPane({mouseWheelSpeed:20});Ot=="horizontal"&&(isMobile||n.bind("mousewheel",Ki))}else if(Ot=="vertical")if(J.outerHeight(!0)>=V.height()){Fn.reinitialise();if(t){Fn.scrollToY(0);e(".jspPane").css("top","0px")}}else{Fn.destroy();Fn=null}else{Fn.reinitialise();if(t){Fn.scrollToX(0);e(".jspPane").css("left","0px")}}}function Ki(e,t,r,i){if(!n||bn)return!1;var s=t>0?-1:1;Fn&&Fn.scrollByX(s*100);return!1}function Qi(){var t=[U.find(".controls_next"),U.find(".controls_prev"),U.find(".controls_toggle"),U.find(".player_volume"),U.find(".player_download"),U.find(".player_loop"),U.find(".player_shuffle")],n,r=t.length,i=0;for(i;i<r;i++){n=e(t[i]).css("cursor","pointer").bind(Lr,Zi);Ft&&!isMobile&&n.bind("mouseover",es).bind("mouseout",ts)}}function Gi(e){if(An){if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;if(m)er.togglePlayback();else{typeof qs(ar)!="undefined"&&qs(ar).pb_togglePlayback();Cn=!0}}else zt?Yn&&Yn.pause():typeof qs(Jn)!="undefined"&&qs(Jn).pb_pause();An=!1;so("off")}else{if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;if(m)if(isMobile)if(!vr&&at){n=!1;Ms("on")}else er.togglePlayback();else er.togglePlayback();else{typeof qs(ar)!="undefined"&&qs(ar).pb_togglePlayback();Cn=!0}}else zt?Yn&&Yn.play():typeof qs(Jn)!="undefined"&&qs(Jn).pb_play();An=!0;oo("off")}if(!e)return!1}function Yi(t){if(!n||bn)return!1;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var r=e(t.currentTarget),i=r.attr("data-id"),s=r.closest(".playlistItem");if(s.hasClass(dn))return!1;at=!0;ns();kr.processPlaylistRequest(i);return!1}function Zi(t){if(!n||bn)return!1;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var r=e(t.currentTarget),i=r.attr("class"),s=i.split(" ");if(e.inArray("controls_prev",s)!=-1){at=!0;ns();kr.advanceHandler(-1,!0)}else if(e.inArray("controls_toggle",s)!=-1){if(!Cn)return;Gi()}else if(e.inArray("controls_next",s)!=-1){at=!0;ns();kr.advanceHandler(1,!0)}else if(e.inArray("player_volume",s)!=-1)if(!isMobile){Gr();Yr()}else if(_r)Ur();else{Gr();Yr()}else if(e.inArray("player_download",s)!=-1)vs();else if(e.inArray("player_loop",s)!=-1){if(wt){U.find(".player_loop").find("img").attr("src",N);wt=!1}else{U.find(".player_loop").find("img").attr("src",C);wt=!0}kr.setLooping(wt)}else if(e.inArray("player_shuffle",s)!=-1){if(Et){U.find(".player_shuffle").find("img").attr("src",M);Et=!1}else{U.find(".player_shuffle").find("img").attr("src",_);Et=!0}kr.setRandom(Et)}return!1}function es(t){if(!n)return;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var r=e(t.currentTarget),i=r.attr("class"),s=i.split(" ");e.inArray("controls_prev",s)!=-1?U.find(".controls_prev").find("img").attr("src",y):e.inArray("controls_toggle",s)!=-1?An?oo("on"):so("on"):e.inArray("controls_next",s)!=-1?U.find(".controls_next").find("img").attr("src",w):e.inArray("player_volume",s)!=-1?Hr>0?U.find(".player_volume").find("img").attr("src",L):U.find(".player_volume").find("img").attr("src",O):e.inArray("player_download",s)!=-1?U.find(".player_download").find("img").attr("src",B):e.inArray("player_loop",s)!=-1?wt?U.find(".player_loop").find("img").attr("src",N):U.find(".player_loop").find("img").attr("src",C):e.inArray("player_shuffle",s)!=-1&&(Et?U.find(".player_shuffle").find("img").attr("src",M):U.find(".player_shuffle").find("img").attr("src",_));return!1}function ts(t){if(!n)return;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var r=e(t.currentTarget),i=r.attr("class"),s=i.split(" ");e.inArray("controls_prev",s)!=-1?U.find(".controls_prev").find("img").attr("src",g):e.inArray("controls_toggle",s)!=-1?An?oo("off"):so("off"):e.inArray("controls_next",s)!=-1?U.find(".controls_next").find("img").attr("src",b):e.inArray("player_volume",s)!=-1?Hr>0?U.find(".player_volume").find("img").attr("src",k):U.find(".player_volume").find("img").attr("src",A):e.inArray("player_download",s)!=-1?U.find(".player_download").find("img").attr("src",H):e.inArray("player_loop",s)!=-1?wt?U.find(".player_loop").find("img").attr("src",C):U.find(".player_loop").find("img").attr("src",N):e.inArray("player_shuffle",s)!=-1&&(Et?U.find(".player_shuffle").find("img").attr("src",_):U.find(".player_shuffle").find("img").attr("src",M));return!1}function ns(){if(Qt)return;if(kr.getCounter()!=-1){var t=e(Hn[kr.getCounter()]);if(t&&t.hasClass("playlistSelected")){var n=t.attr("data-id");t.removeClass("playlistSelected").addClass("playlistNonSelected");typeof playlistItemEnabled!="undefined"&&playlistItemEnabled(r,ut,t,n)}}}function rs(){if(Qt)return;var t=e(Hn[kr.getCounter()]);if(t&&t.hasClass("playlistNonSelected")){var n=t.attr("data-id");t.removeClass("playlistNonSelected").addClass("playlistSelected");typeof playlistItemDisabled!="undefined"&&playlistItemDisabled(r,ut,t,n)}}function is(){var e=t.activeItem;if(!isNaN(e)&&e!=-1){e<0?e=0:e>jn-1&&(e=jn-1);kr.setCounter(e,!1)}else at=!0}function ss(){if(!yn)return;if(kr.getCounter()==-1)return;us();ro();ns()}function os(){us();ro();var t=0,n;for(t;t<jn;t++){n=e(Hn[t]).unbind("click",Yi);It&&!isMobile&&n.unbind("mouseenter").unbind("mouseleave")}if(yn){yn.children().each(function(){var t=e(this);t.data("hap_wrap_player")&&t.data("hap_wrap_player").destroyPlaylist()});yn.empty();yn=null}J.empty();vn=!1;Qt=!1;gn=null;sn=null;un=null;$t=!1;Jt=!1;Kt=!1;kt=null;kr.reSetCounter();Pn=[];Hn=[];Bn=[];Fn&&Fn.reinitialise()}function us(){if(pr){m?er&&er.stop():typeof qs(ar)!="undefined"&&qs(ar).pb_dispose();pr=!1}if(zt){_n&&clearInterval(_n);if(Yn){Yn.pause();Yn.src=""}Gn&&Gn.unbind("ended pause play canplay canplaythrough loadedmetadata")}else typeof qs(Jn)!="undefined"&&qs(Jn).pb_dispose();io();un?it.css("display","block"):it.css("display","none");si=null;wn=!1;An=!1;Cn=!1;En=!1}function as(t){if(typeof t=="undefined"){Lt&&alert("setPlaylist method requires data parameter. loadPlaylist failed.");return!1}if(typeof t.hidden=="undefined"){Lt&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed.");return!1}var n=Co(t.hidden);if(typeof t.id=="undefined"){Lt&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed.");return!1}var r=t.id;bn=!0;no();J.css("opacity",0);yn&&os();vn=!1;Qt=n;if(X&&isIE){var i=e(ot.find(r).css("display","block").clone().wrap("<p>").parent().html());e(ot.find(r).css("display","none"))}else{var i=ot.find(r).css("display","block").clone();ot.find(r).css("display","none")}i.css("fontSize",0);if(i.length==0){Lt&&alert('Failed to select playlist! Make sure that element: "'+r+'" exist in playlist list! Quitting.');to();return!1}if(Qt){Rn.empty();i.appendTo(Rn);Vt=0;Xt=!0;Jt=!0;Kt=!0;yn=Un}else{if(Fn)i.appendTo(J);else{if(J.length==0){Lt&&alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting.");return!1}i.appendTo(J)}yn=i}Pn=[];Hn=[];Bn=[];$n=[];i.find("li[class*='playlistItem']").each(function(){$n.push(e(this))});fs()}function fs(){$n.length?ls():hs()}function ls(){en=null;sn=null;on=null;an=null;fn=null;Zt=!1;var t=$n[0],n=t.attr("data-type").toLowerCase(),r=t.attr("data-path"),i=t.hasClass(Gt);Vn=[];t.hasClass(Yt)&&(Zt=!0);t.attr("data-plink")!=undefined&&!bo(t.attr("data-plink"))&&(en=t.attr("data-plink"));t.attr("data-dlink")!=undefined&&(n=="youtube_single"||n=="youtube_playlist"?bo(t.attr("data-dlink"))||(sn=t.attr("data-dlink")):bo(t.attr("data-dlink"))?sn=!0:sn=t.attr("data-dlink"));t.attr("data-download")!=undefined&&(n=="youtube_single"||n=="youtube_playlist"?bo(t.attr("data-download"))||(on=t.attr("data-download")):bo(t.attr("data-download"))?on=!0:on=t.attr("data-download"));t.attr("data-thumb")!=undefined&&!bo(t.attr("data-thumb"))&&(an=t.attr("data-thumb"));bo(e.trim(t.html()))||(fn=t.html());if(i){gn=t;$n.shift();fs()}else if(n=="local"){gn=t;$n.shift();fs()}else if(n=="soundcloud"){gn=t.data("toremove","true");xn=0;Rs(r)}else if(n=="podcast"){gn=t.data("toremove","true");var s="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num="+vt+"&callback=?&q="+encodeURIComponent(r);e.ajax({type:"GET",url:s,dataType:"jsonp",cache:!1}).done(function(t){if(t.responseData==null){Lt&&alert("Playlist process failed, podcast: "+r);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs();return}if(!ieBelow9){In.html(t.responseData.xmlString);var n=In.get(0).getElementsByTagName("item"),i=0,s=n.length,o,u,a,f;for(i;i<s;i++){o=n[i];a={};a.type="podcast";a.mp3=o.getElementsByTagName("enclosure")[0].getAttribute("url");a.ogg="";if(o.getElementsByTagName("itunes:duration")[0]!=undefined){u=Eo(o.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue);a.length=parseInt(u*1e3,10)}o.getElementsByTagName("media:thumbnail")[0]!=undefined?o.getElementsByTagName("media:thumbnail")[0].getAttribute("url")!=undefined?a.thumb=o.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):an&&(a.thumb=an):an&&(a.thumb=an);a.title=o.getElementsByTagName("title")[0].childNodes[0].nodeValue;en&&(a.url=en);sn&&(a.dlink=sn);on&&(a.download=on);Vn.push(a)}}else{var l=So(t.responseData.xmlString),c,a;e(l).find("item").each(function(){c=e(this);a={};a.type="podcast";a.mp3=c.find("enclosure").attr("url");a.ogg="";a.title=c.find("title").text();c.find("media\\:thumbnail").length>0?c.find("media\\:thumbnail").attr("url")?a.thumb=c.find("media\\:thumbnail").attr("url"):an&&(a.thumb=an):an&&(a.thumb=an);en&&(a.url=en);sn&&(a.dlink=sn);on&&(a.download=on);Vn.push(a)})}cs()}).fail(function(e,t,n){Lt&&alert("Parse feed error: "+e.responseText);Lt&&alert("Playlist process failed, podcast: "+r);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs()})}else if(n=="folder"){gn=t.data("toremove","true");var s=hap_source_path+"folder_parser.php",o=!0;t.attr("data-subdirs")!=undefined&&t.attr("data-subdirs")=="false"&&(o=!1);var u={dir:r,subdirs:o};e.ajax({type:"GET",url:s,data:u,dataType:"json"}).done(function(e){yo(e,"title");var t=0,n=e.length,r,i;qt&&(Wt=Vn.length?Vn.length-1:0);for(t;t<n;t++){r=e[t];path=co(r.path);i={};i.type="folder";if(/.mp3/.test(path)){i.mp3=path;i.ogg=path.substr(0,path.lastIndexOf("."))+".ogg";var s=path.substr(0,path.lastIndexOf("."));/\//i.test(s)?title=s.substr(s.lastIndexOf("/")+1):title=s;title=title.split("_").join(" ");i.title=title;i.thumb=path.substr(0,path.lastIndexOf("."))+".jpg";i.size=parseInt(r.size,10);i.lastmod=parseInt(r.lastmod,10);en&&(i.url=en);sn&&(i.dlink=sn);on&&(i.download=on);an&&(i.thumb=an);Vn.push(i)}}Vn.length&&qt?Ws():cs()}).fail(function(e,t,n){Lt&&alert("Read folder error! Make sure you run this online or on local server!");Lt&&alert("Playlist process failed, folder: "+r);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs()})}else if(n=="xml"){gn=t;var s=hap_source_path+r,a,f,l,c,h,p=[];e.ajax({type:"GET",url:s,dataType:"html",cache:!1}).done(function(n){$n.shift();e(n).find("li[class='playlistItem']").each(function(){l=Ao(e(this));gn?gn.after(e(l)):yn.children().size()>0?e(l).prependTo(yn):e(l).appendTo(yn);gn=e(l);p.push(e(l))});var r=0,i=p.length;p.reverse();for(r;r<i;r++)$n.unshift(p[r]);p=null;t.remove();fs()}).fail(function(e,t,n){Lt&&alert("Playlist process failed, xml: "+r);gn&&gn.remove();$n.shift();fs()})}else if(n=="database_data"||n=="database_html"){if(t.attr("data-table")==undefined||bo(t.attr("data-table"))){if(Lt){alert("Database table missing!");alert("Playlist process failed, database query: "+r)}$n.shift();fs();return}var d=null,v=null,m=null;t.attr("data-limit")!=undefined&&!bo(t.attr("data-limit"))&&(d=parseInt(t.attr("data-limit"),10));if(t.attr("data-range")!=undefined&&!bo(t.attr("data-range"))){var g=t.attr("data-range").split(",");if(g.length==2){v=g[0];m=g[1]}}gn=t;var s=hap_source_path+"includes/database.php",a,f,l,c,h,p=[],u={db_name:r,db_table:t.attr("data-table"),db_type:n,limit:d,range_from:v,range_to:m};e.ajax({type:"POST",url:s,data:u}).done(function(i){if(i.indexOf("Database information missing!")>-1||i.indexOf("Db connection failed")>-1||i.indexOf("Db selection failed")>-1||i.indexOf("Db query failed")>-1){if(Lt){alert(i);alert("Playlist process failed, database query: "+r)}gn&&gn.remove();$n.shift();fs();return}$n.shift();var s=e.parseJSON(i),o=0,u=s.length,a,f;for(o;o<u;o++){a=s[o];if(n=="database_data"){if(!(a.type&&a.mp3||a.path))continue;l=Lo(a)}else{if(!a.path)continue;l=Ao(a.path)}gn?gn.after(e(l)):yn.children().size()>0?e(l).prependTo(yn):e(l).appendTo(yn);gn=e(l);p.push(e(l))}var o=0,u=p.length;p.reverse();for(o;o<u;o++)$n.unshift(p[o]);p=null;t.remove();fs()}).fail(function(e,t,n){Lt&&alert("Playlist process failed, database query: "+r);gn&&gn.remove();$n.shift();fs()})}else if(n=="youtube_single"){or=r;youtube_path="http://gdata.youtube.com/feeds/api/videos/"+r+"?v=2&format=5&alt=jsonc";gn=t.data("toremove","true");ks(n,youtube_path)}else if(n=="youtube_playlist"){r.substr(0,2).toUpperCase()=="PL";rr=r;tr=1;youtube_path="http://gdata.youtube.com/feeds/api/playlists/"+rr+"?start-index="+tr+"&max-results=50&v=2&format=5&alt=jsonc";gn=t.data("toremove","true");ks(n,youtube_path)}else if(n=="ofm_single"){gn=t.data("toremove","true");yr=[];yr.push({id:r,type:n});xs()}else{if(n!="ofm_playlist"&&n!="ofm_project"){Lt&&alert("Invalid playlist data-type attribute!");$n.shift();fs();return}gn=t.data("toremove","true");br=n;Er=r;yr=[];Sr=1;Cs()}}function cs(){if(Vn.length){var t,n,r=0,i=Vn.length,s,o;for(r;r<i;r++){s=Vn[r];t=e('<li class="playlistItem" data-type="'+s.type+'"data-mp3="'+s.mp3+'" data-ogg="'+s.ogg+'" data-thumb="'+s.thumb+'"></li>');o=s.mp3;/\.(mp3)$/i.test(s.mp3)||(o+=".mp3");Zt&&t.addClass(Yt);s.url&&t.attr("data-plink",s.url);s.dlink&&(s.dlink!=1&&s.dlink!="true"?t.attr("data-dlink",s.dlink):t.attr("data-dlink",o));s.download&&(s.download!=1&&s.download!="true"?t.attr("data-download",s.download):t.attr("data-download",o));s.title&&t.attr("data-title",s.title);if(s.thumb){s.thumb.substr(0,2)=="//"&&(s.thumb="http:"+s.thumb);t.attr("data-thumb",s.thumb)}s.length&&t.attr("data-length",s.length);if(Bt=="title")n=e('<a class="playlistNonSelected" href="#">"'+s.title+'"</a>').appendTo(t);else if(Bt=="thumb")n=e('<a class="playlistNonSelected" href="#"><img src="'+s.thumb+'" alt="thumb"/></a>').appendTo(t);else if(Bt=="all"){n=e('<a class="playlistNonSelected" href="#"></a>').appendTo(t);e('<span class="hap_thumb"><img src="'+s.thumb+'" alt="thumb"/></span>').appendTo(n);e('<span class="hap_title"><p>'+s.title+"</p></span>").appendTo(n)}fn&&n.after(fn);if(!gn)t.appendTo(yn);else{gn.after(t);gn.data("toremove")=="true"&&gn.remove()}gn=t}}$n.shift();fs()}function hs(){if($t||Jt){var t=0;gn=null;var i;Rn.find("li[class*='playlistItem']").each(function(){i=e(this);gn?gn.after(i):Xt?i.appendTo(yn):yn.children().eq(Vt).before(i);gn=i;t++});Rn.empty()}ps();J.css("opacity",1);n||ds();gn=null;bn=!1;to();if(jn>0){if(!$t&&!Jt){kr.setPlaylistItems(jn);is()}else{var s=kr.getCounter();kr.setPlaylistItems(jn,!1);Vt<=s&&(Xt||kr.reSetCounter(s+t));if(Kt){Kt=!1;is()}}bt&&fo()}$t=!1;Jt=!1;jn==0&&typeof playlistEmpty!="undefined"&&playlistEmpty(r,ut);typeof audioPlayerPlaylistLoaded!="undefined"&&audioPlayerPlaylistLoaded(r,ut);vn=!0}function ps(){Pn=[];Bn=[];Hn=[];if(yn.length==0){Lt&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting.");return!1}var t=0,i,s,o=yn.find("li"),u=o.length,a,f,l,c,h,p,d,h,v,m,g,y;mn=0;for(t;t<u;t++){s=e(o[t]).addClass(Gt);Bn.push(s);pn&&s.addClass(dn);Ot=="horizontal"?mn+=s.outerWidth(!0):mn+=s.outerHeight(!0);i=s.find("a[class=playlistNonSelected]");i.length==0&&(i=s.find("a[class=playlistSelected]"));i.unbind().bind("click",Yi).attr("data-id",t);Hn.push(i);It&&!isMobile&&i.bind("mouseenter",function(t){if(!n||bn)return!1;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var i=e(t.currentTarget),s=i.attr("data-id"),o=e(Hn[s]),u=kr.getCounter(),a=!1;u==s&&(a=!0);typeof playlistItemRollover!="undefined"&&playlistItemRollover(r,ut,o,s,a);return!1}).bind("mouseleave",function(t){if(!n||bn)return!1;if(!t)var t=window.event;t.cancelBubble?t.cancelBubble=!0:t.stopPropagation&&t.stopPropagation();var i=e(t.currentTarget),s=i.attr("data-id"),o=e(Hn[s]),u=kr.getCounter(),a=!1;u==s&&(a=!0);typeof playlistItemRollout!="undefined"&&playlistItemRollout(r,ut,o,s,a);return!1});a="";s.attr("data-title")!=undefined?a=s.attr("data-title"):Bt=="title"?a=i.html():Bt!="thumb"&&Bt=="all"&&(a=i.find("span[class=hap_title]").find("p").html());if(Nt){f=ho(t)+Ct+a;i.html(f)}s=e(Bn[t]).attr({"data-id":t,"data-title":a});p="",d="",l="",c="",h=undefined,v=null,m=null,g=null,y=null;s.attr("data-mp3")!=undefined&&(p=s.attr("data-mp3"));s.attr("data-ogg")!=undefined&&(d=s.attr("data-ogg"));s.attr("data-type")!=undefined&&(l=s.attr("data-type"));s.attr("data-origtype")!=undefined&&(c=s.attr("data-origtype"));s.attr("data-length")!=undefined&&!bo(s.attr("data-length"))&&(h=s.attr("data-length"));if(l=="youtube_single"||l=="youtube_playlist"){s.attr("data-download")!=undefined&&!bo(s.attr("data-download"))&&(v=s.attr("data-download"));s.attr("data-dlink")!=undefined&&!bo(s.attr("data-dlink"))&&(m=s.attr("data-dlink"))}else{s.attr("data-download")!=undefined&&(!bo(s.attr("data-download"))&&s.attr("data-download")!="true"?v=s.attr("data-download"):v=p);s.attr("data-dlink")!=undefined&&(!bo(s.attr("data-dlink"))&&s.attr("data-dlink")!="true"?m=s.attr("data-dlink"):m=p)}s.attr("data-plink")!=undefined&&!bo(s.attr("data-plink"))&&(g=s.attr("data-plink"));s.attr("data-thumb")!=undefined&&!bo(s.attr("data-thumb"))&&(y=s.attr("data-thumb"));if(!Qt){if(g&&s.find("a[class=plink]").length==0){var b=e('<a class="plink" href="'+g+'" target="_blank"><img src="'+j+'" alt="purchase"/></a>');i.after(b)}if(m&&s.find("a[class=dlink]").length==0){var w=e('<a class="dlink" href="#" data-dlink="'+m+'"><img src="'+F+'" alt="download"/></a>');i.after(w);bo(s.attr("data-dlink"))}if(Dt&&s.find("a[class=premove]").length==0){var E=e('<a class="premove" href="#"><img src="'+I+'" alt="remove"/></a>');i.after(E)}}Pn.push({id:t,type:l,origtype:c,title:a,mp3:p,ogg:d,length:h,download:v,thumb:y})}o=null;jn=Pn.length;if(!Qt){ms();Mt&&(yn.hasClass("ui-sortable")||yn.sortable({cursor:"move",update:function(e,t){ps();jn>0&&kr.setPlaylistItems(jn);var n=J.find("a[class=playlistSelected]").attr("data-id");if(n){kr.reSetCounter(n);bt&&fo()}jn==1&&is()},receive:function(e,t){typeof dropReceive!="undefined"&&dropReceive(r,ut)}}));if(At){Ot=="horizontal"&&J.width(mn);Ji(!0)}}return!0}function ds(){n=!0;bn=!1;to();eo();typeof audioPlayerSetupDone!="undefined"&&audioPlayerSetupDone(r,ut);Ss()}function vs(){if(rn)return!1;var e=Nn;if(!Nn){Lt&&alert("Invalid data-type for file download function! Quitting.");rn=!1;return!1}var t=kr.getCounter(),n=Pn[t].download,r=lo(t,!1),i=gs(e,r,n);ys(i.name,i.path)}function ms(){var t=Mr?Lr:"click";U.find("a[class=dlink]").unbind().bind(t,function(t){t.preventDefault();if(rn)return!1;var n=e(this),r=n.closest(".playlistItem"),i,s=r.attr("data-id");if(r.hasClass(dn))return!1;if(r.attr("data-type")==undefined||!!bo(r.attr("data-type"))){Lt&&alert("Invalid data-type for file download function! Quitting.");rn=!1;return!1}i=r.attr("data-type");if(n.attr("data-dlink")!=undefined&&!bo(n.attr("data-dlink"))){var o=n.attr("data-dlink"),u=lo(s,!1),a=gs(i,u,o);ys(a.name,a.path)}});U.find("a[class=plink]").unbind().bind("click",function(t){var n=e(this),r=n.closest(".playlistItem");if(r.hasClass(dn))return!1});Dt&&U.find("a[class=premove]").unbind().bind("click",function(t){t.preventDefault();var n=e(this),i=n.closest(".playlistItem"),s=parseInt(i.attr("data-id"),10);if(i.hasClass(dn))return!1;r.removeTrack(s)})}function gs(e,t,n){if(e=="local"||e=="folder"){n.indexOf("\\")&&(n=n.replace(/\\/g,"/"));if(!n.match(/^http([s]?):\/\/.*/)){var r=window.location.href;r=r.substr(0,r.lastIndexOf("/")+1);if(/^\.\.\//i.test(n)){n=n.substr(3);r.charAt(r.length-1)=="/"&&(r=r.substr(0,r.lastIndexOf("/")));r=r.substr(0,r.lastIndexOf("/")+1)}n=r+n}f||(n.lastIndexOf("/")>0?t=n.substr(n.lastIndexOf("/")+1):t=n)}else e=="soundcloud"&&(n=n.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));t=t.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(t)||(t+=".mp3");return{name:t,path:n}}function ys(e,t){if(!f)qn.attr("src","dl.php?path="+t+"&name="+e);else{rn=!0;if(_t){if(!tn){nn=Es();nn&&(tn=!0)}nn?bs(nn,e,t):rn=!1}else{var n=Es();n?bs(n,e,t):rn=!1}}}function bs(t,n,r){var i="mail="+t+"&name="+n+"&path="+r;e.ajax({type:"POST",url:"mail.php",data:i}).done(function(e){rn=!1}).fail(function(e,t,n){Lt&&alert("Send email error: "+e.responseText);ws();rn=!1});Xn.css({marginTop:-Xn.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});zn&&clearTimeout(zn);zn=setTimeout(ws,Wn)}function ws(){zn&&clearTimeout(zn);Xn.stop().animate({opacity:0},{duration:500,complete:function(){Xn.css("display","none")}})}function Es(){var e=prompt("Please enter your email address where download link will be sent:"),t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;while(!t.test(e)||bo(e)){if(e==null)break;e=prompt("Please enter a valid email address:")}return e}function Ss(){e(".hap_text_link").each(function(){var t=e(this),n=t.attr("href");typeof n!="undefined"&&n!==!1&&n.toLowerCase().indexOf(".mp3")>-1&&t.prepend('<img class="play_link" src="'+R+'"/>')});e(".hap_text_link, .hap_image_link").click(function(t){if(!n)return!1;var r=e(this),i=r.attr("href");if(typeof i=="undefined"||i===!1)return!1;if(hn&&hn==i)return Gi();ns();kr.reSetCounter();hn=i;ln=r;cn&&cn.attr("src",R);r.hasClass("hap_text_link")&&(cn=r.find("img").attr("src",q));kn=hn;Ln=kn.substr(0,kn.lastIndexOf("."))+".ogg";at=!0;zt||typeof qs(Jn)!="undefined"&&qs(Jn).pb_setAutoplay(!0);Xs();return!1})}function xs(){if(yr.length)Ts(yr.shift());else{Vn.length==0&&gn&&gn.data("toremove")=="true"&&gn.remove();Vn.length>gt&&(Vn=Vn.slice(0,gt));cs()}}function Ts(t){var n=t.id,r=t.type,i="http://api.official.fm/tracks/"+n+"?fields=streaming,cover&api_version=2";e.ajax({url:i,dataType:"json",cache:!1}).done(function(e){var t={},n,i,s;if(e.track&&e.track.streaming&&e.track.streaming.http){n=e.track;t.type=r;t.length=n.duration?n.duration:null;t.mp3=n.streaming.http;t.ogg=n.streaming.http;i=n.artist?n.artist:"Official Fm artist";s=n.title?n.title:"Official Fm track";t.title=i+" - "+s;en&&(t.url=en);sn&&(t.dlink=sn);on&&(t.download=on);n.cover.urls.small?t.thumb=n.cover.urls.small:an&&(t.thumb=an);Vn.push(t);xs()}else xs()}).fail(function(e,t,r){Lt&&alert("Playlist process failed, ofm: "+n);xs()})}function Ns(){if(xr>1){Sr+=1;if(Sr<=xr&&yr.length<gt)Cs();else if(yr.length)xs();else{$n.shift();fs()}}else if(yr.length)xs();else{Vn.length==0&&gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs()}}function Cs(){if(br=="ofm_playlist")var t="http://api.official.fm/playlists/"+Er+"/tracks?api_version=2&page="+Sr+"";else var t="http://api.official.fm/projects/"+Er+"/tracks?fields=cover&api_version=2&page="+Sr+"";e.ajax({url:t,dataType:"json",cache:!1}).done(function(e){xr=e.total_pages;if(e.tracks&&e.tracks.length){var t=0,n=e.tracks.length,r,i,s;n>gt&&(n=gt);for(t;t<n;t++){r=e.tracks[t].track;if(r.url){i=r.url.substr(r.url.lastIndexOf("/")+1);s=i.substr(0,i.indexOf("?"));yr.push({id:s,type:br})}}Ns()}else Ns()}).fail(function(e,t,n){Lt&&alert("Playlist process failed, ofm: "+Er);Ns()})}function ks(t,n){e.ajax({url:n,dataType:"jsonp",success:function(e){t=="youtube_single"?As(e):Ls(e)},error:function(e){Lt&&alert("Playlist process failed, youtube: "+n);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs()}})}function Ls(e){if(e.error){Lt&&alert("Playlist process failed, youtube playlist: "+rr);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs();return}if(e.data.items){var t=e.data.items.length,n=0,r,i,s;for(n;n<t;n++){t>mt&&(t=mt);r=e.data.items[n].video;if(!r||!r.accessControl)continue;obj={};obj.type="youtube_playlist";obj.mp3=r.id;obj.ogg="";obj.title=r.title?r.title:"";obj.description=r.description?r.description:"";r.thumbnail?obj.thumb=r.thumbnail.hqDefault?r.thumbnail.hqDefault:r.thumbnail.sqDefault:an&&(obj.thumb=an);en&&(obj.url=en);sn&&(obj.dlink=sn);on&&(obj.download=on);Vn.push(obj)}if(tr<=mt){tr+=nr;i="youtube_playlist";s="http://gdata.youtube.com/feeds/api/playlists/"+rr+"?start-index="+tr+"&max-results=50&v=2&format=5&alt=jsonc";ks(i,s)}else{Vn.length>mt&&(Vn=Vn.slice(0,mt));cs()}}else{Vn.length>mt&&(Vn=Vn.slice(0,mt));cs()}}function As(e){var t={},n;n=e.data;if(!n){Lt&&alert("Playlist process failed, youtube single: "+or);gn&&gn.data("toremove")=="true"&&gn.remove();$n.shift();fs();return}if(!n.accessControl){$n.shift();fs()}else{t.type="youtube_single";t.mp3=n.id;t.ogg="";t.title=n.title?n.title:"";t.description=n.description?n.description:"";n.thumbnail?t.thumb=n.thumbnail.hqDefault?n.thumbnail.hqDefault:n.thumbnail.sqDefault:an&&(t.thumb=an);en&&(t.url=en);sn&&(t.dlink=sn);on&&(t.download=on);Vn.push(t);cs()}}function Os(){if(!ir){U.find("div[class='youtubeIframeMain']").length==0?ur=e("<div/>").css({display:"block",left:-1e4+"px"}).addClass("youtubeIframeMain").appendTo(U):ur=U.find("div[class='youtubeIframeMain']");var t={parent:r,autoPlay:lt,defaultVolume:Hr,mediaPath:kn,youtubeHolder:ur,youtubeChromeless:sr,isMobile:isMobile,initialAutoplay:ft,quality:fr};er=e.youtubePlayer(t);e(er).bind("ap_YoutubePlayer.YT_READY",function(){mr||ur.css("left",-1e4+"px");dr=!0});e(er).bind("ap_YoutubePlayer.START_PLAY",function(){_n&&clearInterval(_n);_n=setInterval(Vs,Mn);if(gr){er.stop();er.initVideo(kn);gr=!1
}if(!vr&&isMobile){Ms("off");vr=!0;n=!0}});e(er).bind("ap_YoutubePlayer.END_PLAY",function(){Js()});e(er).bind("ap_YoutubePlayer.STATE_PLAYING",function(){Ks()});e(er).bind("ap_YoutubePlayer.STATE_PAUSED",function(){if(isMobile)if(c=="iPhone"||c=="iPod"){if(An){An=!1;so("off")}}else Qs();else Qs()});ir=!0}else if(isMobile)if(!vr){n=!1;gr=!0;Ms("on")}else er.initVideo(kn);else er.initVideo(kn);pr=!0;Cn=!0}function Ms(e){if(e=="on"){mr=!0;ur.css({top:"0px",left:"0px"})}else{ur.css("left",-1e4+"px");mr=null}}function _s(){var e=ar.substr(1);embedFlashMain(e);var e=Jn.substr(1);embedFlashAudio(e);if(typeof qs(ar)!="undefined")cr=setInterval(Ds,lr);else{Lt&&alert("Problems with flash initialization (startFlashInit)! Flash for youtube not initialized! Sound_id: "+ut);Ps()}}function Ds(){if(qs(ar).setData!=undefined){cr&&clearInterval(cr);qs(ar).setData(t);U.find(".flashMain").css("left",-1e4+"px");Ps()}}function Ps(){if(typeof qs(Jn)!="undefined")cr=setInterval(Bs,lr);else{Lt&&alert("Problems with flash initialization (checkFlashSound)! Flash audio backup not initialized! Sound_id: "+ut);Fs()}}function Hs(){var e=Jn.substr(1);embedFlashAudio(e);var t=setTimeout(function(){t&&clearTimeout(t);if(typeof qs(Jn)!="undefined")cr=setInterval(js,lr);else{Lt&&alert("Problems with flash initialization (checkFlashSound_b)! Flash audio backup not initialized! Sound_id: "+ut);Zs()}},500)}function Bs(){if(qs(Jn).setData!=undefined){cr&&clearInterval(cr);qs(Jn).setData(t);U.find(".flashAudio").css("left",-1e4+"px");Fs()}}function js(){if(qs(Jn).setData!=undefined){cr&&clearInterval(cr);qs(Jn).setData(t);U.find(".flashAudio").css("left",-1e4+"px");Zs()}}function Fs(){if(z){var t=Kn.substr(1);embedFlashCircle(t);if(typeof qs(Kn)!="undefined")cr=setInterval(Is,lr);else{Lt&&alert("Problems with flash initialization (checkFlashCircle)! Flash circle backup (canvas support is false) not initialized! Sound_id: "+ut);Zs()}}else{e(".circleMain").remove();Zs()}}function Is(){if(qs(Kn).setData!=undefined){cr&&clearInterval(cr);qs(Kn).setData(yi);Zs()}}function qs(e){e.charAt(0)=="#"&&(e=e.substr(1));return navigator.appName.indexOf("Microsoft")!=-1?window[e]:document[e]}function Rs(t){if(bo(pt)){alert("soundcloudApiKey has not been set! Skipping Soundcloud url.");$n.shift();fs();return!1}/\/likes$/.test(t)&&(t=t.replace(/\/likes$/,"/favorites"));var n=zs(t,pt);e.ajax({url:n,dataType:"jsonp",cache:!1}).done(function(n){var r,i,s,o;if(n.tracks){i=n.tracks.length;i>dt&&(i=dt);for(s=0;s<i;s++){if(!n.tracks[s].streamable||!n.tracks[s].stream_url){i+=1;i>n.tracks.length&&(i=n.tracks.length);continue}Vn.push(Us(n.tracks[s]))}Vn.length>dt&&(Vn=Vn.slice(0,dt));cs()}else if(n.duration){n.permalink_url=t;n.streamable&&n.stream_url&&Vn.push(Us(n));Vn.length>dt&&(Vn=Vn.slice(0,dt));cs()}else if(n.username)if(/likes/.test(t)){Sn=n.uri+"/likes";Rs(Sn)}else if(/favorites/.test(t)){Sn=n.uri+"/favorites";Rs(Sn)}else{Sn=n.uri+"/tracks";Rs(Sn)}else if(e.isArray(n)){i=n.length;i>dt&&(i=dt);for(s=0;s<i;s++){if(!n[s].streamable||!n[s].stream_url){i+=1;i>n.length&&(i=n.length);continue}Vn.push(Us(n[s]))}if(i==Tn){xn+=Tn;if(xn<dt)Rs(Sn);else{Vn.length>dt&&(Vn=Vn.slice(0,dt));cs()}}else{Vn.length>dt&&(Vn=Vn.slice(0,dt));cs()}}else if(n.kind&&n.kind=="group"){Sn=n.uri+"/tracks";Rs(Sn)}else{$n.shift();fs()}}).fail(function(e,n,r){Lt&&alert("Playlist process failed, soundcloud: "+t);$n.shift();fs()})}function Us(e){var t={};t.type="soundcloud";e.duration&&(t.length=e.duration);t.mp3=e.stream_url+(/\?/.test(e.stream_url)?"&":"?")+"consumer_key="+pt;t.ogg="";t.title=e.title;en&&(t.url=en);if(e.downloadable&&e.download_url){sn&&(t.dlink=sn);on&&(t.download=on)}else{sn&&sn!=1&&sn!="true"&&(t.dlink=sn);on&&on!=1&&on!="true"&&(t.download=on)}e.artwork_url?t.thumb=e.artwork_url:an&&(t.thumb=an);return t}function zs(e,t){var n=!1,r=n?"sandbox-soundcloud.com":"soundcloud.com";return(/api\./.test(e)?e+"?":"http://api."+r+"/resolve?url="+e+"&")+"format=json&offset="+xn+"&consumer_key="+t+"&callback=?"}function Ws(){var e=Vn[Wt].mp3;ID3.loadTags(e,function(){var t=ID3.getAllTags(e);t.title&&(Vn[Wt].title=t.title);t.artist&&(Vn[Wt].artist=t.artist);t.album&&(Vn[Wt].album=t.album);var n=t.picture;if(n){var r="",i=0,s=n.data.length;for(i;i<s;i++)r+=String.fromCharCode(n.data[i]);Vn[Wt].thumb="data:"+n.format+";base64,"+_win.btoa(r)}Wt++;Wt<Vn.length?Ws():cs()},{tags:["title","artist","album","picture"]})}function Xs(){us();Gs()}function Vs(){if(m){var e=er.getCurrentTime(),t=er.getDuration();Dn=er.getVideoBytesLoaded()/er.getVideoBytesTotal();if(!isNaN(e)&&!isNaN(t)){wn=!1;G.html(uo(e)+St);Y.html(ao(t));if(!z){isNaN(Dn)||ai.width(Dn*ci);oi||fi.width(e/t*ci)}else if(W){isNaN(Dn)||Xi(Dn);Di=e/t;!oi&&An&&(hi||Wi(e/t))}}else wn=!0}}function $s(){var e=Yn.currentTime,t=Yn.duration;Yn.buffered!=undefined&&Yn.buffered.length!=0&&!isNaN(t)&&(Dn=Yn.buffered.end(0)/t);if(!isNaN(e)&&!isNaN(t)){G&&G.html(uo(e)+St);Y&&Y.html(ao(t))}if(!z){if(!isNaN(Dn)){var n=Dn*ci;n>ci&&(n=ci);ai&&ai.width(n)}!isNaN(e)&&!isNaN(t)&&!oi&&fi&&fi.width(e/t*ci)}else if(W){isNaN(Dn)||Xi(Dn);if(!isNaN(e)&&!isNaN(t)){Di=e/t;!oi&&An&&Wi(e/t)}}}function Js(){typeof audioPlayerSoundEnd!="undefined"&&audioPlayerSoundEnd(r,ut,kr.getCounter());ns();kr.advanceHandler(1,!0)}function Ks(){if(!En){typeof audioPlayerSoundStart!="undefined"&&audioPlayerSoundStart(r,ut,kr.getCounter());En=!0}typeof audioPlayerSoundPlay!="undefined"&&audioPlayerSoundPlay(r,ut,kr.getCounter());z&&W&&Vi()}function Qs(){typeof audioPlayerSoundPause!="undefined"&&audioPlayerSoundPause(r,ut,kr.getCounter())}function Gs(){if(Nn=="youtube_single"||Nn=="youtube_playlist")if(m){Os();if(isMobile&&!vr&&at){n=!1;Ms("on")}}else{if(typeof qs(ar)!="undefined"){qs(ar).pb_play(kn,0,100,100,"youtube",at);Cn=!0}dr=!0;pr=!0}else if(zt){if(!Qn){var e="";ct?e+='<audio class="hap_audio_cont" preload="auto">':e+='<audio class="hap_audio_cont" preload="none">';e+='<source src="'+kn+'" type="audio/mpeg" />';e+='<source src="'+Ln+'" type="audio/ogg" />';e+="</audio>";Zn.html(e);Gn=Zn.find(".hap_audio_cont");Yn=Gn[0];Yn.volume=Hr;if(at){Yn.load();Yn.play()}Qn=!0}else{d?Yn.src=kn:v&&(Yn.src=Ln);Yn.load();Yn.play()}Gn.bind("ended",function(e){Js()}).bind("pause",function(e){Qs()}).bind("play",function(e){_n&&clearInterval(_n);_n=setInterval($s,Mn);Ks()}).bind("canplay",function(e){if(si){Yn.seekable&&Yn.seekable.length>0&&(Yn.currentTime=si*Yn.duration);si=null}}).bind("canplaythrough",function(e){}).bind("loadedmetadata",function(e){}).bind("error",function(e){}).bind("abort",function(e){}).bind("stalled",function(e){}).bind("suspend",function(e){});_n&&clearInterval(_n);_n=setInterval($s,Mn)}else typeof qs(Jn)!="undefined"&&qs(Jn).pb_initAudio(kn);if(at){An=!0;oo("off")}else{An=!1;so("off")}Yr();Nn!="youtube_single"&&Nn!="youtube_playlist"&&(Cn=!0);at=!0;!isMobile&&er&&er.setAutoPlay(!0)}function Ys(){if(m){e(".flashMain").remove();e(".circleMain").remove();if(!zt)Hs();else{e(".flashAudio").remove();Zs()}}else _s()}function Zs(){Qi();kt?as(kt):n||ds()}function eo(){if(!z){ci=ui.width();!isNaN(Dn)&&ai&&ai.width(Dn*ci);if(!oi&&fi){var e,t;if(Nn!="youtube_single"&&Nn!="youtube_playlist"){if(zt)Yn&&(e=Yn.currentTime,t=Yn.duration);else if(typeof qs(Jn)!="undefined")try{e=qs(Jn).pb_getFlashPosition,t=qs(Jn).pb_getFlashDuration()}catch(n){}try{e&&!isNaN(e)&&t&&!isNaN(t)&&fi.width(e/t*ci)}catch(n){}}}}At&&!Qt&&Ji();yt&&Tr&&Tr.checkSize()}function to(){rt.css("display","none")}function no(){rt.css("display","block")}function ro(){_n&&clearInterval(_n);yt&&Tr&&Tr.deactivate();et.html(Tt);G.html(Rt+St);Y.html(Ut);if(!z){fi.width(0);ai.width(0)}else if(W){Di=0;Si.clearRect(0,0,Ci,ki);xi.clearRect(0,0,Ci,ki)}so("off");it.css("display","none")}function io(){_n&&clearInterval(_n);if(!bt){yt&&Tr&&Tr.deactivate();et.html(Tt)}G.html(Rt+St);Y.html(Ut);if(!z){fi.width(0);ai.width(0)}else if(W){Di=0;Si.clearRect(0,0,Ci,ki);xi.clearRect(0,0,Ci,ki)}so("off");it.css("display","none")}function so(e){e=="on"?U.find(".controls_toggle").find("img").attr("src",S):U.find(".controls_toggle").find("img").attr("src",E);cn&&cn.hasClass("play_link")&&cn.attr("src",R);if(z)if(W){Si.clearRect(0,0,Ci,ki);Wi(Di);Vi()}else typeof qs(Kn)!="undefined"&&qs(Kn).pb_toggle_icon("play")}function oo(e){e=="on"?U.find(".controls_toggle").find("img").attr("src",T):U.find(".controls_toggle").find("img").attr("src",x);cn&&cn.hasClass("play_link")&&ln.hasClass("hap_text_link")&&cn.attr("src",q);if(z)if(W){Si.clearRect(0,0,Ci,ki);Wi(Di);Vi()}else typeof qs(Kn)!="undefined"&&qs(Kn).pb_toggle_icon("pause")}function uo(e){e=Math.round(e);minutes=Math.floor(e/60);minutes=minutes>=10?minutes:"0"+minutes;e=Math.floor(e%60);e=e>=10?e:"0"+e;return minutes+":"+e}function ao(e){e=Math.round(e);minutes=Math.floor(e/60);minutes=minutes>=10?minutes:"0"+minutes;e=Math.floor(e%60);e=e>=10?e:"0"+e;return minutes+":"+e}function fo(e){if(typeof e=="string")if(Nt&&kr&&kr.getCounter()!=-1)var t=kr.getCounter(),n=ho(Pn[t].id)+Ct+e;else var n=e;else if(typeof e=="number"){if(!kr)return!1;if(e<0||e>jn-1)return!1;var t=kr.getCounter(),n=lo(t)}else{if(!kr)return!1;var t=kr.getCounter(),n=lo(t)}if(yt&&Tr){Tr.input(n);Tr.activate()}else et&&et.html(n)}function lo(e,t){if(typeof t=="undefined"||t===null)t=!0;return!Pn[e]||!Pn[e].title||bo(Pn[e].title)?Tt:t?Nt?ho(Pn[e].id)+Ct+Pn[e].title:Pn[e].title:Pn[e].title}function co(e){e=e.replace(/\\'/g,"'");e=e.replace(/\\"/g,'"');e=e.replace(/\\0/g,"\0");e=e.replace(/\\\\/g,"\\");return e}function ho(e){var t;e<9?t="0"+(e+1):t=e+1;return t}function po(t){e(t).each(function(){e(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}function vo(e){var t=[],n=[],r=0;for(r;r<e;r++)t[r]=r;var i=0,s;for(i;i<e;i++){s=Math.round(Math.random()*(t.length-1));n[i]=t[s];t.splice(s,1)}return n}function mo(e){var t=[],n=0;for(n;n<e;n++)t[n]=n;return t}function go(e,t){var n=e.length;while(n--)if(RegExp(e[n]).test(t))return!0;return!1}function yo(e,t,n){t=="title"?e.sort(function(e,t){return e.title==t.title?0:e.title<t.title?-1:1}):t=="type"&&e.sort(function(e,t){return e.type==t.type?0:e.type<t.type?-1:1});n&&e.reverse()}function bo(e){return e?e.replace(/^\s+|\s+$/g,"").length==0:!0}function wo(e){var t=e.split(":");return seconds=+t[0]*60*60+ +t[1]*60+ +t[2]}function Eo(e){var t=e.split(":"),n=0,r=1;while(t.length>0){n+=r*parseInt(t.pop());r*=60}return n}function So(e){if(window.ActiveXObject&&window.GetObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.loadXML(e);return t}if(window.DOMParser)return(new DOMParser).parseFromString(e,"text/xml");throw new Error("No XML parser available")}function xo(e){var t=e.firstChild;while(t!=null&&t.nodeType==3)t=t.nextSibling;return t}function To(t){return e("<div/>").html(t).text()}function No(e,t){return t-e}function Co(e){if(typeof e=="string")switch(e.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}else if(typeof e=="boolean")return Boolean(e)}function ko(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}function Lo(t){var n,r="",i,s="",o="",u="",a,f,l,c,h,p,d,v;n=t.type.toLowerCase();t.origtype&&(r=t.origtype.toLowerCase());t.mp3?i=t.mp3:t.path&&(i=t.path);t.ogg&&(s=t.ogg);t.title&&(o=t.title);t.thumb&&(u=t.thumb);t.download&&(n=="youtube_single"||n=="youtube_playlist"?t.download!=1&&t.download!="true"&&!bo(t.download)&&(a=t.download):t.download==1?a=i:a=t.download);t.url&&(l=t.url);t.dlink&&(n=="youtube_single"||n=="youtube_playlist"?t.dlink!=1&&t.dlink!="true"&&!bo(t.dlink)&&(f=t.dlink):t.dlink==1?f=i:f=t.dlink);if(n=="local")Bt=="title"?p="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'>"+o+"</a></li>":Bt=="thumb"?p="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'><img src='"+u+"' alt='thumb'/></a></li>":Bt=="all"&&(p="<li class= 'playlistItem' data-type='local' data-origtype='"+r+"' data-mp3='"+i+"' data-ogg='"+s+"' data-thumb='"+u+"' data-title='"+o+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+u+"' alt='thumb'/></span><span class='hap_title'><p>'"+o+"'</p></span></a></li>");else{p="<li class= 'playlistItem' data-type='"+n+"' data-path='"+i+"' data-thumb='"+u+"'></li>";if(n=="database_data"){var m=t.table?t.table:null,g=t.limit?t.limit:null,y=t.range?t.range:null;if(m){d=' data-table="'+m+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}if(g){d=' data-limit="'+g+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}if(y){d=' data-range="'+y+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}}}if(a){d=' data-download="'+a+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}if(n=="local"){if(f){d="<a class='dlink' href='#' data-dlink='"+f+"'><img src='"+F+"' alt='download'/></a>";v=p.match(/\<\/a\>\<\/li\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}if(l){d="<a class='plink' href='"+l+"' target='_blank'><img src='"+j+"' alt='purchase'/></a>";v=p.match(/\<\/a\>\<\/li\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}}else{if(f){d=' data-dlink="'+f+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}if(l){d=' data-plink="'+l+'" ';v=p.match(/\>/);p=p.slice(0,v.index)+d+p.slice(v.index)}}c=document.createElement("ul");c.innerHTML=p;h=c.firstChild;return e(h)}function Ao(t){var n=e(t),r,i,s;r=e("<div>").append(n.clone()).html();i=document.createElement("ul");i.innerHTML=r;s=i.firstChild;return e(s)}function Oo(e){jn=Pn.length;if(jn>0){ps();var t=kr.getCounter();if(e==t){ss();kr.setPlaylistItems(jn)}else{kr.setPlaylistItems(jn,!1);e<t&&kr.reSetCounter(kr.getCounter()-1)}bt&&fo()}else{os();kt=null;typeof playlistEmpty!="undefined"&&playlistEmpty(r,ut)}}var n=!1,r=this,i=e("body"),s=e(window),o=e(document),u,a=150,f=!1,l=navigator.userAgent,c;if(l.indexOf("iPhone")>-1||l.indexOf("iPod")>-1||l.indexOf("iPad")>-1){f=!0;l.indexOf("iPhone")>-1?c="iPhone":l.indexOf("iPod")>-1?c="iPod":l.indexOf("iPad")>-1&&(c="iPad")}var h=navigator.userAgent.toLowerCase().indexOf("safari/")>-1,p=document.createElement("audio"),d,v,m=!1;if(p.canPlayType){m=!0;d=!!p.canPlayType&&""!=p.canPlayType("audio/mpeg");v=!!p.canPlayType&&""!=p.canPlayType('audio/ogg; codecs="vorbis"')}else{d=!0;v=!1}var g=t.buttonsUrl.prev,y=t.buttonsUrl.prevOn,b=t.buttonsUrl.next,w=t.buttonsUrl.nextOn,E=t.buttonsUrl.play,S=t.buttonsUrl.playOn,x=t.buttonsUrl.pause,T=t.buttonsUrl.pauseOn,N=t.buttonsUrl.loop,C=t.buttonsUrl.loopOn,k=t.buttonsUrl.volume,L=t.buttonsUrl.volumeOn,A=t.buttonsUrl.mute,O=t.buttonsUrl.muteOn,M=t.buttonsUrl.shuffle,_=t.buttonsUrl.shuffleOn,D=t.buttonsUrl.playlist,P=t.buttonsUrl.playlistOn,H=t.buttonsUrl.download,B=t.buttonsUrl.downloadOn,j=t.buttonsUrl.trackUrlIcon,F=t.buttonsUrl.trackDownloadIcon,I=t.buttonsUrl.trackRemoveIcon,q=t.buttonsUrl.link_pause,R=t.buttonsUrl.link_play,U=e(this),z=U.hasClass("hap_circle"),W=!1;m&&ko()&&(W=!0);var X=U.attr("id")=="html5audio-popup",V=U.find(".playlistHolder"),J=U.find(".playlist_inner").css("opacity",0),K=U.find(".playerHolder"),Q=U.find(".player_mediaTime"),G=U.find(".player_mediaTime_current"),Y=U.find(".player_mediaTime_total"),Z=U.find(".player_mediaName_Mask"),et=U.find(".player_mediaName"),tt=U.find(".player_controls"),nt=U.find(".player_volume"),rt=U.find(".preloader"),it=U.find(".player_download"),st=U.find(".componentPlaylist"),ot=e(t.playlistList);X&&window.opener&&(ot=window.opener.jQuery(t.playlistList));var ut=t.sound_id,at=t.autoPlay,ft=t.autoPlay,lt=t.autoPlay,ct=t.autoLoad;if(isMobile){at=!1;t.autoPlay=!1;lt=!1}var ht=t.useOnlyMp3Format,pt=t.soundcloudApiKey,dt=t.soundcloud_result_limit,vt=t.podcast_result_limit,mt=t.yt_playlist_result_limit,gt=t.ofm_result_limit,yt=t.useSongNameScroll,bt=t.autoSetSongTitle,wt=t.loopingOn,Et=t.randomPlay,St=t.mediaTimeSeparator,xt=t.seekTooltipSeparator,Tt=t.defaultArtistData,Nt=t.useNumbersInPlaylist,Ct=t.titleSeparator,kt=t.activePlaylist,Lt=t.useAlertMessaging,At=t.activatePlaylistScroll,Ot=t.playlistScrollOrientation.toLowerCase(),Mt=t.sortablePlaylistItems,_t=t.autoReuseMailForDownload,Dt=t.useRemoveBtnInTracks,Pt=t.useVolumeTooltip,Ht=t.useSeekbarTooltip,Bt=t.playlistItemContent.toLowerCase(),jt=t.useKeyboardNavigation,Ft=t.useBtnRollovers,It=t.usePlaylistRollovers,qt=t.getTrackInfoFromID3;G.html("0:00");Y.html("0:00");var Rt=G.html(),Ut=Y.html();et.html(Tt);G.html(Rt+St);Y.html(Ut);var zt=!0;if(!m||!d&&ht)zt=!1;var Wt,Xt,Vt,$t,Jt,Kt,Qt=!1,Gt="hap_processed",Yt="hap_draggable",Zt,en,tn,nn,rn,sn,on,un,an,fn,ln,cn,hn,pn=!1;V.attr("data-playlistLocked")!=undefined&&(pn=!0);var dn="playlist_locked",vn=!1,mn,gn,yn=null,bn=!0,wn=!1,En=!1,Sn,xn,Tn=50,Nn,Cn=!1,kn="",Ln="",An=!1,On,Mn=250,_n,Dn;wt&&U.find(".player_loop").find("img").attr("src",C);Et&&U.find(".player_shuffle").find("img").attr("src",_);var Pn=[],Hn=[],Bn=[],jn=0,Fn;if(U.find("div[id='feedParser']").length==0)var In=e('<div id="feedParser"/>').css({position:"absolute",left:-1e4+"px",display:"none"}).appendTo(U);else var In=U.find("div[id='feedParser']");if(U.find("iframe[id='dl_iframe']").length==0)var qn=e('<iframe id="dl_iframe"/>').css({position:"absolute",left:-1e4+"px",display:"none"}).appendTo(U);else var qn=U.find("iframe[id='dl_iframe']");var Rn=e("<div/>"),Un=e("<div/>");if(f){var zn,Wn=3e3;if(V.find("div[id='download_confirm']").length==0)var Xn=e('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').addClass("download_confirm").css({opacity:0,zIndex:1e3}).appendTo(V);else var Xn=V.find("div[id='download_confirm']")}var Vn=[],$n=[],Jn=t.flashAudio,Kn=t.circleMain;if(zt){var Qn=!1,Gn,Yn;if(U.find("div[id='hap_audioHolder']").length==0)var Zn=e('<div id="hap_audioHolder"/>').css({position:"absolute",left:-1e4+"px"}).appendTo(U);else var Zn=U.find("div[id='hap_audioHolder']")}var er,tr,nr=50,rr,ir=!1,sr=!1,or,ur,ar=t.flashYoutube,fr=!1,lr=100,cr,hr=!1,pr=!1,dr=!1,vr=!1,mr,gr=!1,yr=[],br,wr,Er,Sr,xr,Tr;yt&&Nr();var Cr={randomPlay:Et,loopingOn:wt},kr=e.playlistManager(Cr);e(kr).bind("ap_PlaylistManager.COUNTER_READY",function(){var e=kr.getCounter(),t=Pn[e];if(!t)return;if(pn)return;rs();bt&&fo();Nn=t.origtype?t.origtype:t.type;kn=t.mp3;Ln=t.ogg;On=t.length?t.length:null;t.download?un=!0:un=null;Xs();typeof itemTriggered!="undefined"&&itemTriggered(r,ut,e)});e(kr).bind("ap_PlaylistManager.PLAYLIST_END",function(){rs();typeof audioPlayerPlaylistEnd!="undefined"&&audioPlayerPlaylistEnd(r,ut);An=!1;so("off")});e(kr).bind("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){typeof audioPlayerPlaylistEnd!="undefined"&&audioPlayerPlaylistEnd(r,ut)});var Lr="",Ar="",Or="",Mr;if("ontouchstart"in window){Mr=!0;Lr="touchstart.ap";Ar="touchmove.ap";Or="touchend.ap"}else{Mr=!1;Lr="mousedown.ap";Ar="mousemove.ap";Or="mouseup.ap"}var _r=!1,Dr,Pr=!1,Hr=t.defaultVolume;Hr<0&&(Hr=0);Hr==0?Dr=.5:Hr>1&&(Hr=1);var Br=U.find(".volume_seekbar").css("cursor","pointer").bind(Lr,function(e){$r(e);Pr=!1;return!1}),jr="horizontal";Br.attr("data-orientation")!=undefined&&(jr=Br.attr("data-orientation").toLowerCase());if(Br.attr("data-autoHide")!=undefined){_r=!0;var Fr=!1,Ir,qr=parseInt(Br.attr("data-autoHide"),10);function Rr(){Ir&&clearTimeout(Ir);Br.css("display","none");Fr=!1}function Ur(){Ir&&clearTimeout(Ir);if(!Fr){Br.css("display","block");Fr=!0;Ir=setTimeout(Rr,qr)}else{Br.css("display","none");Fr=!1}}isMobile||nt.bind("mouseover",function(){if(!n)return!1;Ir&&clearTimeout(Ir);Br.css("display","block");Fr=!0;return!1}).bind("mouseout",function(){if(!n)return!1;Ir&&clearTimeout(Ir);Ir=setTimeout(Rr,qr);return!1})}var zr=!1,Wr=U.find(".volume_bg");if(jr=="horizontal")var Xr=Wr.width(),Vr=U.find(".volume_level").css("width",Hr*Xr+"px");else var Xr=Wr.height(),Vr=U.find(".volume_level").css("height",Hr*Xr+"px");if(Pt&&!isMobile){Br.bind("mouseover",ti);var Zr=U.find(".player_volume_tooltip"),ei=parseInt(Zr.css("top"),10);Zr.bind("mouseenter",function(){Br.unbind("mouseover",ti);Zr.css("display","none")}).bind("mouseleave",function(){Br.bind("mouseover",ti)})}else U.find(".player_volume_tooltip").remove();var ii,si,oi=!1,ui=U.find(".progress_bg"),ai=U.find(".load_progress"),fi=U.find(".play_progress"),li=U.find(".player_progress"),ci=ui.width(),hi=!1;if(z){var pi=U.find(".load_canvas").css("cursor","pointer"),di=U.find(".play_canvas"),vi=U.find(".circlePlayer"),mi=parseFloat(vi.attr("data-offOpacity"),10),gi=parseFloat(vi.attr("data-onOpacity"),10);isMobile&&(mi=gi=1);var yi={flash_id:t.flash_id,strokeSize:parseInt(vi.attr("data-strokeSize"),10),play_color:di.attr("data-bgcolor"),load_color:pi.attr("data-bgcolor"),tolerance:parseInt(vi.attr("data-tolerance"),10),offOpacity:mi,onOpacity:gi,circleWidth:pi.width(),circleHeight:pi.height()};if(W){var bi=yi.strokeSize,wi=yi.play_color,Ei=yi.load_color,Si=pi[0].getContext("2d"),xi=di[0].getContext("2d"),Ti=Math.PI*2,Ni=Math.PI/2,Ci=yi.circleWidth,ki=yi.circleHeight,Li=Ci/2,Ai=Li-bi,Oi=t.tolerance,Mi,_i=!1,Di=0;pi.bind(Lr,function(e){$i(e)?_i=!1:_i=!0;Pi(e);return!1});var li=pi}else{pi.remove();di.remove()}}else var li=U.find(".player_progress").css("cursor","pointer").bind(Lr,function(e){Pi(e);return!1});if(Ht&&!isMobile){li.bind("mouseover",qi);var Ii=U.find(".player_progress_tooltip").css("zIndex",50);Ii.find("p").html("0:00"+xt+"0:00");Ii.bind("mouseenter",function(){li.unbind("mouseover",qi);Ii.css("display","none")}).bind("mouseleave",function(){li.bind("mouseover",qi)})}else U.find(".player_progress_tooltip").remove();this.flashVideoPause=function(){so("off");An=!1;Qs()};this.flashVideoResume=function(){oo("off");An=!0;Ks()};this.flashVideoEnd=function(){Js()};this.flashVideoStart=function(){oo("off");An=!0;Cn=!0;Ks()};this.flashYoutubeData=function(e,t,n,r){if(!z){!isNaN(e)&&!isNaN(t)&&ai&&ai.width(e/t*ci);!isNaN(n)&&!isNaN(r)&&fi&&fi.width(n/r*ci)}else{!isNaN(e)&&!isNaN(t)&&typeof qs(Kn)!="undefined"&&qs(Kn).pb_drawLoadbar(e/t);if(!isNaN(n)&&!isNaN(r)){Di=n/r;oi||typeof qs(Kn)!="undefined"&&qs(Kn).pb_drawSeekbar(n/r)}}if(!isNaN(n)&&!isNaN(r)){G&&G.html(uo(n)+St);Y&&Y.html(ao(r))}};this.flashAudioData=function(e,t,n,r){var i=e/t;if(!z){!oi&&fi&&fi.width(n/r*ci);if(i!==null){var s=i*ci;s>ci&&(s=ci);ai&&ai.width(s)}if(!isNaN(n)&&!isNaN(r)){G&&G.html(uo(n)+St);Y&&Y.html(ao(r))}}else if(W){isNaN(i)||Xi(i);if(!isNaN(n)&&!isNaN(r)){Di=n/r;!oi&&An&&Wi(n/r)}}else{i!==null&&typeof qs(Kn)!="undefined"&&qs(Kn).pb_drawLoadbar(i);if(!isNaN(n)&&!isNaN(r)){Di=n/r;oi||typeof qs(Kn)!="undefined"&&qs(Kn).pb_drawSeekbar(n/r)}}};this.flashAudioEnd=function(){Js()};this.flashCircleToggle=function(e){Gi()};this.flashCircleOverLoader=function(e){Ii.css("display","block");zi(e)};this.flashCircleOutLoader=function(){Ii.css("display","none")};this.flashCircleSeek=function(e){Fi(e)};this.embedFlash=function(){if(!m){var e=ar.substr(1);embedFlashMain(e);var e=Jn.substr(1);embedFlashAudio(e);if(z){var e=Kn.substr(1);embedFlashCircle(e)}}else if(t.useOnlyMp3Format&&!d){var e=Jn.substr(1);embedFlashAudio(e)}};jt&&o.keyup(function(e){if(!n||bn)return!1;if(!e)var e=window.event;e.cancelBubble?e.cancelBubble=!0:e.stopPropagation&&e.stopPropagation();var t=e.keyCode;if(t==37)r.previousAudio();else if(t==39)r.nextAudio();else if(t==32)r.toggleAudio();else if(t==77){Gr();Yr()}return!1});s.resize(function(){if(!n||bn)return!1;u&&clearTimeout(u);u=setTimeout(eo,a)});this.setPlayIcon=function(){cn&&cn.hasClass("play_link")&&cn.attr("src",R);An=!1};this.playAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(An)return!1;if(!Cn)return!1;if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;m?er.togglePlayback():typeof qs(ar)!="undefined"&&qs(ar).pb_togglePlayback()}else zt?Yn&&Yn.play():typeof qs(Jn)!="undefined"&&qs(Jn).pb_play();oo("off");An=!0;Cn=!0};this.pauseAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(!An)return!1;if(!Cn)return!1;if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;m?er.togglePlayback():typeof qs(ar)!="undefined"&&qs(ar).pb_togglePlayback()}else zt?Yn&&Yn.pause():typeof qs(Jn)!="undefined"&&qs(Jn).pb_pause();so("off");An=!1};this.toggleAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(!Cn)return!1;Gi()};this.stopAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(!Cn)return!1;if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;m?er.stop():typeof qs(ar)!="undefined"&&qs(ar).pb_dispose()}else if(zt){if(Yn){Yn.src="";d?Yn.src=kn:v&&(Yn.src=Ln)}}else typeof qs(Jn)!="undefined"&&qs(Jn).pb_dispose();io();An=!1};this.checkAudio=function(e){if(!n)return!1;if(bn)return!1;if(!yn)return!1;var t=e.toLowerCase();if(An){if(t=="pause")if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;m?er.togglePlayback():typeof qs(ar)!="undefined"&&qs(ar).pb_togglePlayback()}else zt?Yn&&Yn.pause():typeof qs(Jn)!="undefined"&&qs(Jn).pb_pause();else if(t=="stop"){if(Nn=="youtube_single"||Nn=="youtube_playlist"){if(!dr)return!1;er.stop()}else if(zt){if(Yn){Yn.src="";d?Yn.src=kn:v&&(Yn.src=Ln)}}else typeof qs(Jn)!="undefined"&&qs(Jn).pb_dispose();io()}An=!1;so("off")}};this.nextAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;ns();kr.advanceHandler(1,!0)};this.previousAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;ns();kr.advanceHandler(-1,!0)};this.loadAudio=function(e){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(typeof e=="string"){var t=0,r=!1;for(t;t<jn;t++)if(e==Pn[t].title){e=t;r=!0;break}if(!r){Lt&&alert('Track with name "'+e+'" doesnt exist. Load audio failed.');return!1}}else{if(typeof e!="number"){Lt&&alert("Load audio method requires either a track number or a track title to load. Load audio failed.");return!1}if(e<0){Lt&&alert('Invalid track number. Track number  "'+e+'" doesnt exist. Load audio failed.');return!1}if(e>jn-1){Lt&&alert('Invalid track number. Track number  "'+e+'" doesnt exist. Load audio failed.');return!1}}ns();kr.processPlaylistRequest(e)};this.loadPlaylist=function(e){if(!n)return!1;if(bn)return!1;if(typeof e=="undefined"){Lt&&alert("loadPlaylist method requires data parameter. loadPlaylist failed.");return!1}kt=e;as(kt)};this.addTrack=function(t,r,i,s){if(!n)return!1;if(bn)return!1;if(typeof t=="undefined"){Lt&&alert("addTrack method requires type parameter. AddTrack failed.");return!1}if(typeof r=="undefined"){Lt&&alert("addTrack method requires format parameter. AddTrack failed.");return!1}if(typeof i=="undefined"){Lt&&alert("addTrack method requires track parameter. AddTrack failed.");return!1}var o=1,u=!1;if(typeof i!="string"&&Object.prototype.toString.call(i)!=="[object Object]"){if(Object.prototype.toString.call(i)!=="[object Array]"){Lt&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed.");return!1}o=i.length;u=!0}Vt=s;t=t.toLowerCase();if(t=="visible"){yn&&Qt&&os();$t=!0;Qt=!1}else{yn&&!Qt&&os();Jt=!0;Qt=!0}Xt=!1;if(yn)if(typeof Vt!="undefined"){if(Vt<0){Lt&&alert('Invalid position to insert track to. Position number "'+s+'" doesnt exist. AddTrack failed.');return!1}if(Vt>jn){Lt&&alert('Invalid position to insert track to. Position number "'+s+'" doesnt exist. AddTrack failed.');return!1}Vt==jn&&(Xt=!0)}else{Xt=!0;Vt=jn-1}else{if(typeof Vt!="undefined"){if(Vt!=0){Lt&&alert('Invalid position to insert track to. Position number "'+s+'" doesnt exist. AddTrack failed.');return!1}}else Vt=0;Xt=!0}no();bn=!0;vn=!1;var a=0,f,l,c="playlist"+Math.floor(Math.random()*9999),h=e("<ul id = "+c+"></ul>");r=r.toLowerCase();for(a;a<o;a++){l=u?i[a]:i;if(r=="html")f=Ao(l).appendTo(h);else{if(!(l.type&&l.mp3||l.path))continue;f=Lo(l).appendTo(h)}}$n=[];Rn.empty();h.appendTo(Rn).find("li[class='playlistItem']").each(function(){$n.push(e(this))});Kt=!1;if(!yn){Kt=!0;t=="visible"?Fn?yn=J:yn=J:yn=Un}fs()};this.inputAudio=function(e){if(!n)return!1;if(bn)return!1;if(typeof e=="undefined"){Lt&&alert("inputAudio method requires data parameter. inputAudio failed.");return!1}if(e.mp3==="undefined"){Lt&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed.");return!1}ns();kr.reSetCounter();kn=e.mp3;e.ogg!=="undefined"&&(Ln=e.ogg);e.title!=="undefined"?fo(e.title):fo(Tt);if(isMobile){at=!0;zt||typeof qs(Jn)!="undefined"&&qs(Jn).pb_setAutoplay(!0)}Xs()};this.removeTrack=function(e){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(typeof e=="undefined"){Lt&&alert("removeTrack method requires track parameter. removeTrack failed.");return!1}if(typeof e=="string"){var t=0,r=!1;for(t;t<jn;t++)if(e==Pn[t].title){e=t;r=!0;break}if(!r){Lt&&alert('Track with name "'+e+'" doesnt exist. RemoveTrack failed.');return!1}if(Bn[e]&&Pn[e]){Bn[e].remove();Pn.splice(e,1);Oo(e)}else Lt&&alert('RemoveTrack with name "'+e+'" failed.')}else if(typeof e=="number"){if(e<0||e>jn-1){Lt&&alert('Invalid track number. Track number  "'+e+'" doesnt exist. RemoveTrack failed.');return!1}if(Bn[e]&&Pn[e]){Bn[e].remove();Pn.splice(e,1);Oo(e)}else Lt&&alert('RemoveTrack with name "'+e+'" failed.')}else{if(Object.prototype.toString.call(e)!=="[object Array]"){Lt&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed.");return!1}var i;typeof e[0]=="string"?i=!0:typeof e[0]=="number"&&(i=!1);if(i){var t=0,s=e.length,o,u,a;e:for(t;t<s;t++){u=e[t];if(typeof u=="string"){a=0,o=Pn.length;if(o==0){Oo();break e}for(a;a<o;a++)if(u==Pn[a].title&&Bn[a]&&Pn[a]){Bn[a].remove();Pn.splice(a,1);Oo(a);break}}}}else{e.sort(No);var t=0,s=e.length,o,u;e:for(t;t<s;t++){u=e[t];if(typeof u=="number"){o=Pn.length;if(o==0){Oo();break e}if(u>-1&&u<o&&Bn[u]&&Pn[u]){Bn[u].remove();Pn.splice(u,1);Oo(u)}}}}}};this.destroyAudio=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;ss()};this.destroyPlaylist=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;os()};this.setTitle=function(e){if(!n)return!1;if(bn)return!1;if(!yn)return!1;fo(e)};this.toggleShuffle=function(){if(!n)return!1;if(bn)return!1;if(Et){U.find(".player_shuffle").find("img").attr("src",M);Et=!1}else{U.find(".player_shuffle").find("img").attr("src",_);Et=!0}kr.setRandom(Et)};this.toggleLoop=function(){if(!n)return!1;if(bn)return!1;if(wt){U.find(".player_loop").find("img").attr("src",N);wt=!1}else{U.find(".player_loop").find("img").attr("src",C);wt=!0}kr.setLooping(wt)};this.setVolume=function(e){if(!n)return!1;if(bn)return!1;e<0?e=0:e>1&&(e=1);Hr=e;Yr()};this.getVolume=function(){return n?Hr:!1};this.setAutoPlay=function(e){if(!n)return!1;at=e;zt||typeof qs(Jn)!="undefined"&&qs(Jn).pb_setAutoplay(e)};this.getAutoPlay=function(){return n?at:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return c};this.getSetupDone=function(){return n};this.getPlaylistLoaded=function(){return vn};this.getPlaylistTransition=function(){return bn};this.getMediaPlaying=function(){return n?bn?!1:An:!1};this.getAudioInited=function(){return n?bn?!1:Cn:!1};this.getMediaType=function(){return n?bn?!1:Nn:!1};this.getActiveItem=function(){return n?bn?!1:kr.getCounter():!1};this.getPlaylistItems=function(e){if(!n)return!1;if(bn)return!1;if(!Bn||Bn.length==0)return!1;if(typeof e=="string")return Bn;if(typeof e=="number")return num<0||num>jn-1?!1:Bn[num]?Bn[num]:!1};this.getMediaCount=function(){return n?bn?!1:isNaN(jn)?0:jn:!1};this.getPlaylistHidden=function(){return n?bn?!1:Qt:!1};this.getPlaylistList=function(){return n?!ot||ot.length==0?!1:ot:!1};this.orderPlaylist=function(t,r){if(!n)return!1;if(!yn)return!1;if(typeof t=="undefined"){Lt&&alert("orderPlaylist method requires action parameter. orderPlaylist failed.");return!1}var i=yn.children("li"),s=i.length;if(s==0)return!1;var o=t.toLowerCase();if(o=="reverse")yn.append(i.get().reverse());else{if(o!="random"&&o!="remap"&&o!="swap"){Lt&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed.");return!1}if(o=="random")var r=vo(s);else if(o=="remap"){if(typeof r=="undefined"||r.length!=s)return!1}else{if(o!="swap")return!1;if(typeof r=="undefined"||r.length!=2)return!1;var u=mo(s);u.splice(r[1],1,r[0]);u.splice(r[0],1,r[1]);var r=e.extend(!0,[],u)}orderedItems=jQuery.map(r,function(e){return jQuery(Bn).get(e)});yn.empty().html(orderedItems)}ps();var a=J.find("a[class=playlistSelected]").attr("data-id");if(a){kr.reSetCounter(a);bt&&fo()}};this.checkScroll=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;Ji()};this.reinitScroll=function(){if(!n)return!1;if(bn)return!1;if(!yn)return!1;if(Fn){Fn.reinitialise();if(Ot=="vertical"){Fn.scrollToY(0);e(".jspPane").css("top","0px")}else{Fn.scrollToX(0);e(".jspPane").css("left","0px")}}yt&&Tr&&kr&&kr.getCounter()!=-1&&bt&&fo()};this.getPlaylistData=function(
){return n?bn?!1:yn?Pn:!1:!1};this.getSoundId=function(){return n?ut:!1};this.getTouch=function(){return n?Mr:!1};Ys();return this}})(jQuery);